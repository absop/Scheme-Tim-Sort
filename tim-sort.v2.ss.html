<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html;charset=utf-8">
<title>tim-sort.v2.ss</title>
<style type="text/css">
* { border: 0; margin: 0; outline: 0; padding: 0; vertical-align: baseline; }
code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1rem; }
html { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; }
table { border-collapse: collapse; border-spacing: 0; }
body { padding: 1rem; }
h1, h2, h3, h4 { line-height: 1.25; margin-bottom: 0.5rem; }
h1 { font-size: 1.296rem; }
h2 { font-size: 1.215rem; }
h3 { font-size: 1.138rem; }
h4 { font-size: 1.067rem; }
html { font-family: monospace, monospace; font-size: 1rem; }
p { margin-bottom: 1.25rem; }
.pc0 { background-color: #111111; color: white; white-space: nowrap; }
.pc1 { background-color: #607D8B; color: white; white-space: nowrap; }
.pc2 { background-color: #9C27B0; color: black; white-space: nowrap; }
.pc3 { background-color: #673AB7; color: white; white-space: nowrap; }
.pc4 { background-color: #3F51B5; color: white; white-space: nowrap; }
.pc5 { background-color: #2196F3; color: black; white-space: nowrap; }
.pc6 { background-color: #00BCD4; color: black; white-space: nowrap; }
.pc7 { background-color: #4CAF50; color: black; white-space: nowrap; }
.pc8 { background-color: #CDDC39; color: black; white-space: nowrap; }
.pc9 { background-color: #FFEB3B; color: black; white-space: nowrap; }
.pc10 { background-color: #FFC107; color: black; white-space: nowrap; }
.pc11 { background-color: #FF9800; color: black; white-space: nowrap; }
.pc12 { background-color: #F44336; color: white; white-space: nowrap; }
</style>
</head>
<body class=pc0>
<h1 style="margin-bottom: 1rem">tim-sort.v2.ss<span style="opacity: 0.5"> on Sun Aug 22 20:34:22 2021</span></h1>
<table><tr><td style="color: #666666; font-weight: bold; padding-right: 1rem; text-align: right"><pre>
<span id=line1>1
</span><span id=line2>2
</span><span id=line3>3
</span><span id=line4>4
</span><span id=line5>5
</span><span id=line6>6
</span><span id=line7>7
</span><span id=line8>8
</span><span id=line9>9
</span><span id=line10>10
</span><span id=line11>11
</span><span id=line12>12
</span><span id=line13>13
</span><span id=line14>14
</span><span id=line15>15
</span><span id=line16>16
</span><span id=line17>17
</span><span id=line18>18
</span><span id=line19>19
</span><span id=line20>20
</span><span id=line21>21
</span><span id=line22>22
</span><span id=line23>23
</span><span id=line24>24
</span><span id=line25>25
</span><span id=line26>26
</span><span id=line27>27
</span><span id=line28>28
</span><span id=line29>29
</span><span id=line30>30
</span><span id=line31>31
</span><span id=line32>32
</span><span id=line33>33
</span><span id=line34>34
</span><span id=line35>35
</span><span id=line36>36
</span><span id=line37>37
</span><span id=line38>38
</span><span id=line39>39
</span><span id=line40>40
</span><span id=line41>41
</span><span id=line42>42
</span><span id=line43>43
</span><span id=line44>44
</span><span id=line45>45
</span><span id=line46>46
</span><span id=line47>47
</span><span id=line48>48
</span><span id=line49>49
</span><span id=line50>50
</span><span id=line51>51
</span><span id=line52>52
</span><span id=line53>53
</span><span id=line54>54
</span><span id=line55>55
</span><span id=line56>56
</span><span id=line57>57
</span><span id=line58>58
</span><span id=line59>59
</span><span id=line60>60
</span><span id=line61>61
</span><span id=line62>62
</span><span id=line63>63
</span><span id=line64>64
</span><span id=line65>65
</span><span id=line66>66
</span><span id=line67>67
</span><span id=line68>68
</span><span id=line69>69
</span><span id=line70>70
</span><span id=line71>71
</span><span id=line72>72
</span><span id=line73>73
</span><span id=line74>74
</span><span id=line75>75
</span><span id=line76>76
</span><span id=line77>77
</span><span id=line78>78
</span><span id=line79>79
</span><span id=line80>80
</span><span id=line81>81
</span><span id=line82>82
</span><span id=line83>83
</span><span id=line84>84
</span><span id=line85>85
</span><span id=line86>86
</span><span id=line87>87
</span><span id=line88>88
</span><span id=line89>89
</span><span id=line90>90
</span><span id=line91>91
</span><span id=line92>92
</span><span id=line93>93
</span><span id=line94>94
</span><span id=line95>95
</span><span id=line96>96
</span><span id=line97>97
</span><span id=line98>98
</span><span id=line99>99
</span><span id=line100>100
</span><span id=line101>101
</span><span id=line102>102
</span><span id=line103>103
</span><span id=line104>104
</span><span id=line105>105
</span><span id=line106>106
</span><span id=line107>107
</span><span id=line108>108
</span><span id=line109>109
</span><span id=line110>110
</span><span id=line111>111
</span><span id=line112>112
</span><span id=line113>113
</span><span id=line114>114
</span><span id=line115>115
</span><span id=line116>116
</span><span id=line117>117
</span><span id=line118>118
</span><span id=line119>119
</span><span id=line120>120
</span><span id=line121>121
</span><span id=line122>122
</span><span id=line123>123
</span><span id=line124>124
</span><span id=line125>125
</span><span id=line126>126
</span><span id=line127>127
</span><span id=line128>128
</span><span id=line129>129
</span><span id=line130>130
</span><span id=line131>131
</span><span id=line132>132
</span><span id=line133>133
</span><span id=line134>134
</span><span id=line135>135
</span><span id=line136>136
</span><span id=line137>137
</span><span id=line138>138
</span><span id=line139>139
</span><span id=line140>140
</span><span id=line141>141
</span><span id=line142>142
</span><span id=line143>143
</span><span id=line144>144
</span><span id=line145>145
</span><span id=line146>146
</span><span id=line147>147
</span><span id=line148>148
</span><span id=line149>149
</span><span id=line150>150
</span><span id=line151>151
</span><span id=line152>152
</span><span id=line153>153
</span><span id=line154>154
</span><span id=line155>155
</span><span id=line156>156
</span><span id=line157>157
</span><span id=line158>158
</span><span id=line159>159
</span><span id=line160>160
</span><span id=line161>161
</span><span id=line162>162
</span><span id=line163>163
</span><span id=line164>164
</span><span id=line165>165
</span><span id=line166>166
</span><span id=line167>167
</span><span id=line168>168
</span><span id=line169>169
</span><span id=line170>170
</span><span id=line171>171
</span><span id=line172>172
</span><span id=line173>173
</span><span id=line174>174
</span><span id=line175>175
</span><span id=line176>176
</span><span id=line177>177
</span><span id=line178>178
</span><span id=line179>179
</span><span id=line180>180
</span><span id=line181>181
</span><span id=line182>182
</span><span id=line183>183
</span><span id=line184>184
</span><span id=line185>185
</span><span id=line186>186
</span><span id=line187>187
</span><span id=line188>188
</span><span id=line189>189
</span><span id=line190>190
</span><span id=line191>191
</span><span id=line192>192
</span><span id=line193>193
</span><span id=line194>194
</span><span id=line195>195
</span><span id=line196>196
</span><span id=line197>197
</span><span id=line198>198
</span><span id=line199>199
</span><span id=line200>200
</span><span id=line201>201
</span><span id=line202>202
</span><span id=line203>203
</span><span id=line204>204
</span><span id=line205>205
</span><span id=line206>206
</span><span id=line207>207
</span><span id=line208>208
</span><span id=line209>209
</span><span id=line210>210
</span><span id=line211>211
</span><span id=line212>212
</span><span id=line213>213
</span><span id=line214>214
</span><span id=line215>215
</span><span id=line216>216
</span><span id=line217>217
</span><span id=line218>218
</span><span id=line219>219
</span><span id=line220>220
</span><span id=line221>221
</span><span id=line222>222
</span><span id=line223>223
</span><span id=line224>224
</span><span id=line225>225
</span><span id=line226>226
</span><span id=line227>227
</span><span id=line228>228
</span><span id=line229>229
</span><span id=line230>230
</span><span id=line231>231
</span><span id=line232>232
</span><span id=line233>233
</span><span id=line234>234
</span><span id=line235>235
</span><span id=line236>236
</span><span id=line237>237
</span><span id=line238>238
</span><span id=line239>239
</span><span id=line240>240
</span><span id=line241>241
</span><span id=line242>242
</span><span id=line243>243
</span><span id=line244>244
</span><span id=line245>245
</span><span id=line246>246
</span><span id=line247>247
</span><span id=line248>248
</span><span id=line249>249
</span><span id=line250>250
</span><span id=line251>251
</span><span id=line252>252
</span><span id=line253>253
</span><span id=line254>254
</span><span id=line255>255
</span><span id=line256>256
</span><span id=line257>257
</span><span id=line258>258
</span><span id=line259>259
</span><span id=line260>260
</span><span id=line261>261
</span><span id=line262>262
</span><span id=line263>263
</span><span id=line264>264
</span><span id=line265>265
</span><span id=line266>266
</span><span id=line267>267
</span><span id=line268>268
</span><span id=line269>269
</span><span id=line270>270
</span><span id=line271>271
</span><span id=line272>272
</span><span id=line273>273
</span><span id=line274>274
</span><span id=line275>275
</span><span id=line276>276
</span><span id=line277>277
</span><span id=line278>278
</span><span id=line279>279
</span><span id=line280>280
</span><span id=line281>281
</span><span id=line282>282
</span><span id=line283>283
</span><span id=line284>284
</span><span id=line285>285
</span><span id=line286>286
</span><span id=line287>287
</span><span id=line288>288
</span><span id=line289>289
</span><span id=line290>290
</span><span id=line291>291
</span><span id=line292>292
</span><span id=line293>293
</span><span id=line294>294
</span><span id=line295>295
</span><span id=line296>296
</span><span id=line297>297
</span><span id=line298>298
</span><span id=line299>299
</span><span id=line300>300
</span><span id=line301>301
</span><span id=line302>302
</span><span id=line303>303
</span><span id=line304>304
</span><span id=line305>305
</span><span id=line306>306
</span><span id=line307>307
</span><span id=line308>308
</span><span id=line309>309
</span><span id=line310>310
</span><span id=line311>311
</span><span id=line312>312
</span><span id=line313>313
</span><span id=line314>314
</span><span id=line315>315
</span><span id=line316>316
</span><span id=line317>317
</span><span id=line318>318
</span><span id=line319>319
</span><span id=line320>320
</span><span id=line321>321
</span><span id=line322>322
</span><span id=line323>323
</span><span id=line324>324
</span><span id=line325>325
</span><span id=line326>326
</span><span id=line327>327
</span><span id=line328>328
</span><span id=line329>329
</span><span id=line330>330
</span><span id=line331>331
</span><span id=line332>332
</span><span id=line333>333
</span><span id=line334>334
</span><span id=line335>335
</span><span id=line336>336
</span><span id=line337>337
</span><span id=line338>338
</span><span id=line339>339
</span><span id=line340>340
</span><span id=line341>341
</span><span id=line342>342
</span><span id=line343>343
</span><span id=line344>344
</span><span id=line345>345
</span><span id=line346>346
</span><span id=line347>347
</span><span id=line348>348
</span><span id=line349>349
</span><span id=line350>350
</span><span id=line351>351
</span><span id=line352>352
</span><span id=line353>353
</span><span id=line354>354
</span><span id=line355>355
</span><span id=line356>356
</span><span id=line357>357
</span><span id=line358>358
</span><span id=line359>359
</span><span id=line360>360
</span><span id=line361>361
</span><span id=line362>362
</span><span id=line363>363
</span><span id=line364>364
</span><span id=line365>365
</span><span id=line366>366
</span><span id=line367>367
</span><span id=line368>368
</span><span id=line369>369
</span><span id=line370>370
</span><span id=line371>371
</span><span id=line372>372
</span><span id=line373>373
</span><span id=line374>374
</span><span id=line375>375
</span><span id=line376>376
</span><span id=line377>377
</span><span id=line378>378
</span><span id=line379>379
</span><span id=line380>380
</span><span id=line381>381
</span><span id=line382>382
</span><span id=line383>383
</span><span id=line384>384
</span><span id=line385>385
</span><span id=line386>386
</span><span id=line387>387
</span><span id=line388>388
</span><span id=line389>389
</span><span id=line390>390
</span><span id=line391>391
</span><span id=line392>392
</span><span id=line393>393
</span><span id=line394>394
</span><span id=line395>395
</span><span id=line396>396
</span><span id=line397>397
</span><span id=line398>398
</span><span id=line399>399
</span><span id=line400>400
</span><span id=line401>401
</span><span id=line402>402
</span><span id=line403>403
</span><span id=line404>404
</span><span id=line405>405
</span><span id=line406>406
</span><span id=line407>407
</span><span id=line408>408
</span><span id=line409>409
</span><span id=line410>410
</span><span id=line411>411
</span><span id=line412>412
</span><span id=line413>413
</span><span id=line414>414
</span><span id=line415>415
</span><span id=line416>416
</span><span id=line417>417
</span><span id=line418>418
</span><span id=line419>419
</span><span id=line420>420
</span><span id=line421>421
</span><span id=line422>422
</span><span id=line423>423
</span><span id=line424>424
</span><span id=line425>425
</span><span id=line426>426
</span><span id=line427>427
</span><span id=line428>428
</span><span id=line429>429
</span><span id=line430>430
</span><span id=line431>431
</span><span id=line432>432
</span><span id=line433>433
</span><span id=line434>434
</span><span id=line435>435
</span><span id=line436>436
</span><span id=line437>437
</span><span id=line438>438
</span><span id=line439>439
</span><span id=line440>440
</span><span id=line441>441
</span><span id=line442>442
</span><span id=line443>443
</span><span id=line444>444
</span><span id=line445>445
</span><span id=line446>446
</span><span id=line447>447
</span><span id=line448>448
</span><span id=line449>449
</span><span id=line450>450
</span><span id=line451>451
</span><span id=line452>452
</span><span id=line453>453
</span><span id=line454>454
</span><span id=line455>455
</span><span id=line456>456
</span><span id=line457>457
</span><span id=line458>458
</span><span id=line459>459
</span><span id=line460>460
</span><span id=line461>461
</span><span id=line462>462
</span><span id=line463>463
</span><span id=line464>464
</span><span id=line465>465
</span><span id=line466>466
</span><span id=line467>467
</span><span id=line468>468
</span><span id=line469>469
</span><span id=line470>470
</span><span id=line471>471
</span><span id=line472>472
</span><span id=line473>473
</span><span id=line474>474
</span><span id=line475>475
</span><span id=line476>476
</span><span id=line477>477
</span><span id=line478>478
</span><span id=line479>479
</span><span id=line480>480
</span><span id=line481>481
</span><span id=line482>482
</span><span id=line483>483
</span><span id=line484>484
</span><span id=line485>485
</span><span id=line486>486
</span><span id=line487>487
</span><span id=line488>488
</span><span id=line489>489
</span><span id=line490>490
</span><span id=line491>491
</span><span id=line492>492
</span><span id=line493>493
</span><span id=line494>494
</span><span id=line495>495
</span><span id=line496>496
</span><span id=line497>497
</span><span id=line498>498
</span><span id=line499>499
</span><span id=line500>500
</span><span id=line501>501
</span><span id=line502>502
</span><span id=line503>503
</span><span id=line504>504
</span><span id=line505>505
</span><span id=line506>506
</span><span id=line507>507
</span><span id=line508>508
</span><span id=line509>509
</span><span id=line510>510
</span><span id=line511>511
</span><span id=line512>512
</span><span id=line513>513
</span><span id=line514>514
</span><span id=line515>515
</span><span id=line516>516
</span><span id=line517>517
</span><span id=line518>518
</span><span id=line519>519
</span><span id=line520>520
</span><span id=line521>521
</span><span id=line522>522
</span><span id=line523>523
</span><span id=line524>524
</span><span id=line525>525
</span><span id=line526>526
</span><span id=line527>527
</span><span id=line528>528
</span><span id=line529>529
</span><span id=line530>530
</span><span id=line531>531
</span><span id=line532>532
</span><span id=line533>533
</span><span id=line534>534
</span><span id=line535>535
</span><span id=line536>536
</span><span id=line537>537
</span><span id=line538>538
</span><span id=line539>539
</span><span id=line540>540
</span><span id=line541>541
</span><span id=line542>542
</span><span id=line543>543
</span><span id=line544>544
</span><span id=line545>545
</span><span id=line546>546
</span><span id=line547>547
</span><span id=line548>548
</span><span id=line549>549
</span><span id=line550>550
</span><span id=line551>551
</span><span id=line552>552
</span><span id=line553>553
</span><span id=line554>554
</span><span id=line555>555
</span><span id=line556>556
</span><span id=line557>557
</span><span id=line558>558
</span><span id=line559>559
</span><span id=line560>560
</span><span id=line561>561
</span><span id=line562>562
</span><span id=line563>563
</span><span id=line564>564
</span><span id=line565>565
</span><span id=line566>566
</span><span id=line567>567
</span><span id=line568>568
</span><span id=line569>569
</span><span id=line570>570
</span><span id=line571>571
</span><span id=line572>572
</span><span id=line573>573
</span><span id=line574>574
</span><span id=line575>575
</span><span id=line576>576
</span><span id=line577>577
</span><span id=line578>578
</span><span id=line579>579
</span><span id=line580>580
</span><span id=line581>581
</span><span id=line582>582
</span><span id=line583>583
</span><span id=line584>584
</span><span id=line585>585
</span><span id=line586>586
</span><span id=line587>587
</span><span id=line588>588
</span><span id=line589>589
</span><span id=line590>590
</span><span id=line591>591
</span><span id=line592>592
</span><span id=line593>593
</span><span id=line594>594
</span><span id=line595>595
</span><span id=line596>596
</span><span id=line597>597
</span><span id=line598>598
</span><span id=line599>599
</span><span id=line600>600
</span><span id=line601>601
</span><span id=line602>602
</span><span id=line603>603
</span><span id=line604>604
</span><span id=line605>605
</span><span id=line606>606
</span><span id=line607>607
</span><span id=line608>608
</span><span id=line609>609
</span><span id=line610>610
</span><span id=line611>611
</span><span id=line612>612
</span><span id=line613>613
</span><span id=line614>614
</span><span id=line615>615
</span><span id=line616>616
</span><span id=line617>617
</span><span id=line618>618
</span><span id=line619>619
</span><span id=line620>620
</span><span id=line621>621
</span><span id=line622>622
</span><span id=line623>623
</span><span id=line624>624
</span><span id=line625>625
</span><span id=line626>626
</span><span id=line627>627
</span><span id=line628>628
</span><span id=line629>629
</span><span id=line630>630
</span><span id=line631>631
</span><span id=line632>632
</span><span id=line633>633
</span><span id=line634>634
</span><span id=line635>635
</span><span id=line636>636
</span><span id=line637>637
</span><span id=line638>638
</span><span id=line639>639
</span><span id=line640>640
</span><span id=line641>641
</span><span id=line642>642
</span><span id=line643>643
</span><span id=line644>644
</span><span id=line645>645
</span><span id=line646>646
</span><span id=line647>647
</span><span id=line648>648
</span></pre></td><td><pre>
(eval-when (compile load eval) <span class=pc2 title="line 1 char 32 count 1">(</span><span class=pc2 title="line 1 char 33 count 1">optimize-level</span><span class=pc2 title="line 1 char 32 count 1"> </span><span class=pc2 title="line 1 char 48 count 1">3</span><span class=pc2 title="line 1 char 32 count 1">)</span>)
(meta define do-assert? <span class=pc2 title="line 2 char 25 count 1">#f</span>)

(define-syntax do-assert
  <span class=pc2 title="line 5 char 3 count 1">(lambda (x)</span>
    <span class=pc2 title="line 6 char 5 count 34">(syntax-case </span><span class=pc2 title="line 6 char 18 count 34">x</span><span class=pc2 title="line 6 char 5 count 34"> ()</span>
      <span class=pc2 title="line 6 char 5 count 34">[(_ expr)</span>
       <span class=pc2 title="line 8 char 8 count 34">do-assert?</span>
       <span class=pc2 title="line 6 char 5 count 34">#'(let ([result expr])</span>
          <span class=pc2 title="line 6 char 5 count 34">(when (not result)</span>
                <span class=pc2 title="line 6 char 5 count 34">(printf "~a\n" 'expr)</span>
                <span class=pc2 title="line 6 char 5 count 34">(assert result)))]</span>
      <span class=pc2 title="line 6 char 5 count 34">[else </span><span class=pc2 title="line 13 char 13 count 34">#f</span><span class=pc2 title="line 6 char 5 count 34">])</span><span class=pc2 title="line 5 char 3 count 1">)</span>)

(define-syntax inc!
  (syntax-rules ()
    [(_ x) (set! x (<span class=pc12 title="line 17 char 21 count 751,093,085">fx+</span> x <span class=pc12 title="line 17 char 27 count 751,093,085">1</span>))]
    [(_ x d) (set! x (fx+ x d))]))

(define-syntax dec!
  (syntax-rules ()
    [(_ x) (set! x (<span class=pc2 title="line 22 char 21 count 999,998">fx-</span> x <span class=pc2 title="line 22 char 27 count 999,998">1</span>))]
    [(_ x d) (set! x (fx- x d))]))

<span class=pc2 title="line 25 char 1 count 1">(define (tim-sort-range! lt? v lo hi)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define MIN_MERGE </span><span class=pc2 title="line 26 char 21 count 12">32</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define MIN_GALLOP </span><span class=pc2 title="line 27 char 22 count 12">7</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define INITIAL_TMP_STORAGE_LENGTH </span><span class=pc2 title="line 28 char 38 count 12">256</span><span class=pc2 title="line 25 char 1 count 1">)</span>

  <span class=pc2 title="line 25 char 1 count 1">(define range-length </span><span class=pc2 title="line 30 char 24 count 12">(</span><span class=pc2 title="line 30 char 25 count 12">fx-</span><span class=pc2 title="line 30 char 24 count 12"> </span><span class=pc2 title="line 30 char 29 count 12">hi</span><span class=pc2 title="line 30 char 24 count 12"> </span><span class=pc2 title="line 30 char 32 count 12">lo</span><span class=pc2 title="line 30 char 24 count 12">)</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define min-gallop </span><span class=pc2 title="line 31 char 22 count 12">MIN_GALLOP</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define tmp-array)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define run-bases)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define run-lengths)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define stack-size </span><span class=pc2 title="line 35 char 22 count 12">0</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define stack-length</span>
    <span class=pc2 title="line 37 char 5 count 12">(cond</span>
      <span class=pc2 title="line 37 char 5 count 12">[</span><span class=pc2 title="line 38 char 8 count 12">(</span><span class=pc2 title="line 38 char 9 count 12">fx&lt;</span><span class=pc2 title="line 38 char 8 count 12"> </span><span class=pc2 title="line 38 char 13 count 12">range-length</span><span class=pc2 title="line 38 char 8 count 12"> </span><span class=pc2 title="line 38 char 26 count 12">120</span><span class=pc2 title="line 38 char 8 count 12">)</span><span class=pc2 title="line 37 char 5 count 12"> </span><span class=pc2 title="line 38 char 31 count 4">5</span><span class=pc2 title="line 37 char 5 count 12">]</span>
      <span class=pc2 title="line 37 char 5 count 12">[</span><span class=pc2 title="line 39 char 8 count 8">(</span><span class=pc2 title="line 39 char 9 count 8">fx&lt;</span><span class=pc2 title="line 39 char 8 count 8"> </span><span class=pc2 title="line 39 char 13 count 8">range-length</span><span class=pc2 title="line 39 char 8 count 8"> </span><span class=pc2 title="line 39 char 26 count 8">1542</span><span class=pc2 title="line 39 char 8 count 8">)</span><span class=pc2 title="line 37 char 5 count 12"> </span><span class=pc1 title="line 39 char 32 count 0">10</span><span class=pc2 title="line 37 char 5 count 12">]</span>
      <span class=pc2 title="line 37 char 5 count 12">[</span><span class=pc2 title="line 40 char 8 count 8">(</span><span class=pc2 title="line 40 char 9 count 8">fx&lt;</span><span class=pc2 title="line 40 char 8 count 8"> </span><span class=pc2 title="line 40 char 13 count 8">range-length</span><span class=pc2 title="line 40 char 8 count 8"> </span><span class=pc2 title="line 40 char 26 count 8">119151</span><span class=pc2 title="line 40 char 8 count 8">)</span><span class=pc2 title="line 37 char 5 count 12"> </span><span class=pc1 title="line 40 char 34 count 0">24</span><span class=pc2 title="line 37 char 5 count 12">]</span>
      <span class=pc2 title="line 37 char 5 count 12">[else </span><span class=pc2 title="line 41 char 13 count 8">40</span><span class=pc2 title="line 37 char 5 count 12">])</span><span class=pc2 title="line 25 char 1 count 1">)</span>
  <span class=pc2 title="line 42 char 3 count 12">(define (init-stack-and-tmp-array)</span>
    <span class=pc2 title="line 43 char 5 count 8">(set! run-bases </span><span class=pc2 title="line 43 char 21 count 8">(</span><span class=pc2 title="line 43 char 22 count 8">make-fxvector</span><span class=pc2 title="line 43 char 21 count 8"> </span><span class=pc2 title="line 43 char 36 count 8">stack-length</span><span class=pc2 title="line 43 char 21 count 8">)</span><span class=pc2 title="line 43 char 5 count 8">)</span>
    <span class=pc2 title="line 44 char 5 count 8">(set! run-lengths </span><span class=pc2 title="line 44 char 23 count 8">(</span><span class=pc2 title="line 44 char 24 count 8">make-fxvector</span><span class=pc2 title="line 44 char 23 count 8"> </span><span class=pc2 title="line 44 char 38 count 8">stack-length</span><span class=pc2 title="line 44 char 23 count 8">)</span><span class=pc2 title="line 44 char 5 count 8">)</span>
    <span class=pc2 title="line 45 char 5 count 8">(set! tmp-array</span>
          <span class=pc2 title="line 46 char 11 count 8">(</span><span class=pc2 title="line 46 char 12 count 8">make-vector</span>
            <span class=pc2 title="line 47 char 13 count 8">(if </span><span class=pc2 title="line 47 char 17 count 8">(</span><span class=pc2 title="line 47 char 18 count 8">fx&lt;</span><span class=pc2 title="line 47 char 17 count 8"> </span><span class=pc2 title="line 47 char 22 count 8">range-length</span><span class=pc2 title="line 47 char 17 count 8"> </span><span class=pc2 title="line 47 char 35 count 8">(</span><span class=pc2 title="line 47 char 36 count 8">*</span><span class=pc2 title="line 47 char 35 count 8"> </span><span class=pc2 title="line 47 char 38 count 8">2</span><span class=pc2 title="line 47 char 35 count 8"> </span><span class=pc2 title="line 47 char 40 count 8">INITIAL_TMP_STORAGE_LENGTH</span><span class=pc2 title="line 47 char 35 count 8">)</span><span class=pc2 title="line 47 char 17 count 8">)</span>
                <span class=pc1 title="line 48 char 17 count 0">(</span><span class=pc1 title="line 48 char 18 count 0">fxsll</span><span class=pc1 title="line 48 char 17 count 0"> </span><span class=pc1 title="line 48 char 24 count 0">range-length</span><span class=pc1 title="line 48 char 17 count 0"> </span><span class=pc1 title="line 48 char 37 count 0">1</span><span class=pc1 title="line 48 char 17 count 0">)</span>
                <span class=pc2 title="line 49 char 17 count 8">INITIAL_TMP_STORAGE_LENGTH</span><span class=pc2 title="line 47 char 13 count 8">)</span><span class=pc2 title="line 46 char 11 count 8">)</span><span class=pc2 title="line 45 char 5 count 8">)</span><span class=pc2 title="line 42 char 3 count 12">)</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax t-get</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i) (</span><span class=pc11 title="line 52 char 15 count 558,109,318">vector-ref</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc11 title="line 52 char 26 count 558,109,318">tmp-array</span><span class=pc2 title="line 25 char 1 count 1"> i)]))</span>

  <span class=pc2 title="line 25 char 1 count 1">(define-syntax v-get</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i) (</span><span class=pc12 title="line 56 char 15 count 815,469,887">vector-ref</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc12 title="line 56 char 26 count 815,469,887">v</span><span class=pc2 title="line 25 char 1 count 1"> i)]))</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax v-set!</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i val) (</span><span class=pc10 title="line 59 char 19 count 439,543,843">vector-set!</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc10 title="line 59 char 31 count 439,543,843">v</span><span class=pc2 title="line 25 char 1 count 1"> i val)]))</span>

  <span class=pc2 title="line 25 char 1 count 1">(define-syntax rb-get</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i) (</span><span class=pc2 title="line 63 char 15 count 1,999,996">fxvector-ref</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 63 char 28 count 1,999,996">run-bases</span><span class=pc2 title="line 25 char 1 count 1"> i)]))</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax rb-set!</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i val) (</span><span class=pc2 title="line 66 char 19 count 1,000,006">fxvector-set!</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 66 char 33 count 1,000,006">run-bases</span><span class=pc2 title="line 25 char 1 count 1"> i val)]))</span>

  <span class=pc2 title="line 25 char 1 count 1">(define-syntax rl-get</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i) (</span><span class=pc2 title="line 70 char 15 count 11,998,622">fxvector-ref</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 70 char 28 count 11,998,622">run-lengths</span><span class=pc2 title="line 25 char 1 count 1"> i)]))</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax rl-set!</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ i val) (</span><span class=pc2 title="line 73 char 19 count 2,000,004">fxvector-set!</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 73 char 33 count 2,000,004">run-lengths</span><span class=pc2 title="line 25 char 1 count 1"> i val)]))</span>

  <span class=pc2 title="line 75 char 3 count 12">(define (push-run! run-base run-length)</span>
    <span class=pc2 title="line 76 char 5 count 1,000,006">(rb-set! </span><span class=pc2 title="line 76 char 14 count 1,000,006">stack-size</span><span class=pc2 title="line 76 char 5 count 1,000,006"> </span><span class=pc2 title="line 76 char 25 count 1,000,006">run-base</span><span class=pc2 title="line 76 char 5 count 1,000,006">)</span>
    <span class=pc2 title="line 77 char 5 count 1,000,006">(rl-set! </span><span class=pc2 title="line 77 char 14 count 1,000,006">stack-size</span><span class=pc2 title="line 77 char 5 count 1,000,006"> </span><span class=pc2 title="line 77 char 25 count 1,000,006">run-length</span><span class=pc2 title="line 77 char 5 count 1,000,006">)</span>
    <span class=pc2 title="line 78 char 5 count 1,000,006">(inc! </span><span class=pc2 title="line 78 char 11 count 1,000,006">stack-size</span><span class=pc2 title="line 78 char 5 count 1,000,006">)</span><span class=pc2 title="line 75 char 3 count 12">)</span>

  <span class=pc2 title="line 80 char 3 count 12">(define (tmp-array-length min-gallop)</span>
    <span class=pc2 title="line 81 char 5 count 30">(let ([new-size </span><span class=pc2 title="line 81 char 21 count 30">min-gallop</span><span class=pc2 title="line 81 char 5 count 30">])</span>
      <span class=pc2 title="line 82 char 7 count 30">(set! new-size </span><span class=pc2 title="line 82 char 22 count 30">(</span><span class=pc2 title="line 82 char 23 count 30">fxlogor</span><span class=pc2 title="line 82 char 22 count 30"> </span><span class=pc2 title="line 82 char 31 count 30">new-size</span><span class=pc2 title="line 82 char 22 count 30"> </span><span class=pc2 title="line 82 char 40 count 30">(</span><span class=pc2 title="line 82 char 41 count 30">fxsrl</span><span class=pc2 title="line 82 char 40 count 30"> </span><span class=pc2 title="line 82 char 47 count 30">new-size</span><span class=pc2 title="line 82 char 40 count 30"> </span><span class=pc2 title="line 82 char 56 count 30">1</span><span class=pc2 title="line 82 char 40 count 30">)</span><span class=pc2 title="line 82 char 22 count 30">)</span><span class=pc2 title="line 82 char 7 count 30">)</span>
      <span class=pc2 title="line 83 char 7 count 30">(set! new-size </span><span class=pc2 title="line 83 char 22 count 30">(</span><span class=pc2 title="line 83 char 23 count 30">fxlogor</span><span class=pc2 title="line 83 char 22 count 30"> </span><span class=pc2 title="line 83 char 31 count 30">new-size</span><span class=pc2 title="line 83 char 22 count 30"> </span><span class=pc2 title="line 83 char 40 count 30">(</span><span class=pc2 title="line 83 char 41 count 30">fxsrl</span><span class=pc2 title="line 83 char 40 count 30"> </span><span class=pc2 title="line 83 char 47 count 30">new-size</span><span class=pc2 title="line 83 char 40 count 30"> </span><span class=pc2 title="line 83 char 56 count 30">2</span><span class=pc2 title="line 83 char 40 count 30">)</span><span class=pc2 title="line 83 char 22 count 30">)</span><span class=pc2 title="line 83 char 7 count 30">)</span>
      <span class=pc2 title="line 84 char 7 count 30">(set! new-size </span><span class=pc2 title="line 84 char 22 count 30">(</span><span class=pc2 title="line 84 char 23 count 30">fxlogor</span><span class=pc2 title="line 84 char 22 count 30"> </span><span class=pc2 title="line 84 char 31 count 30">new-size</span><span class=pc2 title="line 84 char 22 count 30"> </span><span class=pc2 title="line 84 char 40 count 30">(</span><span class=pc2 title="line 84 char 41 count 30">fxsrl</span><span class=pc2 title="line 84 char 40 count 30"> </span><span class=pc2 title="line 84 char 47 count 30">new-size</span><span class=pc2 title="line 84 char 40 count 30"> </span><span class=pc2 title="line 84 char 56 count 30">4</span><span class=pc2 title="line 84 char 40 count 30">)</span><span class=pc2 title="line 84 char 22 count 30">)</span><span class=pc2 title="line 84 char 7 count 30">)</span>
      <span class=pc2 title="line 85 char 7 count 30">(set! new-size </span><span class=pc2 title="line 85 char 22 count 30">(</span><span class=pc2 title="line 85 char 23 count 30">fxlogor</span><span class=pc2 title="line 85 char 22 count 30"> </span><span class=pc2 title="line 85 char 31 count 30">new-size</span><span class=pc2 title="line 85 char 22 count 30"> </span><span class=pc2 title="line 85 char 40 count 30">(</span><span class=pc2 title="line 85 char 41 count 30">fxsrl</span><span class=pc2 title="line 85 char 40 count 30"> </span><span class=pc2 title="line 85 char 47 count 30">new-size</span><span class=pc2 title="line 85 char 40 count 30"> </span><span class=pc2 title="line 85 char 56 count 30">8</span><span class=pc2 title="line 85 char 40 count 30">)</span><span class=pc2 title="line 85 char 22 count 30">)</span><span class=pc2 title="line 85 char 7 count 30">)</span>
      <span class=pc2 title="line 86 char 7 count 30">(set! new-size </span><span class=pc2 title="line 86 char 22 count 30">(</span><span class=pc2 title="line 86 char 23 count 30">fxlogor</span><span class=pc2 title="line 86 char 22 count 30"> </span><span class=pc2 title="line 86 char 31 count 30">new-size</span><span class=pc2 title="line 86 char 22 count 30"> </span><span class=pc2 title="line 86 char 40 count 30">(</span><span class=pc2 title="line 86 char 41 count 30">fxsrl</span><span class=pc2 title="line 86 char 40 count 30"> </span><span class=pc2 title="line 86 char 47 count 30">new-size</span><span class=pc2 title="line 86 char 40 count 30"> </span><span class=pc2 title="line 86 char 56 count 30">16</span><span class=pc2 title="line 86 char 40 count 30">)</span><span class=pc2 title="line 86 char 22 count 30">)</span><span class=pc2 title="line 86 char 7 count 30">)</span>
      <span class=pc2 title="line 87 char 7 count 30">(set! new-size </span><span class=pc2 title="line 87 char 22 count 30">(</span><span class=pc2 title="line 87 char 23 count 30">fx+</span><span class=pc2 title="line 87 char 22 count 30"> </span><span class=pc2 title="line 87 char 27 count 30">new-size</span><span class=pc2 title="line 87 char 22 count 30"> </span><span class=pc2 title="line 87 char 36 count 30">1</span><span class=pc2 title="line 87 char 22 count 30">)</span><span class=pc2 title="line 87 char 7 count 30">)</span>
      <span class=pc2 title="line 88 char 7 count 30">(if </span><span class=pc2 title="line 88 char 11 count 30">(</span><span class=pc2 title="line 88 char 12 count 30">fx&lt;</span><span class=pc2 title="line 88 char 11 count 30"> </span><span class=pc2 title="line 88 char 16 count 30">new-size</span><span class=pc2 title="line 88 char 11 count 30"> </span><span class=pc2 title="line 88 char 25 count 30">0</span><span class=pc2 title="line 88 char 11 count 30">)</span>
          <span class=pc1 title="line 89 char 11 count 0">min-gallop</span>
          <span class=pc2 title="line 90 char 11 count 30">(</span><span class=pc2 title="line 90 char 12 count 30">min</span><span class=pc2 title="line 90 char 11 count 30"> </span><span class=pc2 title="line 90 char 16 count 30">new-size</span><span class=pc2 title="line 90 char 11 count 30"> </span><span class=pc2 title="line 90 char 25 count 30">(</span><span class=pc2 title="line 90 char 26 count 30">fxsra</span><span class=pc2 title="line 90 char 25 count 30"> </span><span class=pc2 title="line 90 char 32 count 30">range-length</span><span class=pc2 title="line 90 char 25 count 30"> </span><span class=pc2 title="line 90 char 45 count 30">1</span><span class=pc2 title="line 90 char 25 count 30">)</span><span class=pc2 title="line 90 char 11 count 30">)</span><span class=pc2 title="line 88 char 7 count 30">)</span><span class=pc2 title="line 81 char 5 count 30">)</span><span class=pc2 title="line 80 char 3 count 12">)</span>

  <span class=pc2 title="line 92 char 3 count 12">(define (ensure-capacity! min-gallop)</span>
    <span class=pc2 title="line 93 char 5 count 999,998">(if </span><span class=pc2 title="line 93 char 9 count 999,998">(</span><span class=pc2 title="line 93 char 10 count 999,998">fx&lt;</span><span class=pc2 title="line 93 char 9 count 999,998"> </span><span class=pc2 title="line 93 char 14 count 999,998">(</span><span class=pc2 title="line 93 char 15 count 999,998">vector-length</span><span class=pc2 title="line 93 char 14 count 999,998"> </span><span class=pc2 title="line 93 char 29 count 999,998">tmp-array</span><span class=pc2 title="line 93 char 14 count 999,998">)</span><span class=pc2 title="line 93 char 9 count 999,998"> </span><span class=pc2 title="line 93 char 40 count 999,998">min-gallop</span><span class=pc2 title="line 93 char 9 count 999,998">)</span>
        <span class=pc2 title="line 94 char 9 count 30">(let ([len </span><span class=pc2 title="line 94 char 20 count 30">(</span><span class=pc2 title="line 94 char 21 count 30">tmp-array-length</span><span class=pc2 title="line 94 char 20 count 30"> </span><span class=pc2 title="line 94 char 38 count 30">min-gallop</span><span class=pc2 title="line 94 char 20 count 30">)</span><span class=pc2 title="line 94 char 9 count 30">])</span>
          <span class=pc2 title="line 94 char 9 count 30">; (printf "[94] old-length: ~a\n" (vector-length tmp-array))</span>
          <span class=pc2 title="line 94 char 9 count 30">; (printf "[95] new-length: ~a\n" len)</span>
          <span class=pc2 title="line 97 char 11 count 30">(set! tmp-array </span><span class=pc2 title="line 97 char 27 count 30">(</span><span class=pc2 title="line 97 char 28 count 30">make-vector</span><span class=pc2 title="line 97 char 27 count 30"> </span><span class=pc2 title="line 97 char 40 count 30">len</span><span class=pc2 title="line 97 char 27 count 30">)</span><span class=pc2 title="line 97 char 11 count 30">)</span><span class=pc2 title="line 94 char 9 count 30">)</span><span class=pc2 title="line 93 char 5 count 999,998">)</span><span class=pc2 title="line 92 char 3 count 12">)</span>

  <span class=pc2 title="line 99 char 3 count 12">(define (vector-copy! vsrc isrc vdst idst len)</span>
    <span class=pc2 title="line 99 char 3 count 12">(define-syntax copy-loop</span>
      <span class=pc2 title="line 99 char 3 count 12">(syntax-rules ()</span>
        <span class=pc2 title="line 99 char 3 count 12">[(_ end* isrc* idst* next predict)</span>
         <span class=pc2 title="line 99 char 3 count 12">(let ([end end*])</span>
           <span class=pc2 title="line 99 char 3 count 12">(let loop ([isrc isrc*][idst idst*])</span>
             <span class=pc2 title="line 99 char 3 count 12">(when (predict </span><span class=pc8 title="line 105 char 29 count 292,433,959">isrc</span><span class=pc2 title="line 99 char 3 count 12"> </span><span class=pc8 title="line 105 char 34 count 292,433,959">end</span><span class=pc2 title="line 99 char 3 count 12">)</span>
                   <span class=pc8 title="line 106 char 20 count 276,885,965">(</span><span class=pc8 title="line 106 char 21 count 276,885,965">vector-set!</span><span class=pc8 title="line 106 char 20 count 276,885,965"> </span><span class=pc8 title="line 106 char 33 count 276,885,965">vdst</span><span class=pc8 title="line 106 char 20 count 276,885,965"> </span><span class=pc8 title="line 106 char 38 count 276,885,965">idst</span><span class=pc8 title="line 106 char 20 count 276,885,965"> </span><span class=pc8 title="line 106 char 43 count 276,885,965">(</span><span class=pc8 title="line 106 char 44 count 276,885,965">vector-ref</span><span class=pc8 title="line 106 char 43 count 276,885,965"> </span><span class=pc8 title="line 106 char 55 count 276,885,965">vsrc</span><span class=pc8 title="line 106 char 43 count 276,885,965"> </span><span class=pc8 title="line 106 char 60 count 276,885,965">isrc</span><span class=pc8 title="line 106 char 43 count 276,885,965">)</span><span class=pc8 title="line 106 char 20 count 276,885,965">)</span>
                   <span class=pc2 title="line 99 char 3 count 12">(</span><span class=pc8 title="line 107 char 21 count 276,885,965">loop</span><span class=pc2 title="line 99 char 3 count 12"> (next </span><span class=pc8 title="line 107 char 32 count 276,885,965">isrc</span><span class=pc2 title="line 99 char 3 count 12"> </span><span class=pc8 title="line 107 char 37 count 276,885,965">1</span><span class=pc2 title="line 99 char 3 count 12">) (next </span><span class=pc8 title="line 107 char 46 count 276,885,965">idst</span><span class=pc2 title="line 99 char 3 count 12"> </span><span class=pc8 title="line 107 char 51 count 276,885,965">1</span><span class=pc2 title="line 99 char 3 count 12">)))))]))</span>
    <span class=pc2 title="line 108 char 5 count 15,547,994">(if </span><span class=pc2 title="line 108 char 9 count 15,547,994">(</span><span class=pc2 title="line 108 char 10 count 15,547,994">eq?</span><span class=pc2 title="line 108 char 9 count 15,547,994"> </span><span class=pc2 title="line 108 char 14 count 15,547,994">vsrc</span><span class=pc2 title="line 108 char 9 count 15,547,994"> </span><span class=pc2 title="line 108 char 19 count 15,547,994">vdst</span><span class=pc2 title="line 108 char 9 count 15,547,994">)</span>
        <span class=pc2 title="line 109 char 9 count 14,058,092">(cond</span>
          <span class=pc2 title="line 109 char 9 count 14,058,092">[</span><span class=pc2 title="line 110 char 12 count 14,058,092">(</span><span class=pc2 title="line 110 char 13 count 14,058,092">fx&lt;</span><span class=pc2 title="line 110 char 12 count 14,058,092"> </span><span class=pc2 title="line 110 char 17 count 14,058,092">isrc</span><span class=pc2 title="line 110 char 12 count 14,058,092"> </span><span class=pc2 title="line 110 char 22 count 14,058,092">idst</span><span class=pc2 title="line 110 char 12 count 14,058,092">)</span><span class=pc2 title="line 109 char 9 count 14,058,092"> </span><span class=pc2 title="line 110 char 28 count 13,717,744">(copy-loop </span><span class=pc2 title="line 110 char 39 count 13,717,744">isrc</span><span class=pc2 title="line 110 char 28 count 13,717,744"> </span><span class=pc2 title="line 110 char 44 count 13,717,744">(</span><span class=pc2 title="line 110 char 45 count 13,717,744">fx+</span><span class=pc2 title="line 110 char 44 count 13,717,744"> </span><span class=pc2 title="line 110 char 49 count 13,717,744">isrc</span><span class=pc2 title="line 110 char 44 count 13,717,744"> </span><span class=pc2 title="line 110 char 54 count 13,717,744">len</span><span class=pc2 title="line 110 char 44 count 13,717,744"> </span><span class=pc2 title="line 110 char 58 count 13,717,744">-1</span><span class=pc2 title="line 110 char 44 count 13,717,744">)</span><span class=pc2 title="line 110 char 28 count 13,717,744"> </span><span class=pc2 title="line 110 char 62 count 13,717,744">(</span><span class=pc2 title="line 110 char 63 count 13,717,744">fx+</span><span class=pc2 title="line 110 char 62 count 13,717,744"> </span><span class=pc2 title="line 110 char 67 count 13,717,744">idst</span><span class=pc2 title="line 110 char 62 count 13,717,744"> </span><span class=pc2 title="line 110 char 72 count 13,717,744">len</span><span class=pc2 title="line 110 char 62 count 13,717,744"> </span><span class=pc2 title="line 110 char 76 count 13,717,744">-1</span><span class=pc2 title="line 110 char 62 count 13,717,744">)</span><span class=pc2 title="line 110 char 28 count 13,717,744"> </span><span class=pc6 title="line 110 char 80 count 177,394,234">fx-</span><span class=pc2 title="line 110 char 28 count 13,717,744"> </span><span class=pc5 title="line 110 char 84 count 102,414,861">fx&gt;=</span><span class=pc2 title="line 110 char 28 count 13,717,744">)</span><span class=pc2 title="line 109 char 9 count 14,058,092">]</span>
          <span class=pc2 title="line 109 char 9 count 14,058,092">[</span><span class=pc2 title="line 111 char 12 count 340,348">(</span><span class=pc2 title="line 111 char 13 count 340,348">fx&gt;</span><span class=pc2 title="line 111 char 12 count 340,348"> </span><span class=pc2 title="line 111 char 17 count 340,348">isrc</span><span class=pc2 title="line 111 char 12 count 340,348"> </span><span class=pc2 title="line 111 char 22 count 340,348">idst</span><span class=pc2 title="line 111 char 12 count 340,348">)</span><span class=pc2 title="line 109 char 9 count 14,058,092"> </span><span class=pc2 title="line 111 char 28 count 340,348">(copy-loop </span><span class=pc2 title="line 111 char 39 count 340,348">(</span><span class=pc2 title="line 111 char 40 count 340,348">fx+</span><span class=pc2 title="line 111 char 39 count 340,348"> </span><span class=pc2 title="line 111 char 44 count 340,348">isrc</span><span class=pc2 title="line 111 char 39 count 340,348"> </span><span class=pc2 title="line 111 char 49 count 340,348">len</span><span class=pc2 title="line 111 char 39 count 340,348">)</span><span class=pc2 title="line 111 char 28 count 340,348"> </span><span class=pc2 title="line 111 char 54 count 340,348">isrc</span><span class=pc2 title="line 111 char 28 count 340,348"> </span><span class=pc2 title="line 111 char 59 count 340,348">idst</span><span class=pc2 title="line 111 char 28 count 340,348"> </span><span class=pc2 title="line 111 char 64 count 1,336,256">fx+</span><span class=pc2 title="line 111 char 28 count 340,348"> </span><span class=pc2 title="line 111 char 68 count 1,008,476">fx&lt;</span><span class=pc2 title="line 111 char 28 count 340,348">)</span><span class=pc2 title="line 109 char 9 count 14,058,092">]</span>
          <span class=pc2 title="line 109 char 9 count 14,058,092">[else </span><span class=pc1 title="line 112 char 17 count 0">#f</span><span class=pc2 title="line 109 char 9 count 14,058,092">])</span>
        <span class=pc2 title="line 113 char 9 count 1,489,902">(copy-loop </span><span class=pc2 title="line 113 char 20 count 1,489,902">(</span><span class=pc2 title="line 113 char 21 count 1,489,902">fx+</span><span class=pc2 title="line 113 char 20 count 1,489,902"> </span><span class=pc2 title="line 113 char 25 count 1,489,902">isrc</span><span class=pc2 title="line 113 char 20 count 1,489,902"> </span><span class=pc2 title="line 113 char 30 count 1,489,902">len</span><span class=pc2 title="line 113 char 20 count 1,489,902">)</span><span class=pc2 title="line 113 char 9 count 1,489,902"> </span><span class=pc2 title="line 113 char 35 count 1,489,902">isrc</span><span class=pc2 title="line 113 char 9 count 1,489,902"> </span><span class=pc2 title="line 113 char 40 count 1,489,902">idst</span><span class=pc2 title="line 113 char 9 count 1,489,902"> </span><span class=pc9 title="line 113 char 45 count 375,041,440">fx+</span><span class=pc2 title="line 113 char 9 count 1,489,902"> </span><span class=pc7 title="line 113 char 49 count 189,010,622">fx&lt;</span><span class=pc2 title="line 113 char 9 count 1,489,902">)</span><span class=pc2 title="line 108 char 5 count 15,547,994">)</span><span class=pc2 title="line 99 char 3 count 12">)</span>

  <span class=pc2 title="line 115 char 3 count 12">(define (binary-insertion-sort lo hi start)</span>
    <span class=pc2 title="line 116 char 5 count 1,000,004">(do-assert (and (fx&lt;= lo start) (fx&lt;= start hi)))</span>

    <span class=pc2 title="line 118 char 5 count 1,000,004">(let for ([start </span><span class=pc2 title="line 118 char 22 count 1,000,004">(or </span><span class=pc2 title="line 118 char 26 count 1,000,004">(and </span><span class=pc2 title="line 118 char 31 count 1,000,004">(</span><span class=pc2 title="line 118 char 32 count 1,000,004">fx=</span><span class=pc2 title="line 118 char 31 count 1,000,004"> </span><span class=pc2 title="line 118 char 36 count 1,000,004">start</span><span class=pc2 title="line 118 char 31 count 1,000,004"> </span><span class=pc2 title="line 118 char 42 count 1,000,004">lo</span><span class=pc2 title="line 118 char 31 count 1,000,004">)</span><span class=pc2 title="line 118 char 26 count 1,000,004"> </span><span class=pc1 title="line 118 char 46 count 0">(</span><span class=pc1 title="line 118 char 47 count 0">fx+</span><span class=pc1 title="line 118 char 46 count 0"> </span><span class=pc1 title="line 118 char 51 count 0">start</span><span class=pc1 title="line 118 char 46 count 0"> </span><span class=pc1 title="line 118 char 57 count 0">1</span><span class=pc1 title="line 118 char 46 count 0">)</span><span class=pc2 title="line 118 char 26 count 1,000,004">)</span><span class=pc2 title="line 118 char 22 count 1,000,004"> </span><span class=pc2 title="line 118 char 61 count 1,000,004">start</span><span class=pc2 title="line 118 char 22 count 1,000,004">)</span><span class=pc2 title="line 118 char 5 count 1,000,004">])</span>
      <span class=pc2 title="line 119 char 7 count 18,562,150">(when </span><span class=pc2 title="line 119 char 13 count 18,562,150">(</span><span class=pc2 title="line 119 char 14 count 18,562,150">fx&lt;</span><span class=pc2 title="line 119 char 13 count 18,562,150"> </span><span class=pc2 title="line 119 char 18 count 18,562,150">start</span><span class=pc2 title="line 119 char 13 count 18,562,150"> </span><span class=pc2 title="line 119 char 24 count 18,562,150">hi</span><span class=pc2 title="line 119 char 13 count 18,562,150">)</span>
            <span class=pc2 title="line 120 char 13 count 17,562,146">(let ([pivot </span><span class=pc2 title="line 120 char 26 count 17,562,146">(v-get </span><span class=pc2 title="line 120 char 33 count 17,562,146">start</span><span class=pc2 title="line 120 char 26 count 17,562,146">)</span><span class=pc2 title="line 120 char 13 count 17,562,146">])</span>
              <span class=pc2 title="line 121 char 15 count 17,562,146">(do-assert (fx&lt;= lo start))</span>
              <span class=pc2 title="line 122 char 15 count 17,562,146">(let while ([left </span><span class=pc2 title="line 122 char 33 count 17,562,146">lo</span><span class=pc2 title="line 122 char 15 count 17,562,146">][right </span><span class=pc2 title="line 122 char 43 count 17,562,146">start</span><span class=pc2 title="line 122 char 15 count 17,562,146">])</span>
                <span class=pc4 title="line 123 char 17 count 77,883,686">(if </span><span class=pc4 title="line 123 char 21 count 77,883,686">(</span><span class=pc4 title="line 123 char 22 count 77,883,686">fx&lt;</span><span class=pc4 title="line 123 char 21 count 77,883,686"> </span><span class=pc4 title="line 123 char 26 count 77,883,686">left</span><span class=pc4 title="line 123 char 21 count 77,883,686"> </span><span class=pc4 title="line 123 char 31 count 77,883,686">right</span><span class=pc4 title="line 123 char 21 count 77,883,686">)</span>
                    <span class=pc4 title="line 124 char 21 count 60,321,540">(let ([mid </span><span class=pc4 title="line 124 char 32 count 60,321,540">(</span><span class=pc4 title="line 124 char 33 count 60,321,540">fxsrl</span><span class=pc4 title="line 124 char 32 count 60,321,540"> </span><span class=pc4 title="line 124 char 39 count 60,321,540">(</span><span class=pc4 title="line 124 char 40 count 60,321,540">fx+</span><span class=pc4 title="line 124 char 39 count 60,321,540"> </span><span class=pc4 title="line 124 char 44 count 60,321,540">left</span><span class=pc4 title="line 124 char 39 count 60,321,540"> </span><span class=pc4 title="line 124 char 49 count 60,321,540">right</span><span class=pc4 title="line 124 char 39 count 60,321,540">)</span><span class=pc4 title="line 124 char 32 count 60,321,540"> </span><span class=pc4 title="line 124 char 56 count 60,321,540">1</span><span class=pc4 title="line 124 char 32 count 60,321,540">)</span><span class=pc4 title="line 124 char 21 count 60,321,540">])</span>
                      <span class=pc4 title="line 125 char 23 count 60,321,540">(if </span><span class=pc4 title="line 125 char 27 count 60,321,540">(</span><span class=pc4 title="line 125 char 28 count 60,321,540">lt?</span><span class=pc4 title="line 125 char 27 count 60,321,540"> </span><span class=pc4 title="line 125 char 32 count 60,321,540">pivot</span><span class=pc4 title="line 125 char 27 count 60,321,540"> </span><span class=pc4 title="line 125 char 38 count 60,321,540">(v-get </span><span class=pc4 title="line 125 char 45 count 60,321,540">mid</span><span class=pc4 title="line 125 char 38 count 60,321,540">)</span><span class=pc4 title="line 125 char 27 count 60,321,540">)</span>
                          <span class=pc3 title="line 126 char 27 count 32,640,471">(</span><span class=pc3 title="line 126 char 28 count 32,640,471">while</span><span class=pc3 title="line 126 char 27 count 32,640,471"> </span><span class=pc3 title="line 126 char 34 count 32,640,471">left</span><span class=pc3 title="line 126 char 27 count 32,640,471"> </span><span class=pc3 title="line 126 char 39 count 32,640,471">mid</span><span class=pc3 title="line 126 char 27 count 32,640,471">)</span>
                          <span class=pc3 title="line 127 char 27 count 27,681,069">(</span><span class=pc3 title="line 127 char 28 count 27,681,069">while</span><span class=pc3 title="line 127 char 27 count 27,681,069"> </span><span class=pc3 title="line 127 char 34 count 27,681,069">(</span><span class=pc3 title="line 127 char 35 count 27,681,069">fx+</span><span class=pc3 title="line 127 char 34 count 27,681,069"> </span><span class=pc3 title="line 127 char 39 count 27,681,069">mid</span><span class=pc3 title="line 127 char 34 count 27,681,069"> </span><span class=pc3 title="line 127 char 43 count 27,681,069">1</span><span class=pc3 title="line 127 char 34 count 27,681,069">)</span><span class=pc3 title="line 127 char 27 count 27,681,069"> </span><span class=pc3 title="line 127 char 46 count 27,681,069">right</span><span class=pc3 title="line 127 char 27 count 27,681,069">)</span><span class=pc4 title="line 125 char 23 count 60,321,540">)</span><span class=pc4 title="line 124 char 21 count 60,321,540">)</span>
                    <span class=pc2 title="line 128 char 21 count 17,562,146">(let ([n </span><span class=pc2 title="line 128 char 30 count 17,562,146">(</span><span class=pc2 title="line 128 char 31 count 17,562,146">fx-</span><span class=pc2 title="line 128 char 30 count 17,562,146"> </span><span class=pc2 title="line 128 char 35 count 17,562,146">start</span><span class=pc2 title="line 128 char 30 count 17,562,146"> </span><span class=pc2 title="line 128 char 41 count 17,562,146">left</span><span class=pc2 title="line 128 char 30 count 17,562,146">)</span><span class=pc2 title="line 128 char 21 count 17,562,146">])</span>
                      <span class=pc2 title="line 129 char 23 count 17,562,146">(do-assert (fx= left right))</span>
                      <span class=pc2 title="line 130 char 23 count 17,562,146">(cond</span>
                        <span class=pc2 title="line 130 char 23 count 17,562,146">[</span><span class=pc2 title="line 131 char 26 count 17,562,146">(</span><span class=pc2 title="line 131 char 27 count 17,562,146">fx=</span><span class=pc2 title="line 131 char 26 count 17,562,146"> </span><span class=pc2 title="line 131 char 31 count 17,562,146">n</span><span class=pc2 title="line 131 char 26 count 17,562,146"> </span><span class=pc2 title="line 131 char 33 count 17,562,146">2</span><span class=pc2 title="line 131 char 26 count 17,562,146">)</span>
                         <span class=pc2 title="line 132 char 26 count 1,928,033">(v-set! </span><span class=pc2 title="line 132 char 34 count 1,928,033">(</span><span class=pc2 title="line 132 char 35 count 1,928,033">fx+</span><span class=pc2 title="line 132 char 34 count 1,928,033"> </span><span class=pc2 title="line 132 char 39 count 1,928,033">left</span><span class=pc2 title="line 132 char 34 count 1,928,033"> </span><span class=pc2 title="line 132 char 44 count 1,928,033">2</span><span class=pc2 title="line 132 char 34 count 1,928,033">)</span><span class=pc2 title="line 132 char 26 count 1,928,033"> </span><span class=pc2 title="line 132 char 47 count 1,928,033">(v-get </span><span class=pc2 title="line 132 char 54 count 1,928,033">(</span><span class=pc2 title="line 132 char 55 count 1,928,033">fx+</span><span class=pc2 title="line 132 char 54 count 1,928,033"> </span><span class=pc2 title="line 132 char 59 count 1,928,033">left</span><span class=pc2 title="line 132 char 54 count 1,928,033"> </span><span class=pc2 title="line 132 char 64 count 1,928,033">1</span><span class=pc2 title="line 132 char 54 count 1,928,033">)</span><span class=pc2 title="line 132 char 47 count 1,928,033">)</span><span class=pc2 title="line 132 char 26 count 1,928,033">)</span>
                         <span class=pc2 title="line 133 char 26 count 1,928,033">(v-set! </span><span class=pc2 title="line 133 char 34 count 1,928,033">(</span><span class=pc2 title="line 133 char 35 count 1,928,033">fx+</span><span class=pc2 title="line 133 char 34 count 1,928,033"> </span><span class=pc2 title="line 133 char 39 count 1,928,033">left</span><span class=pc2 title="line 133 char 34 count 1,928,033"> </span><span class=pc2 title="line 133 char 44 count 1,928,033">1</span><span class=pc2 title="line 133 char 34 count 1,928,033">)</span><span class=pc2 title="line 133 char 26 count 1,928,033"> </span><span class=pc2 title="line 133 char 47 count 1,928,033">(v-get </span><span class=pc2 title="line 133 char 54 count 1,928,033">left</span><span class=pc2 title="line 133 char 47 count 1,928,033">)</span><span class=pc2 title="line 133 char 26 count 1,928,033">)</span><span class=pc2 title="line 130 char 23 count 17,562,146">]</span>
                        <span class=pc2 title="line 130 char 23 count 17,562,146">[</span><span class=pc2 title="line 134 char 26 count 15,634,113">(</span><span class=pc2 title="line 134 char 27 count 15,634,113">fx=</span><span class=pc2 title="line 134 char 26 count 15,634,113"> </span><span class=pc2 title="line 134 char 31 count 15,634,113">n</span><span class=pc2 title="line 134 char 26 count 15,634,113"> </span><span class=pc2 title="line 134 char 33 count 15,634,113">1</span><span class=pc2 title="line 134 char 26 count 15,634,113">)</span>
                         <span class=pc2 title="line 135 char 26 count 2,097,269">(v-set! </span><span class=pc2 title="line 135 char 34 count 2,097,269">(</span><span class=pc2 title="line 135 char 35 count 2,097,269">fx+</span><span class=pc2 title="line 135 char 34 count 2,097,269"> </span><span class=pc2 title="line 135 char 39 count 2,097,269">left</span><span class=pc2 title="line 135 char 34 count 2,097,269"> </span><span class=pc2 title="line 135 char 44 count 2,097,269">1</span><span class=pc2 title="line 135 char 34 count 2,097,269">)</span><span class=pc2 title="line 135 char 26 count 2,097,269"> </span><span class=pc2 title="line 135 char 47 count 2,097,269">(v-get </span><span class=pc2 title="line 135 char 54 count 2,097,269">left</span><span class=pc2 title="line 135 char 47 count 2,097,269">)</span><span class=pc2 title="line 135 char 26 count 2,097,269">)</span><span class=pc2 title="line 130 char 23 count 17,562,146">]</span>
                        <span class=pc2 title="line 130 char 23 count 17,562,146">[else </span><span class=pc2 title="line 136 char 31 count 13,536,844">(</span><span class=pc2 title="line 136 char 32 count 13,536,844">vector-copy!</span><span class=pc2 title="line 136 char 31 count 13,536,844"> </span><span class=pc2 title="line 136 char 45 count 13,536,844">v</span><span class=pc2 title="line 136 char 31 count 13,536,844"> </span><span class=pc2 title="line 136 char 47 count 13,536,844">left</span><span class=pc2 title="line 136 char 31 count 13,536,844"> </span><span class=pc2 title="line 136 char 52 count 13,536,844">v</span><span class=pc2 title="line 136 char 31 count 13,536,844"> </span><span class=pc2 title="line 136 char 54 count 13,536,844">(</span><span class=pc2 title="line 136 char 55 count 13,536,844">fx+</span><span class=pc2 title="line 136 char 54 count 13,536,844"> </span><span class=pc2 title="line 136 char 59 count 13,536,844">left</span><span class=pc2 title="line 136 char 54 count 13,536,844"> </span><span class=pc2 title="line 136 char 64 count 13,536,844">1</span><span class=pc2 title="line 136 char 54 count 13,536,844">)</span><span class=pc2 title="line 136 char 31 count 13,536,844"> </span><span class=pc2 title="line 136 char 67 count 13,536,844">n</span><span class=pc2 title="line 136 char 31 count 13,536,844">)</span><span class=pc2 title="line 130 char 23 count 17,562,146">])</span>
                      <span class=pc2 title="line 137 char 23 count 17,562,146">(v-set! </span><span class=pc2 title="line 137 char 31 count 17,562,146">left</span><span class=pc2 title="line 137 char 23 count 17,562,146"> </span><span class=pc2 title="line 137 char 36 count 17,562,146">pivot</span><span class=pc2 title="line 137 char 23 count 17,562,146">)</span><span class=pc2 title="line 128 char 21 count 17,562,146">)</span><span class=pc4 title="line 123 char 17 count 77,883,686">)</span><span class=pc2 title="line 122 char 15 count 17,562,146">)</span><span class=pc2 title="line 120 char 13 count 17,562,146">)</span>
            <span class=pc2 title="line 138 char 13 count 17,562,146">(</span><span class=pc2 title="line 138 char 14 count 17,562,146">for</span><span class=pc2 title="line 138 char 13 count 17,562,146"> </span><span class=pc2 title="line 138 char 18 count 17,562,146">(</span><span class=pc2 title="line 138 char 19 count 17,562,146">fx+</span><span class=pc2 title="line 138 char 18 count 17,562,146"> </span><span class=pc2 title="line 138 char 23 count 17,562,146">start</span><span class=pc2 title="line 138 char 18 count 17,562,146"> </span><span class=pc2 title="line 138 char 29 count 17,562,146">1</span><span class=pc2 title="line 138 char 18 count 17,562,146">)</span><span class=pc2 title="line 138 char 13 count 17,562,146">)</span><span class=pc2 title="line 119 char 7 count 18,562,150">)</span><span class=pc2 title="line 118 char 5 count 1,000,004">)</span><span class=pc2 title="line 115 char 3 count 12">)</span>

  <span class=pc2 title="line 140 char 3 count 12">(define (reverse-range lo hi)</span>
    <span class=pc3 title="line 141 char 5 count 21,044,468">(if </span><span class=pc3 title="line 141 char 9 count 21,044,468">(</span><span class=pc3 title="line 141 char 10 count 21,044,468">fx&lt;</span><span class=pc3 title="line 141 char 9 count 21,044,468"> </span><span class=pc3 title="line 141 char 14 count 21,044,468">lo</span><span class=pc3 title="line 141 char 9 count 21,044,468"> </span><span class=pc3 title="line 141 char 17 count 21,044,468">hi</span><span class=pc3 title="line 141 char 9 count 21,044,468">)</span>
        <span class=pc3 title="line 142 char 9 count 20,543,810">(let ([t </span><span class=pc3 title="line 142 char 18 count 20,543,810">(v-get </span><span class=pc3 title="line 142 char 25 count 20,543,810">lo</span><span class=pc3 title="line 142 char 18 count 20,543,810">)</span><span class=pc3 title="line 142 char 9 count 20,543,810">])</span>
          <span class=pc3 title="line 143 char 11 count 20,543,810">(v-set! </span><span class=pc3 title="line 143 char 19 count 20,543,810">lo</span><span class=pc3 title="line 143 char 11 count 20,543,810"> </span><span class=pc3 title="line 143 char 22 count 20,543,810">(v-get </span><span class=pc3 title="line 143 char 29 count 20,543,810">hi</span><span class=pc3 title="line 143 char 22 count 20,543,810">)</span><span class=pc3 title="line 143 char 11 count 20,543,810">)</span>
          <span class=pc3 title="line 144 char 11 count 20,543,810">(v-set! </span><span class=pc3 title="line 144 char 19 count 20,543,810">hi</span><span class=pc3 title="line 144 char 11 count 20,543,810"> </span><span class=pc3 title="line 144 char 22 count 20,543,810">t</span><span class=pc3 title="line 144 char 11 count 20,543,810">)</span>
          <span class=pc3 title="line 145 char 11 count 20,543,810">(</span><span class=pc3 title="line 145 char 12 count 20,543,810">reverse-range</span><span class=pc3 title="line 145 char 11 count 20,543,810"> </span><span class=pc3 title="line 145 char 26 count 20,543,810">(</span><span class=pc3 title="line 145 char 27 count 20,543,810">fx+</span><span class=pc3 title="line 145 char 26 count 20,543,810"> </span><span class=pc3 title="line 145 char 31 count 20,543,810">lo</span><span class=pc3 title="line 145 char 26 count 20,543,810"> </span><span class=pc3 title="line 145 char 34 count 20,543,810">1</span><span class=pc3 title="line 145 char 26 count 20,543,810">)</span><span class=pc3 title="line 145 char 11 count 20,543,810"> </span><span class=pc3 title="line 145 char 37 count 20,543,810">(</span><span class=pc3 title="line 145 char 38 count 20,543,810">fx-</span><span class=pc3 title="line 145 char 37 count 20,543,810"> </span><span class=pc3 title="line 145 char 42 count 20,543,810">hi</span><span class=pc3 title="line 145 char 37 count 20,543,810"> </span><span class=pc3 title="line 145 char 45 count 20,543,810">1</span><span class=pc3 title="line 145 char 37 count 20,543,810">)</span><span class=pc3 title="line 145 char 11 count 20,543,810">)</span><span class=pc3 title="line 142 char 9 count 20,543,810">)</span><span class=pc3 title="line 141 char 5 count 21,044,468">)</span><span class=pc2 title="line 140 char 3 count 12">)</span>

  <span class=pc2 title="line 147 char 3 count 12">(define (count-run-and-make-ascending lo hi)</span>
    <span class=pc2 title="line 148 char 5 count 1,000,010">(do-assert (fx&lt; lo hi))</span>

    <span class=pc2 title="line 150 char 5 count 1,000,010">(let ([run-hi </span><span class=pc2 title="line 150 char 19 count 1,000,010">(</span><span class=pc2 title="line 150 char 20 count 1,000,010">fx+</span><span class=pc2 title="line 150 char 19 count 1,000,010"> </span><span class=pc2 title="line 150 char 24 count 1,000,010">lo</span><span class=pc2 title="line 150 char 19 count 1,000,010"> </span><span class=pc2 title="line 150 char 27 count 1,000,010">1</span><span class=pc2 title="line 150 char 19 count 1,000,010">)</span><span class=pc2 title="line 150 char 5 count 1,000,010">])</span>
      <span class=pc2 title="line 151 char 7 count 1,000,010">(cond</span>
        <span class=pc2 title="line 151 char 7 count 1,000,010">[</span><span class=pc2 title="line 152 char 10 count 1,000,010">(</span><span class=pc2 title="line 152 char 11 count 1,000,010">fx=</span><span class=pc2 title="line 152 char 10 count 1,000,010"> </span><span class=pc2 title="line 152 char 15 count 1,000,010">run-hi</span><span class=pc2 title="line 152 char 10 count 1,000,010"> </span><span class=pc2 title="line 152 char 22 count 1,000,010">hi</span><span class=pc2 title="line 152 char 10 count 1,000,010">)</span><span class=pc2 title="line 151 char 7 count 1,000,010"> </span><span class=pc1 title="line 152 char 26 count 0">1</span><span class=pc2 title="line 151 char 7 count 1,000,010">]</span>
        <span class=pc2 title="line 151 char 7 count 1,000,010">;; strict descending</span>
        <span class=pc2 title="line 151 char 7 count 1,000,010">[</span><span class=pc2 title="line 154 char 10 count 1,000,010">(</span><span class=pc2 title="line 154 char 11 count 1,000,010">lt?</span><span class=pc2 title="line 154 char 10 count 1,000,010"> </span><span class=pc2 title="line 154 char 15 count 1,000,010">(v-get </span><span class=pc2 title="line 154 char 22 count 1,000,010">run-hi</span><span class=pc2 title="line 154 char 15 count 1,000,010">)</span><span class=pc2 title="line 154 char 10 count 1,000,010"> </span><span class=pc2 title="line 154 char 30 count 1,000,010">(v-get </span><span class=pc2 title="line 154 char 37 count 1,000,010">lo</span><span class=pc2 title="line 154 char 30 count 1,000,010">)</span><span class=pc2 title="line 154 char 10 count 1,000,010">)</span>
         <span class=pc2 title="line 155 char 10 count 500,658">(let while ([run-hi </span><span class=pc2 title="line 155 char 30 count 500,658">(</span><span class=pc2 title="line 155 char 31 count 500,658">fx+</span><span class=pc2 title="line 155 char 30 count 500,658"> </span><span class=pc2 title="line 155 char 35 count 500,658">run-hi</span><span class=pc2 title="line 155 char 30 count 500,658"> </span><span class=pc2 title="line 155 char 42 count 500,658">1</span><span class=pc2 title="line 155 char 30 count 500,658">)</span><span class=pc2 title="line 155 char 10 count 500,658">])</span>
           <span class=pc3 title="line 156 char 12 count 40,719,714">(if </span><span class=pc3 title="line 156 char 16 count 40,719,714">(and </span><span class=pc3 title="line 156 char 21 count 40,719,714">(</span><span class=pc3 title="line 156 char 22 count 40,719,714">fx&lt;</span><span class=pc3 title="line 156 char 21 count 40,719,714"> </span><span class=pc3 title="line 156 char 26 count 40,719,714">run-hi</span><span class=pc3 title="line 156 char 21 count 40,719,714"> </span><span class=pc3 title="line 156 char 33 count 40,719,714">hi</span><span class=pc3 title="line 156 char 21 count 40,719,714">)</span>
                    <span class=pc3 title="line 157 char 21 count 40,719,710">(</span><span class=pc3 title="line 157 char 22 count 40,719,710">lt?</span><span class=pc3 title="line 157 char 21 count 40,719,710"> </span><span class=pc3 title="line 157 char 26 count 40,719,710">(v-get </span><span class=pc3 title="line 157 char 33 count 40,719,710">run-hi</span><span class=pc3 title="line 157 char 26 count 40,719,710">)</span>
                         <span class=pc3 title="line 158 char 26 count 40,719,710">(v-get </span><span class=pc3 title="line 158 char 33 count 40,719,710">(</span><span class=pc3 title="line 158 char 34 count 40,719,710">fx-</span><span class=pc3 title="line 158 char 33 count 40,719,710"> </span><span class=pc3 title="line 158 char 38 count 40,719,710">run-hi</span><span class=pc3 title="line 158 char 33 count 40,719,710"> </span><span class=pc3 title="line 158 char 45 count 40,719,710">1</span><span class=pc3 title="line 158 char 33 count 40,719,710">)</span><span class=pc3 title="line 158 char 26 count 40,719,710">)</span><span class=pc3 title="line 157 char 21 count 40,719,710">)</span><span class=pc3 title="line 156 char 16 count 40,719,714">)</span>
               <span class=pc3 title="line 159 char 16 count 40,219,056">(</span><span class=pc3 title="line 159 char 17 count 40,219,056">while</span><span class=pc3 title="line 159 char 16 count 40,219,056"> </span><span class=pc3 title="line 159 char 23 count 40,219,056">(</span><span class=pc3 title="line 159 char 24 count 40,219,056">fx+</span><span class=pc3 title="line 159 char 23 count 40,219,056"> </span><span class=pc3 title="line 159 char 28 count 40,219,056">run-hi</span><span class=pc3 title="line 159 char 23 count 40,219,056"> </span><span class=pc3 title="line 159 char 35 count 40,219,056">1</span><span class=pc3 title="line 159 char 23 count 40,219,056">)</span><span class=pc3 title="line 159 char 16 count 40,219,056">)</span>
               <span class=pc2 title="line 160 char 16 count 500,658">(begin</span>
                 <span class=pc2 title="line 161 char 18 count 500,658">(</span><span class=pc2 title="line 161 char 19 count 500,658">reverse-range</span><span class=pc2 title="line 161 char 18 count 500,658"> </span><span class=pc2 title="line 161 char 33 count 500,658">lo</span><span class=pc2 title="line 161 char 18 count 500,658"> </span><span class=pc2 title="line 161 char 36 count 500,658">(</span><span class=pc2 title="line 161 char 37 count 500,658">fx-</span><span class=pc2 title="line 161 char 36 count 500,658"> </span><span class=pc2 title="line 161 char 41 count 500,658">run-hi</span><span class=pc2 title="line 161 char 36 count 500,658"> </span><span class=pc2 title="line 161 char 48 count 500,658">1</span><span class=pc2 title="line 161 char 36 count 500,658">)</span><span class=pc2 title="line 161 char 18 count 500,658">)</span>
                 <span class=pc2 title="line 162 char 18 count 500,658">(</span><span class=pc2 title="line 162 char 19 count 500,658">fx-</span><span class=pc2 title="line 162 char 18 count 500,658"> </span><span class=pc2 title="line 162 char 23 count 500,658">run-hi</span><span class=pc2 title="line 162 char 18 count 500,658"> </span><span class=pc2 title="line 162 char 30 count 500,658">lo</span><span class=pc2 title="line 162 char 18 count 500,658">)</span><span class=pc2 title="line 160 char 16 count 500,658">)</span><span class=pc3 title="line 156 char 12 count 40,719,714">)</span><span class=pc2 title="line 155 char 10 count 500,658">)</span><span class=pc2 title="line 151 char 7 count 1,000,010">]</span>
        <span class=pc2 title="line 151 char 7 count 1,000,010">;; ascending</span>
        <span class=pc2 title="line 151 char 7 count 1,000,010">[else</span>
         <span class=pc2 title="line 165 char 10 count 499,352">(let while ([run-hi </span><span class=pc2 title="line 165 char 30 count 499,352">(</span><span class=pc2 title="line 165 char 31 count 499,352">fx+</span><span class=pc2 title="line 165 char 30 count 499,352"> </span><span class=pc2 title="line 165 char 35 count 499,352">run-hi</span><span class=pc2 title="line 165 char 30 count 499,352"> </span><span class=pc2 title="line 165 char 42 count 499,352">1</span><span class=pc2 title="line 165 char 30 count 499,352">)</span><span class=pc2 title="line 165 char 10 count 499,352">])</span>
           <span class=pc3 title="line 166 char 12 count 20,718,154">(if </span><span class=pc3 title="line 166 char 16 count 20,718,154">(and </span><span class=pc3 title="line 166 char 21 count 20,718,154">(</span><span class=pc3 title="line 166 char 22 count 20,718,154">fx&lt;</span><span class=pc3 title="line 166 char 21 count 20,718,154"> </span><span class=pc3 title="line 166 char 26 count 20,718,154">run-hi</span><span class=pc3 title="line 166 char 21 count 20,718,154"> </span><span class=pc3 title="line 166 char 33 count 20,718,154">hi</span><span class=pc3 title="line 166 char 21 count 20,718,154">)</span>
                    <span class=pc3 title="line 167 char 21 count 20,718,152">(</span><span class=pc3 title="line 167 char 22 count 20,718,152">not</span><span class=pc3 title="line 167 char 21 count 20,718,152"> </span><span class=pc3 title="line 167 char 26 count 20,718,152">(</span><span class=pc3 title="line 167 char 27 count 20,718,152">lt?</span><span class=pc3 title="line 167 char 26 count 20,718,152"> </span><span class=pc3 title="line 167 char 31 count 20,718,152">(v-get </span><span class=pc3 title="line 167 char 38 count 20,718,152">run-hi</span><span class=pc3 title="line 167 char 31 count 20,718,152">)</span>
                              <span class=pc3 title="line 168 char 31 count 20,718,152">(v-get </span><span class=pc3 title="line 168 char 38 count 20,718,152">(</span><span class=pc3 title="line 168 char 39 count 20,718,152">fx-</span><span class=pc3 title="line 168 char 38 count 20,718,152"> </span><span class=pc3 title="line 168 char 43 count 20,718,152">run-hi</span><span class=pc3 title="line 168 char 38 count 20,718,152"> </span><span class=pc3 title="line 168 char 50 count 20,718,152">1</span><span class=pc3 title="line 168 char 38 count 20,718,152">)</span><span class=pc3 title="line 168 char 31 count 20,718,152">)</span><span class=pc3 title="line 167 char 26 count 20,718,152">)</span><span class=pc3 title="line 167 char 21 count 20,718,152">)</span><span class=pc3 title="line 166 char 16 count 20,718,154">)</span>
               <span class=pc2 title="line 169 char 16 count 20,218,802">(</span><span class=pc2 title="line 169 char 17 count 20,218,802">while</span><span class=pc2 title="line 169 char 16 count 20,218,802"> </span><span class=pc2 title="line 169 char 23 count 20,218,802">(</span><span class=pc2 title="line 169 char 24 count 20,218,802">fx+</span><span class=pc2 title="line 169 char 23 count 20,218,802"> </span><span class=pc2 title="line 169 char 28 count 20,218,802">run-hi</span><span class=pc2 title="line 169 char 23 count 20,218,802"> </span><span class=pc2 title="line 169 char 35 count 20,218,802">1</span><span class=pc2 title="line 169 char 23 count 20,218,802">)</span><span class=pc2 title="line 169 char 16 count 20,218,802">)</span>
               <span class=pc2 title="line 170 char 16 count 499,352">(</span><span class=pc2 title="line 170 char 17 count 499,352">fx-</span><span class=pc2 title="line 170 char 16 count 499,352"> </span><span class=pc2 title="line 170 char 21 count 499,352">run-hi</span><span class=pc2 title="line 170 char 16 count 499,352"> </span><span class=pc2 title="line 170 char 28 count 499,352">lo</span><span class=pc2 title="line 170 char 16 count 499,352">)</span><span class=pc3 title="line 166 char 12 count 20,718,154">)</span><span class=pc2 title="line 165 char 10 count 499,352">)</span><span class=pc2 title="line 151 char 7 count 1,000,010">])</span><span class=pc2 title="line 150 char 5 count 1,000,010">)</span><span class=pc2 title="line 147 char 3 count 12">)</span>

  <span class=pc2 title="line 172 char 3 count 12">(define (compute-min-run-length n)</span>
    <span class=pc2 title="line 173 char 5 count 8">(do-assert (fx&gt;= n 0))</span>
    <span class=pc2 title="line 174 char 5 count 8">(let while ([r </span><span class=pc2 title="line 174 char 20 count 8">0</span><span class=pc2 title="line 174 char 5 count 8">][n </span><span class=pc2 title="line 174 char 25 count 8">n</span><span class=pc2 title="line 174 char 5 count 8">])</span>
      <span class=pc2 title="line 175 char 7 count 160">(if </span><span class=pc2 title="line 175 char 11 count 160">(</span><span class=pc2 title="line 175 char 12 count 160">fx&gt;=</span><span class=pc2 title="line 175 char 11 count 160"> </span><span class=pc2 title="line 175 char 17 count 160">n</span><span class=pc2 title="line 175 char 11 count 160"> </span><span class=pc2 title="line 175 char 19 count 160">MIN_MERGE</span><span class=pc2 title="line 175 char 11 count 160">)</span>
          <span class=pc2 title="line 176 char 11 count 152">(</span><span class=pc2 title="line 176 char 12 count 152">while</span><span class=pc2 title="line 176 char 11 count 152"> </span><span class=pc2 title="line 176 char 18 count 152">(</span><span class=pc2 title="line 176 char 19 count 152">fxlogor</span><span class=pc2 title="line 176 char 18 count 152"> </span><span class=pc2 title="line 176 char 27 count 152">r</span><span class=pc2 title="line 176 char 18 count 152"> </span><span class=pc2 title="line 176 char 29 count 152">(</span><span class=pc2 title="line 176 char 30 count 152">fxlogand</span><span class=pc2 title="line 176 char 29 count 152"> </span><span class=pc2 title="line 176 char 39 count 152">n</span><span class=pc2 title="line 176 char 29 count 152"> </span><span class=pc2 title="line 176 char 41 count 152">1</span><span class=pc2 title="line 176 char 29 count 152">)</span><span class=pc2 title="line 176 char 18 count 152">)</span><span class=pc2 title="line 176 char 11 count 152"> </span><span class=pc2 title="line 176 char 45 count 152">(</span><span class=pc2 title="line 176 char 46 count 152">fxsrl</span><span class=pc2 title="line 176 char 45 count 152"> </span><span class=pc2 title="line 176 char 52 count 152">n</span><span class=pc2 title="line 176 char 45 count 152"> </span><span class=pc2 title="line 176 char 54 count 152">1</span><span class=pc2 title="line 176 char 45 count 152">)</span><span class=pc2 title="line 176 char 11 count 152">)</span>
          <span class=pc2 title="line 177 char 11 count 8">(</span><span class=pc2 title="line 177 char 12 count 8">fx+</span><span class=pc2 title="line 177 char 11 count 8"> </span><span class=pc2 title="line 177 char 16 count 8">n</span><span class=pc2 title="line 177 char 11 count 8"> </span><span class=pc2 title="line 177 char 18 count 8">r</span><span class=pc2 title="line 177 char 11 count 8">)</span><span class=pc2 title="line 175 char 7 count 160">)</span><span class=pc2 title="line 174 char 5 count 8">)</span><span class=pc2 title="line 172 char 3 count 12">)</span>

  <span class=pc2 title="line 179 char 3 count 12">(define (merge-collapse)</span>
    <span class=pc2 title="line 180 char 5 count 1,999,992">(define (helper n)</span>
      <span class=pc2 title="line 181 char 7 count 1,999,948">(cond</span>
        <span class=pc2 title="line 181 char 7 count 1,999,948">[</span><span class=pc2 title="line 182 char 10 count 1,999,948">(and </span><span class=pc2 title="line 182 char 15 count 1,999,948">(</span><span class=pc2 title="line 182 char 16 count 1,999,948">fx&gt;</span><span class=pc2 title="line 182 char 15 count 1,999,948"> </span><span class=pc2 title="line 182 char 20 count 1,999,948">n</span><span class=pc2 title="line 182 char 15 count 1,999,948"> </span><span class=pc2 title="line 182 char 22 count 1,999,948">0</span><span class=pc2 title="line 182 char 15 count 1,999,948">)</span>
              <span class=pc2 title="line 183 char 15 count 1,999,570">(</span><span class=pc2 title="line 183 char 16 count 1,999,570">fx&lt;=</span><span class=pc2 title="line 183 char 15 count 1,999,570"> </span><span class=pc2 title="line 183 char 21 count 1,999,570">(rl-get </span><span class=pc2 title="line 183 char 29 count 1,999,570">(</span><span class=pc2 title="line 183 char 30 count 1,999,570">fx-</span><span class=pc2 title="line 183 char 29 count 1,999,570"> </span><span class=pc2 title="line 183 char 34 count 1,999,570">n</span><span class=pc2 title="line 183 char 29 count 1,999,570"> </span><span class=pc2 title="line 183 char 36 count 1,999,570">1</span><span class=pc2 title="line 183 char 29 count 1,999,570">)</span><span class=pc2 title="line 183 char 21 count 1,999,570">)</span>
                    <span class=pc2 title="line 184 char 21 count 1,999,570">(</span><span class=pc2 title="line 184 char 22 count 1,999,570">fx+</span><span class=pc2 title="line 184 char 21 count 1,999,570"> </span><span class=pc2 title="line 184 char 26 count 1,999,570">(rl-get </span><span class=pc2 title="line 184 char 34 count 1,999,570">n</span><span class=pc2 title="line 184 char 26 count 1,999,570">)</span>
                         <span class=pc2 title="line 185 char 26 count 1,999,570">(rl-get </span><span class=pc2 title="line 185 char 34 count 1,999,570">(</span><span class=pc2 title="line 185 char 35 count 1,999,570">fx+</span><span class=pc2 title="line 185 char 34 count 1,999,570"> </span><span class=pc2 title="line 185 char 39 count 1,999,570">n</span><span class=pc2 title="line 185 char 34 count 1,999,570"> </span><span class=pc2 title="line 185 char 41 count 1,999,570">1</span><span class=pc2 title="line 185 char 34 count 1,999,570">)</span><span class=pc2 title="line 185 char 26 count 1,999,570">)</span><span class=pc2 title="line 184 char 21 count 1,999,570">)</span><span class=pc2 title="line 183 char 15 count 1,999,570">)</span><span class=pc2 title="line 182 char 10 count 1,999,948">)</span>
         <span class=pc2 title="line 186 char 10 count 499,986">(if </span><span class=pc2 title="line 186 char 14 count 499,986">(</span><span class=pc2 title="line 186 char 15 count 499,986">fx&lt;</span><span class=pc2 title="line 186 char 14 count 499,986"> </span><span class=pc2 title="line 186 char 19 count 499,986">(rl-get </span><span class=pc2 title="line 186 char 27 count 499,986">(</span><span class=pc2 title="line 186 char 28 count 499,986">fx-</span><span class=pc2 title="line 186 char 27 count 499,986"> </span><span class=pc2 title="line 186 char 32 count 499,986">n</span><span class=pc2 title="line 186 char 27 count 499,986"> </span><span class=pc2 title="line 186 char 34 count 499,986">1</span><span class=pc2 title="line 186 char 27 count 499,986">)</span><span class=pc2 title="line 186 char 19 count 499,986">)</span>
                  <span class=pc2 title="line 187 char 19 count 499,986">(rl-get </span><span class=pc2 title="line 187 char 27 count 499,986">(</span><span class=pc2 title="line 187 char 28 count 499,986">fx+</span><span class=pc2 title="line 187 char 27 count 499,986"> </span><span class=pc2 title="line 187 char 32 count 499,986">n</span><span class=pc2 title="line 187 char 27 count 499,986"> </span><span class=pc2 title="line 187 char 34 count 499,986">1</span><span class=pc2 title="line 187 char 27 count 499,986">)</span><span class=pc2 title="line 187 char 19 count 499,986">)</span><span class=pc2 title="line 186 char 14 count 499,986">)</span>
             <span class=pc1 title="line 188 char 14 count 0">(</span><span class=pc1 title="line 188 char 15 count 0">fx-</span><span class=pc1 title="line 188 char 14 count 0"> </span><span class=pc1 title="line 188 char 19 count 0">n</span><span class=pc1 title="line 188 char 14 count 0"> </span><span class=pc1 title="line 188 char 21 count 0">1</span><span class=pc1 title="line 188 char 14 count 0">)</span>
             <span class=pc2 title="line 189 char 14 count 499,986">n</span><span class=pc2 title="line 186 char 10 count 499,986">)</span><span class=pc2 title="line 181 char 7 count 1,999,948">]</span>
        <span class=pc2 title="line 181 char 7 count 1,999,948">[</span><span class=pc2 title="line 190 char 10 count 1,499,962">(</span><span class=pc2 title="line 190 char 11 count 1,499,962">fx&lt;=</span><span class=pc2 title="line 190 char 10 count 1,499,962"> </span><span class=pc2 title="line 190 char 16 count 1,499,962">(rl-get </span><span class=pc2 title="line 190 char 24 count 1,499,962">n</span><span class=pc2 title="line 190 char 16 count 1,499,962">)</span><span class=pc2 title="line 190 char 10 count 1,499,962"> </span><span class=pc2 title="line 190 char 27 count 1,499,962">(rl-get </span><span class=pc2 title="line 190 char 35 count 1,499,962">(</span><span class=pc2 title="line 190 char 36 count 1,499,962">fx+</span><span class=pc2 title="line 190 char 35 count 1,499,962"> </span><span class=pc2 title="line 190 char 40 count 1,499,962">n</span><span class=pc2 title="line 190 char 35 count 1,499,962"> </span><span class=pc2 title="line 190 char 42 count 1,499,962">1</span><span class=pc2 title="line 190 char 35 count 1,499,962">)</span><span class=pc2 title="line 190 char 27 count 1,499,962">)</span><span class=pc2 title="line 190 char 10 count 1,499,962">)</span><span class=pc2 title="line 181 char 7 count 1,999,948"> </span><span class=pc2 title="line 190 char 47 count 500,000">n</span><span class=pc2 title="line 181 char 7 count 1,999,948">]</span>
        <span class=pc2 title="line 181 char 7 count 1,999,948">[else </span><span class=pc2 title="line 191 char 15 count 999,962">#f</span><span class=pc2 title="line 181 char 7 count 1,999,948">])</span><span class=pc2 title="line 180 char 5 count 1,999,992">)</span>
    <span class=pc2 title="line 192 char 5 count 1,999,992">(if </span><span class=pc2 title="line 192 char 9 count 1,999,992">(</span><span class=pc2 title="line 192 char 10 count 1,999,992">fx&gt;</span><span class=pc2 title="line 192 char 9 count 1,999,992"> </span><span class=pc2 title="line 192 char 14 count 1,999,992">stack-size</span><span class=pc2 title="line 192 char 9 count 1,999,992"> </span><span class=pc2 title="line 192 char 25 count 1,999,992">1</span><span class=pc2 title="line 192 char 9 count 1,999,992">)</span>
        <span class=pc2 title="line 193 char 9 count 1,999,948">(let ([n </span><span class=pc2 title="line 193 char 18 count 1,999,948">(</span><span class=pc2 title="line 193 char 19 count 1,999,948">helper</span><span class=pc2 title="line 193 char 18 count 1,999,948"> </span><span class=pc2 title="line 193 char 26 count 1,999,948">(</span><span class=pc2 title="line 193 char 27 count 1,999,948">fx-</span><span class=pc2 title="line 193 char 26 count 1,999,948"> </span><span class=pc2 title="line 193 char 31 count 1,999,948">stack-size</span><span class=pc2 title="line 193 char 26 count 1,999,948"> </span><span class=pc2 title="line 193 char 42 count 1,999,948">2</span><span class=pc2 title="line 193 char 26 count 1,999,948">)</span><span class=pc2 title="line 193 char 18 count 1,999,948">)</span><span class=pc2 title="line 193 char 9 count 1,999,948">])</span>
          <span class=pc2 title="line 194 char 11 count 1,999,948">(when </span><span class=pc2 title="line 194 char 17 count 1,999,948">(</span><span class=pc2 title="line 194 char 18 count 1,999,948">not</span><span class=pc2 title="line 194 char 17 count 1,999,948"> </span><span class=pc2 title="line 194 char 22 count 1,999,948">(</span><span class=pc2 title="line 194 char 23 count 1,999,948">eq?</span><span class=pc2 title="line 194 char 22 count 1,999,948"> </span><span class=pc2 title="line 194 char 27 count 1,999,948">n</span><span class=pc2 title="line 194 char 22 count 1,999,948"> </span><span class=pc2 title="line 194 char 29 count 1,999,948">#f</span><span class=pc2 title="line 194 char 22 count 1,999,948">)</span><span class=pc2 title="line 194 char 17 count 1,999,948">)</span>
                <span class=pc2 title="line 195 char 17 count 999,986">(</span><span class=pc2 title="line 195 char 18 count 999,986">merge-at</span><span class=pc2 title="line 195 char 17 count 999,986"> </span><span class=pc2 title="line 195 char 27 count 999,986">n</span><span class=pc2 title="line 195 char 17 count 999,986">)</span>
                <span class=pc2 title="line 196 char 17 count 999,986">(</span><span class=pc2 title="line 196 char 18 count 999,986">merge-collapse</span><span class=pc2 title="line 196 char 17 count 999,986">)</span><span class=pc2 title="line 194 char 11 count 1,999,948">)</span><span class=pc2 title="line 193 char 9 count 1,999,948">)</span><span class=pc2 title="line 192 char 5 count 1,999,992">)</span><span class=pc2 title="line 179 char 3 count 12">)</span>

  <span class=pc2 title="line 198 char 3 count 12">(define (merge-force-collapse)</span>
    <span class=pc2 title="line 199 char 5 count 20">(define (helper n)</span>
      <span class=pc2 title="line 200 char 7 count 12">(if </span><span class=pc2 title="line 200 char 11 count 12">(and </span><span class=pc2 title="line 200 char 16 count 12">(</span><span class=pc2 title="line 200 char 17 count 12">fx&gt;</span><span class=pc2 title="line 200 char 16 count 12"> </span><span class=pc2 title="line 200 char 21 count 12">n</span><span class=pc2 title="line 200 char 16 count 12"> </span><span class=pc2 title="line 200 char 23 count 12">0</span><span class=pc2 title="line 200 char 16 count 12">)</span>
               <span class=pc2 title="line 201 char 16 count 10">(</span><span class=pc2 title="line 201 char 17 count 10">fx&lt;</span><span class=pc2 title="line 201 char 16 count 10"> </span><span class=pc2 title="line 201 char 21 count 10">(rl-get </span><span class=pc2 title="line 201 char 29 count 10">(</span><span class=pc2 title="line 201 char 30 count 10">fx-</span><span class=pc2 title="line 201 char 29 count 10"> </span><span class=pc2 title="line 201 char 34 count 10">n</span><span class=pc2 title="line 201 char 29 count 10"> </span><span class=pc2 title="line 201 char 36 count 10">1</span><span class=pc2 title="line 201 char 29 count 10">)</span><span class=pc2 title="line 201 char 21 count 10">)</span>
                    <span class=pc2 title="line 202 char 21 count 10">(rl-get </span><span class=pc2 title="line 202 char 29 count 10">(</span><span class=pc2 title="line 202 char 30 count 10">fx+</span><span class=pc2 title="line 202 char 29 count 10"> </span><span class=pc2 title="line 202 char 34 count 10">n</span><span class=pc2 title="line 202 char 29 count 10"> </span><span class=pc2 title="line 202 char 36 count 10">1</span><span class=pc2 title="line 202 char 29 count 10">)</span><span class=pc2 title="line 202 char 21 count 10">)</span><span class=pc2 title="line 201 char 16 count 10">)</span><span class=pc2 title="line 200 char 11 count 12">)</span>
          <span class=pc1 title="line 203 char 11 count 0">(</span><span class=pc1 title="line 203 char 12 count 0">fx-</span><span class=pc1 title="line 203 char 11 count 0"> </span><span class=pc1 title="line 203 char 16 count 0">n</span><span class=pc1 title="line 203 char 11 count 0"> </span><span class=pc1 title="line 203 char 18 count 0">1</span><span class=pc1 title="line 203 char 11 count 0">)</span>
          <span class=pc2 title="line 204 char 11 count 12">n</span><span class=pc2 title="line 200 char 7 count 12">)</span><span class=pc2 title="line 199 char 5 count 20">)</span>
    <span class=pc2 title="line 205 char 5 count 20">(when </span><span class=pc2 title="line 205 char 11 count 20">(</span><span class=pc2 title="line 205 char 12 count 20">fx&gt;</span><span class=pc2 title="line 205 char 11 count 20"> </span><span class=pc2 title="line 205 char 16 count 20">stack-size</span><span class=pc2 title="line 205 char 11 count 20"> </span><span class=pc2 title="line 205 char 27 count 20">1</span><span class=pc2 title="line 205 char 11 count 20">)</span>
          <span class=pc2 title="line 206 char 11 count 12">(</span><span class=pc2 title="line 206 char 12 count 12">merge-at</span><span class=pc2 title="line 206 char 11 count 12"> </span><span class=pc2 title="line 206 char 21 count 12">(</span><span class=pc2 title="line 206 char 22 count 12">helper</span><span class=pc2 title="line 206 char 21 count 12"> </span><span class=pc2 title="line 206 char 29 count 12">(</span><span class=pc2 title="line 206 char 30 count 12">fx-</span><span class=pc2 title="line 206 char 29 count 12"> </span><span class=pc2 title="line 206 char 34 count 12">stack-size</span><span class=pc2 title="line 206 char 29 count 12"> </span><span class=pc2 title="line 206 char 45 count 12">2</span><span class=pc2 title="line 206 char 29 count 12">)</span><span class=pc2 title="line 206 char 21 count 12">)</span><span class=pc2 title="line 206 char 11 count 12">)</span>
          <span class=pc2 title="line 207 char 11 count 12">(</span><span class=pc2 title="line 207 char 12 count 12">merge-force-collapse</span><span class=pc2 title="line 207 char 11 count 12">)</span><span class=pc2 title="line 205 char 5 count 20">)</span><span class=pc2 title="line 198 char 3 count 12">)</span>

  <span class=pc2 title="line 25 char 1 count 1">(define-syntax compute-with-hint1</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ hint) (lambda (last-ofs ofs) (</span><span class=pc2 title="line 211 char 41 count 1,011,702">values</span><span class=pc2 title="line 25 char 1 count 1"> (</span><span class=pc2 title="line 211 char 49 count 1,011,702">fx+</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 211 char 53 count 1,011,702">last-ofs</span><span class=pc2 title="line 25 char 1 count 1"> hint) (</span><span class=pc2 title="line 211 char 69 count 1,011,702">fx+</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 211 char 73 count 1,011,702">ofs</span><span class=pc2 title="line 25 char 1 count 1"> hint)))]))</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax compute-with-hint2</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ hint) (lambda (last-ofs ofs) (</span><span class=pc2 title="line 214 char 41 count 1,010,620">values</span><span class=pc2 title="line 25 char 1 count 1"> (</span><span class=pc2 title="line 214 char 49 count 1,010,620">fx-</span><span class=pc2 title="line 25 char 1 count 1"> hint </span><span class=pc2 title="line 214 char 58 count 1,010,620">ofs</span><span class=pc2 title="line 25 char 1 count 1">) (</span><span class=pc2 title="line 214 char 64 count 1,010,620">fx-</span><span class=pc2 title="line 25 char 1 count 1"> hint </span><span class=pc2 title="line 214 char 73 count 1,010,620">last-ofs</span><span class=pc2 title="line 25 char 1 count 1">)))]))</span>
  <span class=pc2 title="line 25 char 1 count 1">(define-syntax gallop</span>
    <span class=pc2 title="line 25 char 1 count 1">(syntax-rules ()</span>
      <span class=pc2 title="line 25 char 1 count 1">[(_ max-ofs* lt?-with-ofs compute-with-hint last-while-loop)</span>
       <span class=pc2 title="line 25 char 1 count 1">(let ([max-ofs max-ofs*])</span>
         <span class=pc2 title="line 25 char 1 count 1">(let while ([last-ofs </span><span class=pc2 title="line 219 char 32 count 2,022,322">0</span><span class=pc2 title="line 25 char 1 count 1">][ofs </span><span class=pc2 title="line 219 char 39 count 2,022,322">1</span><span class=pc2 title="line 25 char 1 count 1">])</span>
           <span class=pc2 title="line 25 char 1 count 1">(cond</span>
             <span class=pc2 title="line 25 char 1 count 1">[(and </span><span class=pc2 title="line 221 char 20 count 2,669,332">(</span><span class=pc2 title="line 221 char 21 count 2,669,332">fx&lt;</span><span class=pc2 title="line 221 char 20 count 2,669,332"> </span><span class=pc2 title="line 221 char 25 count 2,669,332">ofs</span><span class=pc2 title="line 221 char 20 count 2,669,332"> </span><span class=pc2 title="line 221 char 29 count 2,669,332">max-ofs</span><span class=pc2 title="line 221 char 20 count 2,669,332">)</span><span class=pc2 title="line 25 char 1 count 1"> (lt?-with-ofs </span><span class=pc2 title="line 221 char 52 count 1,657,922">ofs</span><span class=pc2 title="line 25 char 1 count 1">))</span>
              <span class=pc2 title="line 222 char 15 count 647,010">(</span><span class=pc2 title="line 222 char 16 count 647,010">while</span><span class=pc2 title="line 222 char 15 count 647,010"> </span><span class=pc2 title="line 222 char 22 count 647,010">ofs</span><span class=pc2 title="line 222 char 15 count 647,010"> </span><span class=pc2 title="line 222 char 26 count 647,010">(let ([ofs </span><span class=pc2 title="line 222 char 37 count 647,010">(</span><span class=pc2 title="line 222 char 38 count 647,010">fx+</span><span class=pc2 title="line 222 char 37 count 647,010"> </span><span class=pc2 title="line 222 char 42 count 647,010">(</span><span class=pc2 title="line 222 char 43 count 647,010">fxsll</span><span class=pc2 title="line 222 char 42 count 647,010"> </span><span class=pc2 title="line 222 char 49 count 647,010">ofs</span><span class=pc2 title="line 222 char 42 count 647,010"> </span><span class=pc2 title="line 222 char 53 count 647,010">1</span><span class=pc2 title="line 222 char 42 count 647,010">)</span><span class=pc2 title="line 222 char 37 count 647,010"> </span><span class=pc2 title="line 222 char 56 count 647,010">1</span><span class=pc2 title="line 222 char 37 count 647,010">)</span><span class=pc2 title="line 222 char 26 count 647,010">])</span>
                           <span class=pc2 title="line 223 char 28 count 647,010">(if </span><span class=pc2 title="line 223 char 32 count 647,010">(</span><span class=pc2 title="line 223 char 33 count 647,010">fx&lt;=</span><span class=pc2 title="line 223 char 32 count 647,010"> </span><span class=pc2 title="line 223 char 38 count 647,010">ofs</span><span class=pc2 title="line 223 char 32 count 647,010"> </span><span class=pc2 title="line 223 char 42 count 647,010">0</span><span class=pc2 title="line 223 char 32 count 647,010">)</span>
                               <span class=pc1 title="line 224 char 32 count 0">max-ofs</span>
                               <span class=pc2 title="line 225 char 32 count 647,010">ofs</span><span class=pc2 title="line 223 char 28 count 647,010">)</span><span class=pc2 title="line 222 char 26 count 647,010">)</span><span class=pc2 title="line 222 char 15 count 647,010">)</span><span class=pc2 title="line 25 char 1 count 1">]</span>
             <span class=pc2 title="line 25 char 1 count 1">[else (let ([ofs </span><span class=pc2 title="line 226 char 31 count 2,022,322">(if </span><span class=pc2 title="line 226 char 35 count 2,022,322">(</span><span class=pc2 title="line 226 char 36 count 2,022,322">fx&gt;</span><span class=pc2 title="line 226 char 35 count 2,022,322"> </span><span class=pc2 title="line 226 char 40 count 2,022,322">ofs</span><span class=pc2 title="line 226 char 35 count 2,022,322"> </span><span class=pc2 title="line 226 char 44 count 2,022,322">max-ofs</span><span class=pc2 title="line 226 char 35 count 2,022,322">)</span><span class=pc2 title="line 226 char 31 count 2,022,322"> </span><span class=pc2 title="line 226 char 53 count 2">max-ofs</span><span class=pc2 title="line 226 char 31 count 2,022,322"> </span><span class=pc2 title="line 226 char 61 count 2,022,320">ofs</span><span class=pc2 title="line 226 char 31 count 2,022,322">)</span><span class=pc2 title="line 25 char 1 count 1">])</span>
                     <span class=pc2 title="line 25 char 1 count 1">(</span><span class=pc2 title="line 227 char 23 count 2,022,322">call-with-values</span>
                       <span class=pc2 title="line 25 char 1 count 1">(lambda () (compute-with-hint </span><span class=pc2 title="line 228 char 54 count 2,022,322">last-ofs</span><span class=pc2 title="line 25 char 1 count 1"> </span><span class=pc2 title="line 228 char 63 count 2,022,322">ofs</span><span class=pc2 title="line 25 char 1 count 1">))</span>
                       <span class=pc2 title="line 25 char 1 count 1">last-while-loop))])))]))</span>

  <span class=pc2 title="line 231 char 3 count 12">(define (gallop-left key a base len hint)</span>
    <span class=pc2 title="line 231 char 3 count 12">(define-syntax get</span>
      <span class=pc2 title="line 231 char 3 count 12">(syntax-rules ()</span>
        <span class=pc2 title="line 231 char 3 count 12">[(_ i) (</span><span class=pc2 title="line 234 char 17 count 2,117,490">vector-ref</span><span class=pc2 title="line 231 char 3 count 12"> </span><span class=pc2 title="line 234 char 28 count 2,117,490">a</span><span class=pc2 title="line 231 char 3 count 12"> i)]))</span>

    <span class=pc2 title="line 236 char 5 count 1,011,160">(define (last-while last-ofs ofs)</span>
      <span class=pc2 title="line 237 char 7 count 1,011,160">(do-assert (and (fx&lt;= -1 last-ofs) (fx&lt; last-ofs ofs) (fx&lt;= ofs len)))</span>
      <span class=pc2 title="line 238 char 7 count 1,011,160">(let while ([last-ofs </span><span class=pc2 title="line 238 char 29 count 1,011,160">(</span><span class=pc2 title="line 238 char 30 count 1,011,160">fx+</span><span class=pc2 title="line 238 char 29 count 1,011,160"> </span><span class=pc2 title="line 238 char 34 count 1,011,160">last-ofs</span><span class=pc2 title="line 238 char 29 count 1,011,160"> </span><span class=pc2 title="line 238 char 43 count 1,011,160">1</span><span class=pc2 title="line 238 char 29 count 1,011,160">)</span><span class=pc2 title="line 238 char 7 count 1,011,160">] [ofs </span><span class=pc2 title="line 238 char 52 count 1,011,160">ofs</span><span class=pc2 title="line 238 char 7 count 1,011,160">])</span>
        <span class=pc2 title="line 239 char 9 count 1,314,296">(cond</span>
          <span class=pc2 title="line 239 char 9 count 1,314,296">[</span><span class=pc2 title="line 240 char 12 count 1,314,296">(</span><span class=pc2 title="line 240 char 13 count 1,314,296">fx&lt;</span><span class=pc2 title="line 240 char 12 count 1,314,296"> </span><span class=pc2 title="line 240 char 17 count 1,314,296">last-ofs</span><span class=pc2 title="line 240 char 12 count 1,314,296"> </span><span class=pc2 title="line 240 char 26 count 1,314,296">ofs</span><span class=pc2 title="line 240 char 12 count 1,314,296">)</span>
           <span class=pc2 title="line 241 char 12 count 303,136">(let ([m </span><span class=pc2 title="line 241 char 21 count 303,136">(</span><span class=pc2 title="line 241 char 22 count 303,136">fx+</span><span class=pc2 title="line 241 char 21 count 303,136"> </span><span class=pc2 title="line 241 char 26 count 303,136">last-ofs</span><span class=pc2 title="line 241 char 21 count 303,136"> </span><span class=pc2 title="line 241 char 35 count 303,136">(</span><span class=pc2 title="line 241 char 36 count 303,136">fxsrl</span><span class=pc2 title="line 241 char 35 count 303,136"> </span><span class=pc2 title="line 241 char 42 count 303,136">(</span><span class=pc2 title="line 241 char 43 count 303,136">fx-</span><span class=pc2 title="line 241 char 42 count 303,136"> </span><span class=pc2 title="line 241 char 47 count 303,136">ofs</span><span class=pc2 title="line 241 char 42 count 303,136"> </span><span class=pc2 title="line 241 char 51 count 303,136">last-ofs</span><span class=pc2 title="line 241 char 42 count 303,136">)</span><span class=pc2 title="line 241 char 35 count 303,136"> </span><span class=pc2 title="line 241 char 61 count 303,136">1</span><span class=pc2 title="line 241 char 35 count 303,136">)</span><span class=pc2 title="line 241 char 21 count 303,136">)</span><span class=pc2 title="line 241 char 12 count 303,136">])</span>
             <span class=pc2 title="line 242 char 14 count 303,136">(if </span><span class=pc2 title="line 242 char 18 count 303,136">(</span><span class=pc2 title="line 242 char 19 count 303,136">lt?</span><span class=pc2 title="line 242 char 18 count 303,136"> </span><span class=pc2 title="line 242 char 23 count 303,136">(get </span><span class=pc2 title="line 242 char 28 count 303,136">(</span><span class=pc2 title="line 242 char 29 count 303,136">fx+</span><span class=pc2 title="line 242 char 28 count 303,136"> </span><span class=pc2 title="line 242 char 33 count 303,136">base</span><span class=pc2 title="line 242 char 28 count 303,136"> </span><span class=pc2 title="line 242 char 38 count 303,136">m</span><span class=pc2 title="line 242 char 28 count 303,136">)</span><span class=pc2 title="line 242 char 23 count 303,136">)</span><span class=pc2 title="line 242 char 18 count 303,136"> </span><span class=pc2 title="line 242 char 42 count 303,136">key</span><span class=pc2 title="line 242 char 18 count 303,136">)</span>
                 <span class=pc2 title="line 243 char 18 count 212,720">(</span><span class=pc2 title="line 243 char 19 count 212,720">while</span><span class=pc2 title="line 243 char 18 count 212,720"> </span><span class=pc2 title="line 243 char 25 count 212,720">(</span><span class=pc2 title="line 243 char 26 count 212,720">fx+</span><span class=pc2 title="line 243 char 25 count 212,720"> </span><span class=pc2 title="line 243 char 30 count 212,720">m</span><span class=pc2 title="line 243 char 25 count 212,720"> </span><span class=pc2 title="line 243 char 32 count 212,720">1</span><span class=pc2 title="line 243 char 25 count 212,720">)</span><span class=pc2 title="line 243 char 18 count 212,720"> </span><span class=pc2 title="line 243 char 35 count 212,720">ofs</span><span class=pc2 title="line 243 char 18 count 212,720">)</span>
                 <span class=pc2 title="line 244 char 18 count 90,416">(</span><span class=pc2 title="line 244 char 19 count 90,416">while</span><span class=pc2 title="line 244 char 18 count 90,416"> </span><span class=pc2 title="line 244 char 25 count 90,416">last-ofs</span><span class=pc2 title="line 244 char 18 count 90,416"> </span><span class=pc2 title="line 244 char 34 count 90,416">m</span><span class=pc2 title="line 244 char 18 count 90,416">)</span><span class=pc2 title="line 242 char 14 count 303,136">)</span><span class=pc2 title="line 241 char 12 count 303,136">)</span><span class=pc2 title="line 239 char 9 count 1,314,296">]</span>
          <span class=pc2 title="line 239 char 9 count 1,314,296">[else </span><span class=pc2 title="line 245 char 17 count 1,011,160">(do-assert (fx= last-ofs ofs))</span><span class=pc2 title="line 239 char 9 count 1,314,296"> </span><span class=pc2 title="line 245 char 48 count 1,011,160">ofs</span><span class=pc2 title="line 239 char 9 count 1,314,296">])</span><span class=pc2 title="line 238 char 7 count 1,011,160">)</span><span class=pc2 title="line 236 char 5 count 1,011,160">)</span>
    <span class=pc2 title="line 246 char 5 count 1,011,160">(do-assert (and (fx&gt; len 0) (fx&gt;= hint 0) (fx&lt; hint len)))</span>

    <span class=pc2 title="line 248 char 5 count 1,011,160">(if </span><span class=pc2 title="line 248 char 9 count 1,011,160">(</span><span class=pc2 title="line 248 char 10 count 1,011,160">lt?</span><span class=pc2 title="line 248 char 9 count 1,011,160"> </span><span class=pc2 title="line 248 char 14 count 1,011,160">(get </span><span class=pc2 title="line 248 char 19 count 1,011,160">(</span><span class=pc2 title="line 248 char 20 count 1,011,160">fx+</span><span class=pc2 title="line 248 char 19 count 1,011,160"> </span><span class=pc2 title="line 248 char 24 count 1,011,160">base</span><span class=pc2 title="line 248 char 19 count 1,011,160"> </span><span class=pc2 title="line 248 char 29 count 1,011,160">hint</span><span class=pc2 title="line 248 char 19 count 1,011,160">)</span><span class=pc2 title="line 248 char 14 count 1,011,160">)</span><span class=pc2 title="line 248 char 9 count 1,011,160"> </span><span class=pc2 title="line 248 char 36 count 1,011,160">key</span><span class=pc2 title="line 248 char 9 count 1,011,160">)</span>
        <span class=pc2 title="line 249 char 9 count 511,100">(gallop </span><span class=pc2 title="line 249 char 17 count 511,100">(</span><span class=pc2 title="line 249 char 18 count 511,100">fx-</span><span class=pc2 title="line 249 char 17 count 511,100"> </span><span class=pc2 title="line 249 char 22 count 511,100">len</span><span class=pc2 title="line 249 char 17 count 511,100"> </span><span class=pc2 title="line 249 char 26 count 511,100">hint</span><span class=pc2 title="line 249 char 17 count 511,100">)</span>
                <span class=pc2 title="line 250 char 17 count 16">(lambda (ofs) </span><span class=pc2 title="line 250 char 31 count 16">(</span><span class=pc2 title="line 250 char 32 count 16">lt?</span><span class=pc2 title="line 250 char 31 count 16"> </span><span class=pc2 title="line 250 char 36 count 16">(get </span><span class=pc2 title="line 250 char 41 count 16">(</span><span class=pc2 title="line 250 char 42 count 16">fx+</span><span class=pc2 title="line 250 char 41 count 16"> </span><span class=pc2 title="line 250 char 46 count 16">base</span><span class=pc2 title="line 250 char 41 count 16"> </span><span class=pc2 title="line 250 char 51 count 16">hint</span><span class=pc2 title="line 250 char 41 count 16"> </span><span class=pc2 title="line 250 char 56 count 16">ofs</span><span class=pc2 title="line 250 char 41 count 16">)</span><span class=pc2 title="line 250 char 36 count 16">)</span><span class=pc2 title="line 250 char 31 count 16"> </span><span class=pc2 title="line 250 char 62 count 16">key</span><span class=pc2 title="line 250 char 31 count 16">)</span><span class=pc2 title="line 250 char 17 count 16">)</span>
                <span class=pc2 title="line 251 char 17 count 511,100">(compute-with-hint1 </span><span class=pc2 title="line 251 char 37 count 1,022,200">hint</span><span class=pc2 title="line 251 char 17 count 511,100">)</span>
                <span class=pc2 title="line 252 char 17 count 511,100">last-while</span><span class=pc2 title="line 249 char 9 count 511,100">)</span>
        <span class=pc2 title="line 253 char 9 count 500,060">(gallop </span><span class=pc2 title="line 253 char 17 count 500,060">(</span><span class=pc2 title="line 253 char 18 count 500,060">fx+</span><span class=pc2 title="line 253 char 17 count 500,060"> </span><span class=pc2 title="line 253 char 22 count 500,060">hint</span><span class=pc2 title="line 253 char 17 count 500,060"> </span><span class=pc2 title="line 253 char 27 count 500,060">1</span><span class=pc2 title="line 253 char 17 count 500,060">)</span>
                <span class=pc2 title="line 254 char 17 count 803,178">(lambda (ofs) </span><span class=pc2 title="line 254 char 31 count 803,178">(</span><span class=pc2 title="line 254 char 32 count 803,178">not</span><span class=pc2 title="line 254 char 31 count 803,178"> </span><span class=pc2 title="line 254 char 36 count 803,178">(</span><span class=pc2 title="line 254 char 37 count 803,178">lt?</span><span class=pc2 title="line 254 char 36 count 803,178"> </span><span class=pc2 title="line 254 char 41 count 803,178">(get </span><span class=pc2 title="line 254 char 46 count 803,178">(</span><span class=pc2 title="line 254 char 47 count 803,178">fx-</span><span class=pc2 title="line 254 char 46 count 803,178"> </span><span class=pc2 title="line 254 char 51 count 803,178">(</span><span class=pc2 title="line 254 char 52 count 803,178">fx+</span><span class=pc2 title="line 254 char 51 count 803,178"> </span><span class=pc2 title="line 254 char 56 count 803,178">base</span><span class=pc2 title="line 254 char 51 count 803,178"> </span><span class=pc2 title="line 254 char 61 count 803,178">hint</span><span class=pc2 title="line 254 char 51 count 803,178">)</span><span class=pc2 title="line 254 char 46 count 803,178"> </span><span class=pc2 title="line 254 char 67 count 803,178">ofs</span><span class=pc2 title="line 254 char 46 count 803,178">)</span><span class=pc2 title="line 254 char 41 count 803,178">)</span><span class=pc2 title="line 254 char 36 count 803,178"> </span><span class=pc2 title="line 254 char 73 count 803,178">key</span><span class=pc2 title="line 254 char 36 count 803,178">)</span><span class=pc2 title="line 254 char 31 count 803,178">)</span><span class=pc2 title="line 254 char 17 count 803,178">)</span>
                <span class=pc2 title="line 255 char 17 count 500,060">(compute-with-hint2 </span><span class=pc2 title="line 255 char 37 count 1,000,120">hint</span><span class=pc2 title="line 255 char 17 count 500,060">)</span>
                <span class=pc2 title="line 256 char 17 count 500,060">last-while</span><span class=pc2 title="line 253 char 9 count 500,060">)</span><span class=pc2 title="line 248 char 5 count 1,011,160">)</span><span class=pc2 title="line 231 char 3 count 12">)</span>

  <span class=pc2 title="line 258 char 3 count 12">(define (gallop-right key a base len hint)</span>
    <span class=pc2 title="line 258 char 3 count 12">(define-syntax get</span>
      <span class=pc2 title="line 258 char 3 count 12">(syntax-rules ()</span>
        <span class=pc2 title="line 258 char 3 count 12">[(_ i) (</span><span class=pc2 title="line 261 char 17 count 2,209,764">vector-ref</span><span class=pc2 title="line 258 char 3 count 12"> </span><span class=pc2 title="line 261 char 28 count 2,209,764">a</span><span class=pc2 title="line 258 char 3 count 12"> i)]))</span>

    <span class=pc2 title="line 263 char 5 count 1,011,162">(define (last-while last-ofs ofs)</span>
      <span class=pc2 title="line 264 char 7 count 1,011,162">(do-assert (and (fx&lt;= -1 last-ofs) (fx&lt; last-ofs ofs) (fx&lt;= ofs len)))</span>
      <span class=pc2 title="line 265 char 7 count 1,011,162">(let while ([last-ofs </span><span class=pc2 title="line 265 char 29 count 1,011,162">(</span><span class=pc2 title="line 265 char 30 count 1,011,162">fx+</span><span class=pc2 title="line 265 char 29 count 1,011,162"> </span><span class=pc2 title="line 265 char 34 count 1,011,162">last-ofs</span><span class=pc2 title="line 265 char 29 count 1,011,162"> </span><span class=pc2 title="line 265 char 43 count 1,011,162">1</span><span class=pc2 title="line 265 char 29 count 1,011,162">)</span><span class=pc2 title="line 265 char 7 count 1,011,162">] [ofs </span><span class=pc2 title="line 265 char 52 count 1,011,162">ofs</span><span class=pc2 title="line 265 char 7 count 1,011,162">])</span>
        <span class=pc2 title="line 266 char 9 count 1,355,036">(cond</span>
          <span class=pc2 title="line 266 char 9 count 1,355,036">[</span><span class=pc2 title="line 267 char 12 count 1,355,036">(</span><span class=pc2 title="line 267 char 13 count 1,355,036">fx&lt;</span><span class=pc2 title="line 267 char 12 count 1,355,036"> </span><span class=pc2 title="line 267 char 17 count 1,355,036">last-ofs</span><span class=pc2 title="line 267 char 12 count 1,355,036"> </span><span class=pc2 title="line 267 char 26 count 1,355,036">ofs</span><span class=pc2 title="line 267 char 12 count 1,355,036">)</span>
           <span class=pc2 title="line 268 char 12 count 343,874">(let ([m </span><span class=pc2 title="line 268 char 21 count 343,874">(</span><span class=pc2 title="line 268 char 22 count 343,874">fx+</span><span class=pc2 title="line 268 char 21 count 343,874"> </span><span class=pc2 title="line 268 char 26 count 343,874">last-ofs</span><span class=pc2 title="line 268 char 21 count 343,874"> </span><span class=pc2 title="line 268 char 35 count 343,874">(</span><span class=pc2 title="line 268 char 36 count 343,874">fxsrl</span><span class=pc2 title="line 268 char 35 count 343,874"> </span><span class=pc2 title="line 268 char 42 count 343,874">(</span><span class=pc2 title="line 268 char 43 count 343,874">fx-</span><span class=pc2 title="line 268 char 42 count 343,874"> </span><span class=pc2 title="line 268 char 47 count 343,874">ofs</span><span class=pc2 title="line 268 char 42 count 343,874"> </span><span class=pc2 title="line 268 char 51 count 343,874">last-ofs</span><span class=pc2 title="line 268 char 42 count 343,874">)</span><span class=pc2 title="line 268 char 35 count 343,874"> </span><span class=pc2 title="line 268 char 61 count 343,874">1</span><span class=pc2 title="line 268 char 35 count 343,874">)</span><span class=pc2 title="line 268 char 21 count 343,874">)</span><span class=pc2 title="line 268 char 12 count 343,874">])</span>
             <span class=pc2 title="line 269 char 14 count 343,874">(if </span><span class=pc2 title="line 269 char 18 count 343,874">(</span><span class=pc2 title="line 269 char 19 count 343,874">lt?</span><span class=pc2 title="line 269 char 18 count 343,874"> </span><span class=pc2 title="line 269 char 23 count 343,874">key</span><span class=pc2 title="line 269 char 18 count 343,874"> </span><span class=pc2 title="line 269 char 27 count 343,874">(get </span><span class=pc2 title="line 269 char 32 count 343,874">(</span><span class=pc2 title="line 269 char 33 count 343,874">fx+</span><span class=pc2 title="line 269 char 32 count 343,874"> </span><span class=pc2 title="line 269 char 37 count 343,874">base</span><span class=pc2 title="line 269 char 32 count 343,874"> </span><span class=pc2 title="line 269 char 42 count 343,874">m</span><span class=pc2 title="line 269 char 32 count 343,874">)</span><span class=pc2 title="line 269 char 27 count 343,874">)</span><span class=pc2 title="line 269 char 18 count 343,874">)</span>
                 <span class=pc2 title="line 270 char 18 count 231,732">(</span><span class=pc2 title="line 270 char 19 count 231,732">while</span><span class=pc2 title="line 270 char 18 count 231,732"> </span><span class=pc2 title="line 270 char 25 count 231,732">last-ofs</span><span class=pc2 title="line 270 char 18 count 231,732"> </span><span class=pc2 title="line 270 char 34 count 231,732">m</span><span class=pc2 title="line 270 char 18 count 231,732">)</span>
                 <span class=pc2 title="line 271 char 18 count 112,142">(</span><span class=pc2 title="line 271 char 19 count 112,142">while</span><span class=pc2 title="line 271 char 18 count 112,142"> </span><span class=pc2 title="line 271 char 25 count 112,142">(</span><span class=pc2 title="line 271 char 26 count 112,142">fx+</span><span class=pc2 title="line 271 char 25 count 112,142"> </span><span class=pc2 title="line 271 char 30 count 112,142">m</span><span class=pc2 title="line 271 char 25 count 112,142"> </span><span class=pc2 title="line 271 char 32 count 112,142">1</span><span class=pc2 title="line 271 char 25 count 112,142">)</span><span class=pc2 title="line 271 char 18 count 112,142"> </span><span class=pc2 title="line 271 char 35 count 112,142">ofs</span><span class=pc2 title="line 271 char 18 count 112,142">)</span><span class=pc2 title="line 269 char 14 count 343,874">)</span><span class=pc2 title="line 268 char 12 count 343,874">)</span><span class=pc2 title="line 266 char 9 count 1,355,036">]</span>
          <span class=pc2 title="line 266 char 9 count 1,355,036">[else </span><span class=pc2 title="line 272 char 17 count 1,011,162">(do-assert (fx= last-ofs ofs))</span><span class=pc2 title="line 266 char 9 count 1,355,036"> </span><span class=pc2 title="line 272 char 48 count 1,011,162">ofs</span><span class=pc2 title="line 266 char 9 count 1,355,036">])</span><span class=pc2 title="line 265 char 7 count 1,011,162">)</span><span class=pc2 title="line 263 char 5 count 1,011,162">)</span>
    <span class=pc2 title="line 273 char 5 count 1,011,162">(do-assert (and (fx&gt; len 0) (fx&gt;= hint 0) (fx&lt; hint len)))</span>

    <span class=pc2 title="line 275 char 5 count 1,011,162">(if </span><span class=pc2 title="line 275 char 9 count 1,011,162">(</span><span class=pc2 title="line 275 char 10 count 1,011,162">lt?</span><span class=pc2 title="line 275 char 9 count 1,011,162"> </span><span class=pc2 title="line 275 char 14 count 1,011,162">key</span><span class=pc2 title="line 275 char 9 count 1,011,162"> </span><span class=pc2 title="line 275 char 18 count 1,011,162">(get </span><span class=pc2 title="line 275 char 23 count 1,011,162">(</span><span class=pc2 title="line 275 char 24 count 1,011,162">fx+</span><span class=pc2 title="line 275 char 23 count 1,011,162"> </span><span class=pc2 title="line 275 char 28 count 1,011,162">base</span><span class=pc2 title="line 275 char 23 count 1,011,162"> </span><span class=pc2 title="line 275 char 33 count 1,011,162">hint</span><span class=pc2 title="line 275 char 23 count 1,011,162">)</span><span class=pc2 title="line 275 char 18 count 1,011,162">)</span><span class=pc2 title="line 275 char 9 count 1,011,162">)</span>
        <span class=pc2 title="line 276 char 9 count 510,560">(gallop </span><span class=pc2 title="line 276 char 17 count 510,560">(</span><span class=pc2 title="line 276 char 18 count 510,560">fx+</span><span class=pc2 title="line 276 char 17 count 510,560"> </span><span class=pc2 title="line 276 char 22 count 510,560">hint</span><span class=pc2 title="line 276 char 17 count 510,560"> </span><span class=pc2 title="line 276 char 27 count 510,560">1</span><span class=pc2 title="line 276 char 17 count 510,560">)</span>
                <span class=pc2 title="line 277 char 17 count 50,344">(lambda (ofs) </span><span class=pc2 title="line 277 char 31 count 50,344">(</span><span class=pc2 title="line 277 char 32 count 50,344">lt?</span><span class=pc2 title="line 277 char 31 count 50,344"> </span><span class=pc2 title="line 277 char 36 count 50,344">key</span><span class=pc2 title="line 277 char 31 count 50,344"> </span><span class=pc2 title="line 277 char 40 count 50,344">(get </span><span class=pc2 title="line 277 char 45 count 50,344">(</span><span class=pc2 title="line 277 char 46 count 50,344">fx-</span><span class=pc2 title="line 277 char 45 count 50,344"> </span><span class=pc2 title="line 277 char 50 count 50,344">(</span><span class=pc2 title="line 277 char 51 count 50,344">fx+</span><span class=pc2 title="line 277 char 50 count 50,344"> </span><span class=pc2 title="line 277 char 55 count 50,344">base</span><span class=pc2 title="line 277 char 50 count 50,344"> </span><span class=pc2 title="line 277 char 60 count 50,344">hint</span><span class=pc2 title="line 277 char 50 count 50,344">)</span><span class=pc2 title="line 277 char 45 count 50,344"> </span><span class=pc2 title="line 277 char 66 count 50,344">ofs</span><span class=pc2 title="line 277 char 45 count 50,344">)</span><span class=pc2 title="line 277 char 40 count 50,344">)</span><span class=pc2 title="line 277 char 31 count 50,344">)</span><span class=pc2 title="line 277 char 17 count 50,344">)</span>
                <span class=pc2 title="line 278 char 17 count 510,560">(compute-with-hint2 </span><span class=pc2 title="line 278 char 37 count 1,021,120">hint</span><span class=pc2 title="line 278 char 17 count 510,560">)</span>
                <span class=pc2 title="line 279 char 17 count 510,560">last-while</span><span class=pc2 title="line 276 char 9 count 510,560">)</span>
        <span class=pc2 title="line 280 char 9 count 500,602">(gallop </span><span class=pc2 title="line 280 char 17 count 500,602">(</span><span class=pc2 title="line 280 char 18 count 500,602">fx-</span><span class=pc2 title="line 280 char 17 count 500,602"> </span><span class=pc2 title="line 280 char 22 count 500,602">len</span><span class=pc2 title="line 280 char 17 count 500,602"> </span><span class=pc2 title="line 280 char 26 count 500,602">hint</span><span class=pc2 title="line 280 char 17 count 500,602">)</span>
                <span class=pc2 title="line 281 char 17 count 804,384">(lambda (ofs) </span><span class=pc2 title="line 281 char 31 count 804,384">(</span><span class=pc2 title="line 281 char 32 count 804,384">not</span><span class=pc2 title="line 281 char 31 count 804,384"> </span><span class=pc2 title="line 281 char 36 count 804,384">(</span><span class=pc2 title="line 281 char 37 count 804,384">lt?</span><span class=pc2 title="line 281 char 36 count 804,384"> </span><span class=pc2 title="line 281 char 41 count 804,384">key</span><span class=pc2 title="line 281 char 36 count 804,384"> </span><span class=pc2 title="line 281 char 45 count 804,384">(get </span><span class=pc2 title="line 281 char 50 count 804,384">(</span><span class=pc2 title="line 281 char 51 count 804,384">fx+</span><span class=pc2 title="line 281 char 50 count 804,384"> </span><span class=pc2 title="line 281 char 55 count 804,384">base</span><span class=pc2 title="line 281 char 50 count 804,384"> </span><span class=pc2 title="line 281 char 60 count 804,384">hint</span><span class=pc2 title="line 281 char 50 count 804,384"> </span><span class=pc2 title="line 281 char 65 count 804,384">ofs</span><span class=pc2 title="line 281 char 50 count 804,384">)</span><span class=pc2 title="line 281 char 45 count 804,384">)</span><span class=pc2 title="line 281 char 36 count 804,384">)</span><span class=pc2 title="line 281 char 31 count 804,384">)</span><span class=pc2 title="line 281 char 17 count 804,384">)</span>
                <span class=pc2 title="line 282 char 17 count 500,602">(compute-with-hint1 </span><span class=pc2 title="line 282 char 37 count 1,001,204">hint</span><span class=pc2 title="line 282 char 17 count 500,602">)</span>
                <span class=pc2 title="line 283 char 17 count 500,602">last-while</span><span class=pc2 title="line 280 char 9 count 500,602">)</span><span class=pc2 title="line 275 char 5 count 1,011,162">)</span><span class=pc2 title="line 258 char 3 count 12">)</span>

  <span class=pc2 title="line 285 char 3 count 12">(define (merge-at i)</span>
    <span class=pc2 title="line 286 char 5 count 999,998">(do-assert (fx&gt;= stack-size 2))</span>
    <span class=pc2 title="line 287 char 5 count 999,998">(do-assert (fx&gt;= i 0))</span>
    <span class=pc2 title="line 288 char 5 count 999,998">(do-assert (or (fx= i (fx- stack-size 2))</span>
                   <span class=pc2 title="line 288 char 5 count 999,998">(fx= i (fx- stack-size 3))))</span>

    <span class=pc2 title="line 291 char 5 count 999,998">(let ([base1 </span><span class=pc2 title="line 291 char 18 count 999,998">(rb-get </span><span class=pc2 title="line 291 char 26 count 999,998">i</span><span class=pc2 title="line 291 char 18 count 999,998">)</span><span class=pc2 title="line 291 char 5 count 999,998">][len1 </span><span class=pc2 title="line 291 char 35 count 999,998">(rl-get </span><span class=pc2 title="line 291 char 43 count 999,998">i</span><span class=pc2 title="line 291 char 35 count 999,998">)</span><span class=pc2 title="line 291 char 5 count 999,998">]</span>
          <span class=pc2 title="line 291 char 5 count 999,998">[base2 </span><span class=pc2 title="line 292 char 18 count 999,998">(rb-get </span><span class=pc2 title="line 292 char 26 count 999,998">(</span><span class=pc2 title="line 292 char 27 count 999,998">fx+</span><span class=pc2 title="line 292 char 26 count 999,998"> </span><span class=pc2 title="line 292 char 31 count 999,998">i</span><span class=pc2 title="line 292 char 26 count 999,998"> </span><span class=pc2 title="line 292 char 33 count 999,998">1</span><span class=pc2 title="line 292 char 26 count 999,998">)</span><span class=pc2 title="line 292 char 18 count 999,998">)</span><span class=pc2 title="line 291 char 5 count 999,998">][len2 </span><span class=pc2 title="line 292 char 43 count 999,998">(rl-get </span><span class=pc2 title="line 292 char 51 count 999,998">(</span><span class=pc2 title="line 292 char 52 count 999,998">fx+</span><span class=pc2 title="line 292 char 51 count 999,998"> </span><span class=pc2 title="line 292 char 56 count 999,998">i</span><span class=pc2 title="line 292 char 51 count 999,998"> </span><span class=pc2 title="line 292 char 58 count 999,998">1</span><span class=pc2 title="line 292 char 51 count 999,998">)</span><span class=pc2 title="line 292 char 43 count 999,998">)</span><span class=pc2 title="line 291 char 5 count 999,998">])</span>
      <span class=pc2 title="line 293 char 7 count 999,998">(do-assert (and (fx&gt; len1 1)</span>
                      <span class=pc2 title="line 293 char 7 count 999,998">(fx&gt; len2 0)))</span>
      <span class=pc2 title="line 295 char 7 count 999,998">(do-assert (fx= (fx+ base1 len1) base2))</span>

      <span class=pc2 title="line 297 char 7 count 999,998">(rl-set! </span><span class=pc2 title="line 297 char 16 count 999,998">i</span><span class=pc2 title="line 297 char 7 count 999,998"> </span><span class=pc2 title="line 297 char 18 count 999,998">(</span><span class=pc2 title="line 297 char 19 count 999,998">fx+</span><span class=pc2 title="line 297 char 18 count 999,998"> </span><span class=pc2 title="line 297 char 23 count 999,998">len1</span><span class=pc2 title="line 297 char 18 count 999,998"> </span><span class=pc2 title="line 297 char 28 count 999,998">len2</span><span class=pc2 title="line 297 char 18 count 999,998">)</span><span class=pc2 title="line 297 char 7 count 999,998">)</span>
      <span class=pc2 title="line 298 char 7 count 999,998">(when </span><span class=pc2 title="line 298 char 13 count 999,998">(</span><span class=pc2 title="line 298 char 14 count 999,998">fx=</span><span class=pc2 title="line 298 char 13 count 999,998"> </span><span class=pc2 title="line 298 char 18 count 999,998">i</span><span class=pc2 title="line 298 char 13 count 999,998"> </span><span class=pc2 title="line 298 char 20 count 999,998">(</span><span class=pc2 title="line 298 char 21 count 999,998">fx-</span><span class=pc2 title="line 298 char 20 count 999,998"> </span><span class=pc2 title="line 298 char 25 count 999,998">stack-size</span><span class=pc2 title="line 298 char 20 count 999,998"> </span><span class=pc2 title="line 298 char 36 count 999,998">3</span><span class=pc2 title="line 298 char 20 count 999,998">)</span><span class=pc2 title="line 298 char 13 count 999,998">)</span>
            <span class=pc1 title="line 299 char 13 count 0">(rb-set! </span><span class=pc1 title="line 299 char 22 count 0">(</span><span class=pc1 title="line 299 char 23 count 0">fx+</span><span class=pc1 title="line 299 char 22 count 0"> </span><span class=pc1 title="line 299 char 27 count 0">i</span><span class=pc1 title="line 299 char 22 count 0"> </span><span class=pc1 title="line 299 char 29 count 0">1</span><span class=pc1 title="line 299 char 22 count 0">)</span><span class=pc1 title="line 299 char 13 count 0"> </span><span class=pc1 title="line 299 char 32 count 0">(rb-get </span><span class=pc1 title="line 299 char 40 count 0">(</span><span class=pc1 title="line 299 char 41 count 0">fx+</span><span class=pc1 title="line 299 char 40 count 0"> </span><span class=pc1 title="line 299 char 45 count 0">i</span><span class=pc1 title="line 299 char 40 count 0"> </span><span class=pc1 title="line 299 char 47 count 0">2</span><span class=pc1 title="line 299 char 40 count 0">)</span><span class=pc1 title="line 299 char 32 count 0">)</span><span class=pc1 title="line 299 char 13 count 0">)</span>
            <span class=pc1 title="line 300 char 13 count 0">(rl-set! </span><span class=pc1 title="line 300 char 22 count 0">(</span><span class=pc1 title="line 300 char 23 count 0">fx+</span><span class=pc1 title="line 300 char 22 count 0"> </span><span class=pc1 title="line 300 char 27 count 0">i</span><span class=pc1 title="line 300 char 22 count 0"> </span><span class=pc1 title="line 300 char 29 count 0">1</span><span class=pc1 title="line 300 char 22 count 0">)</span><span class=pc1 title="line 300 char 13 count 0"> </span><span class=pc1 title="line 300 char 32 count 0">(rl-get </span><span class=pc1 title="line 300 char 40 count 0">(</span><span class=pc1 title="line 300 char 41 count 0">fx+</span><span class=pc1 title="line 300 char 40 count 0"> </span><span class=pc1 title="line 300 char 45 count 0">i</span><span class=pc1 title="line 300 char 40 count 0"> </span><span class=pc1 title="line 300 char 47 count 0">2</span><span class=pc1 title="line 300 char 40 count 0">)</span><span class=pc1 title="line 300 char 32 count 0">)</span><span class=pc1 title="line 300 char 13 count 0">)</span><span class=pc2 title="line 298 char 7 count 999,998">)</span>
      <span class=pc2 title="line 301 char 7 count 999,998">(dec! </span><span class=pc2 title="line 301 char 13 count 999,998">stack-size</span><span class=pc2 title="line 301 char 7 count 999,998">)</span>

      <span class=pc2 title="line 303 char 7 count 999,998">(let ([k </span><span class=pc2 title="line 303 char 16 count 999,998">(</span><span class=pc2 title="line 303 char 17 count 999,998">gallop-right</span><span class=pc2 title="line 303 char 16 count 999,998"> </span><span class=pc2 title="line 303 char 30 count 999,998">(v-get </span><span class=pc2 title="line 303 char 37 count 999,998">base2</span><span class=pc2 title="line 303 char 30 count 999,998">)</span><span class=pc2 title="line 303 char 16 count 999,998"> </span><span class=pc2 title="line 303 char 44 count 999,998">v</span><span class=pc2 title="line 303 char 16 count 999,998"> </span><span class=pc2 title="line 303 char 46 count 999,998">base1</span><span class=pc2 title="line 303 char 16 count 999,998"> </span><span class=pc2 title="line 303 char 52 count 999,998">len1</span><span class=pc2 title="line 303 char 16 count 999,998"> </span><span class=pc2 title="line 303 char 57 count 999,998">0</span><span class=pc2 title="line 303 char 16 count 999,998">)</span><span class=pc2 title="line 303 char 7 count 999,998">])</span>
        <span class=pc2 title="line 304 char 9 count 999,998">(do-assert (fx&gt;= k 0))</span>

        <span class=pc2 title="line 306 char 9 count 999,998">(let ([base1 </span><span class=pc2 title="line 306 char 22 count 999,998">(</span><span class=pc2 title="line 306 char 23 count 999,998">fx+</span><span class=pc2 title="line 306 char 22 count 999,998"> </span><span class=pc2 title="line 306 char 27 count 999,998">base1</span><span class=pc2 title="line 306 char 22 count 999,998"> </span><span class=pc2 title="line 306 char 33 count 999,998">k</span><span class=pc2 title="line 306 char 22 count 999,998">)</span><span class=pc2 title="line 306 char 9 count 999,998">] [len1 </span><span class=pc2 title="line 306 char 43 count 999,998">(</span><span class=pc2 title="line 306 char 44 count 999,998">fx-</span><span class=pc2 title="line 306 char 43 count 999,998"> </span><span class=pc2 title="line 306 char 48 count 999,998">len1</span><span class=pc2 title="line 306 char 43 count 999,998"> </span><span class=pc2 title="line 306 char 53 count 999,998">k</span><span class=pc2 title="line 306 char 43 count 999,998">)</span><span class=pc2 title="line 306 char 9 count 999,998">])</span>
          <span class=pc2 title="line 307 char 11 count 999,998">(if </span><span class=pc2 title="line 307 char 15 count 999,998">(</span><span class=pc2 title="line 307 char 16 count 999,998">not</span><span class=pc2 title="line 307 char 15 count 999,998"> </span><span class=pc2 title="line 307 char 20 count 999,998">(</span><span class=pc2 title="line 307 char 21 count 999,998">fx=</span><span class=pc2 title="line 307 char 20 count 999,998"> </span><span class=pc2 title="line 307 char 25 count 999,998">len1</span><span class=pc2 title="line 307 char 20 count 999,998"> </span><span class=pc2 title="line 307 char 30 count 999,998">0</span><span class=pc2 title="line 307 char 20 count 999,998">)</span><span class=pc2 title="line 307 char 15 count 999,998">)</span>
              <span class=pc2 title="line 308 char 15 count 999,998">(let ([len2 </span><span class=pc2 title="line 308 char 27 count 999,998">(</span><span class=pc2 title="line 308 char 28 count 999,998">gallop-left</span><span class=pc2 title="line 308 char 27 count 999,998"> </span><span class=pc2 title="line 308 char 40 count 999,998">(v-get </span><span class=pc2 title="line 308 char 47 count 999,998">(</span><span class=pc2 title="line 308 char 48 count 999,998">fx+</span><span class=pc2 title="line 308 char 47 count 999,998"> </span><span class=pc2 title="line 308 char 52 count 999,998">base1</span><span class=pc2 title="line 308 char 47 count 999,998"> </span><span class=pc2 title="line 308 char 58 count 999,998">len1</span><span class=pc2 title="line 308 char 47 count 999,998"> </span><span class=pc2 title="line 308 char 63 count 999,998">-1</span><span class=pc2 title="line 308 char 47 count 999,998">)</span><span class=pc2 title="line 308 char 40 count 999,998">)</span><span class=pc2 title="line 308 char 27 count 999,998"> </span><span class=pc2 title="line 308 char 68 count 999,998">v</span><span class=pc2 title="line 308 char 27 count 999,998"> </span><span class=pc2 title="line 308 char 70 count 999,998">base2</span><span class=pc2 title="line 308 char 27 count 999,998"> </span><span class=pc2 title="line 308 char 76 count 999,998">len2</span><span class=pc2 title="line 308 char 27 count 999,998"> </span><span class=pc2 title="line 308 char 81 count 999,998">(</span><span class=pc2 title="line 308 char 82 count 999,998">fx-</span><span class=pc2 title="line 308 char 81 count 999,998"> </span><span class=pc2 title="line 308 char 86 count 999,998">len2</span><span class=pc2 title="line 308 char 81 count 999,998"> </span><span class=pc2 title="line 308 char 91 count 999,998">1</span><span class=pc2 title="line 308 char 81 count 999,998">)</span><span class=pc2 title="line 308 char 27 count 999,998">)</span><span class=pc2 title="line 308 char 15 count 999,998">])</span>
                <span class=pc2 title="line 309 char 17 count 999,998">(do-assert (fx&gt;= len2 0))</span>
                <span class=pc2 title="line 310 char 17 count 999,998">(cond</span>
                  <span class=pc2 title="line 310 char 17 count 999,998">[</span><span class=pc2 title="line 311 char 20 count 999,998">(</span><span class=pc2 title="line 311 char 21 count 999,998">fx=</span><span class=pc2 title="line 311 char 20 count 999,998"> </span><span class=pc2 title="line 311 char 25 count 999,998">len2</span><span class=pc2 title="line 311 char 20 count 999,998"> </span><span class=pc2 title="line 311 char 30 count 999,998">0</span><span class=pc2 title="line 311 char 20 count 999,998">)</span><span class=pc2 title="line 310 char 17 count 999,998"> </span><span class=pc1 title="line 311 char 33 count 0">#f</span><span class=pc2 title="line 310 char 17 count 999,998">]</span>
                  <span class=pc2 title="line 310 char 17 count 999,998">[</span><span class=pc2 title="line 312 char 20 count 999,998">(</span><span class=pc2 title="line 312 char 21 count 999,998">fx&lt;=</span><span class=pc2 title="line 312 char 20 count 999,998"> </span><span class=pc2 title="line 312 char 26 count 999,998">len1</span><span class=pc2 title="line 312 char 20 count 999,998"> </span><span class=pc2 title="line 312 char 31 count 999,998">len2</span><span class=pc2 title="line 312 char 20 count 999,998">)</span>
                   <span class=pc2 title="line 313 char 20 count 670,660">(</span><span class=pc2 title="line 313 char 21 count 670,660">merge-lo</span><span class=pc2 title="line 313 char 20 count 670,660"> </span><span class=pc2 title="line 313 char 30 count 670,660">base1</span><span class=pc2 title="line 313 char 20 count 670,660"> </span><span class=pc2 title="line 313 char 36 count 670,660">len1</span><span class=pc2 title="line 313 char 20 count 670,660"> </span><span class=pc2 title="line 313 char 41 count 670,660">base2</span><span class=pc2 title="line 313 char 20 count 670,660"> </span><span class=pc2 title="line 313 char 47 count 670,660">len2</span><span class=pc2 title="line 313 char 20 count 670,660">)</span><span class=pc2 title="line 310 char 17 count 999,998">]</span>
                  <span class=pc2 title="line 310 char 17 count 999,998">[else</span>
                   <span class=pc2 title="line 315 char 20 count 329,338">(</span><span class=pc2 title="line 315 char 21 count 329,338">merge-hi</span><span class=pc2 title="line 315 char 20 count 329,338"> </span><span class=pc2 title="line 315 char 30 count 329,338">base1</span><span class=pc2 title="line 315 char 20 count 329,338"> </span><span class=pc2 title="line 315 char 36 count 329,338">len1</span><span class=pc2 title="line 315 char 20 count 329,338"> </span><span class=pc2 title="line 315 char 41 count 329,338">base2</span><span class=pc2 title="line 315 char 20 count 329,338"> </span><span class=pc2 title="line 315 char 47 count 329,338">len2</span><span class=pc2 title="line 315 char 20 count 329,338">)</span><span class=pc2 title="line 310 char 17 count 999,998">])</span><span class=pc2 title="line 308 char 15 count 999,998">)</span><span class=pc2 title="line 307 char 11 count 999,998">)</span><span class=pc2 title="line 306 char 9 count 999,998">)</span><span class=pc2 title="line 303 char 7 count 999,998">)</span><span class=pc2 title="line 291 char 5 count 999,998">)</span><span class=pc2 title="line 285 char 3 count 12">)</span>

  <span class=pc2 title="line 317 char 3 count 12">(define (merge-lo base1 len1 base2 len2)</span>
    <span class=pc2 title="line 318 char 5 count 670,660">(define (do-while1 cnt1 cnt2 cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc7 title="line 319 char 7 count 213,163,672">(do-assert (and (fx&gt; len1 1) (fx&gt; len2 0)))</span>
      <span class=pc7 title="line 320 char 7 count 213,163,672">(cond</span>
        <span class=pc7 title="line 320 char 7 count 213,163,672">[</span><span class=pc7 title="line 321 char 10 count 213,163,672">(</span><span class=pc7 title="line 321 char 11 count 213,163,672">lt?</span><span class=pc7 title="line 321 char 10 count 213,163,672"> </span><span class=pc7 title="line 321 char 15 count 213,163,672">(v-get </span><span class=pc7 title="line 321 char 22 count 213,163,672">cur2</span><span class=pc7 title="line 321 char 15 count 213,163,672">)</span><span class=pc7 title="line 321 char 10 count 213,163,672"> </span><span class=pc7 title="line 321 char 28 count 213,163,672">(t-get </span><span class=pc7 title="line 321 char 35 count 213,163,672">cur1</span><span class=pc7 title="line 321 char 28 count 213,163,672">)</span><span class=pc7 title="line 321 char 10 count 213,163,672">)</span>
         <span class=pc5 title="line 322 char 10 count 106,875,824">(v-set! </span><span class=pc5 title="line 322 char 18 count 106,875,824">dest</span><span class=pc5 title="line 322 char 10 count 106,875,824"> </span><span class=pc5 title="line 322 char 23 count 106,875,824">(v-get </span><span class=pc5 title="line 322 char 30 count 106,875,824">cur2</span><span class=pc5 title="line 322 char 23 count 106,875,824">)</span><span class=pc5 title="line 322 char 10 count 106,875,824">)</span>
         <span class=pc5 title="line 323 char 10 count 106,875,824">(let ([dest </span><span class=pc5 title="line 323 char 22 count 106,875,824">(</span><span class=pc5 title="line 323 char 23 count 106,875,824">fx+</span><span class=pc5 title="line 323 char 22 count 106,875,824"> </span><span class=pc5 title="line 323 char 27 count 106,875,824">dest</span><span class=pc5 title="line 323 char 22 count 106,875,824"> </span><span class=pc5 title="line 323 char 32 count 106,875,824">1</span><span class=pc5 title="line 323 char 22 count 106,875,824">)</span><span class=pc5 title="line 323 char 10 count 106,875,824">]</span>
               <span class=pc5 title="line 323 char 10 count 106,875,824">[cur2 </span><span class=pc5 title="line 324 char 22 count 106,875,824">(</span><span class=pc5 title="line 324 char 23 count 106,875,824">fx+</span><span class=pc5 title="line 324 char 22 count 106,875,824"> </span><span class=pc5 title="line 324 char 27 count 106,875,824">cur2</span><span class=pc5 title="line 324 char 22 count 106,875,824"> </span><span class=pc5 title="line 324 char 32 count 106,875,824">1</span><span class=pc5 title="line 324 char 22 count 106,875,824">)</span><span class=pc5 title="line 323 char 10 count 106,875,824">]</span>
               <span class=pc5 title="line 323 char 10 count 106,875,824">[len2 </span><span class=pc5 title="line 325 char 22 count 106,875,824">(</span><span class=pc5 title="line 325 char 23 count 106,875,824">fx-</span><span class=pc5 title="line 325 char 22 count 106,875,824"> </span><span class=pc5 title="line 325 char 27 count 106,875,824">len2</span><span class=pc5 title="line 325 char 22 count 106,875,824"> </span><span class=pc5 title="line 325 char 32 count 106,875,824">1</span><span class=pc5 title="line 325 char 22 count 106,875,824">)</span><span class=pc5 title="line 323 char 10 count 106,875,824">])</span>
           <span class=pc5 title="line 326 char 12 count 106,875,824">(if </span><span class=pc5 title="line 326 char 16 count 106,875,824">(</span><span class=pc5 title="line 326 char 17 count 106,875,824">fx=</span><span class=pc5 title="line 326 char 16 count 106,875,824"> </span><span class=pc5 title="line 326 char 21 count 106,875,824">len2</span><span class=pc5 title="line 326 char 16 count 106,875,824"> </span><span class=pc5 title="line 326 char 26 count 106,875,824">0</span><span class=pc5 title="line 326 char 16 count 106,875,824">)</span>
               <span class=pc2 title="line 327 char 16 count 330,324">(</span><span class=pc2 title="line 327 char 17 count 330,324">break</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 23 count 330,324">cur1</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 28 count 330,324">cur2</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 33 count 330,324">dest</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 38 count 330,324">len1</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 43 count 330,324">len2</span><span class=pc2 title="line 327 char 16 count 330,324"> </span><span class=pc2 title="line 327 char 48 count 330,324">mgp</span><span class=pc2 title="line 327 char 16 count 330,324">)</span>
               <span class=pc5 title="line 328 char 16 count 106,545,500">(let ([cnt2 </span><span class=pc5 title="line 328 char 28 count 106,545,500">(</span><span class=pc5 title="line 328 char 29 count 106,545,500">fx+</span><span class=pc5 title="line 328 char 28 count 106,545,500"> </span><span class=pc5 title="line 328 char 33 count 106,545,500">cnt2</span><span class=pc5 title="line 328 char 28 count 106,545,500"> </span><span class=pc5 title="line 328 char 38 count 106,545,500">1</span><span class=pc5 title="line 328 char 28 count 106,545,500">)</span><span class=pc5 title="line 328 char 16 count 106,545,500">][cnt1 </span><span class=pc5 title="line 328 char 47 count 106,545,500">0</span><span class=pc5 title="line 328 char 16 count 106,545,500">])</span>
                 <span class=pc5 title="line 329 char 18 count 106,545,500">(if </span><span class=pc5 title="line 329 char 22 count 106,545,500">(</span><span class=pc5 title="line 329 char 23 count 106,545,500">fx&lt;</span><span class=pc5 title="line 329 char 22 count 106,545,500"> </span><span class=pc5 title="line 329 char 27 count 106,545,500">(</span><span class=pc5 title="line 329 char 28 count 106,545,500">fxlogor</span><span class=pc5 title="line 329 char 27 count 106,545,500"> </span><span class=pc5 title="line 329 char 36 count 106,545,500">cnt1</span><span class=pc5 title="line 329 char 27 count 106,545,500"> </span><span class=pc5 title="line 329 char 41 count 106,545,500">cnt2</span><span class=pc5 title="line 329 char 27 count 106,545,500">)</span><span class=pc5 title="line 329 char 22 count 106,545,500"> </span><span class=pc5 title="line 329 char 47 count 106,545,500">mgp</span><span class=pc5 title="line 329 char 22 count 106,545,500">)</span>
                     <span class=pc5 title="line 330 char 22 count 106,545,488">(</span><span class=pc5 title="line 330 char 23 count 106,545,488">do-while1</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 33 count 106,545,488">cnt1</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 38 count 106,545,488">cnt2</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 43 count 106,545,488">cur1</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 48 count 106,545,488">cur2</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 53 count 106,545,488">dest</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 58 count 106,545,488">len1</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 63 count 106,545,488">len2</span><span class=pc5 title="line 330 char 22 count 106,545,488"> </span><span class=pc5 title="line 330 char 68 count 106,545,488">mgp</span><span class=pc5 title="line 330 char 22 count 106,545,488">)</span>
                     <span class=pc2 title="line 331 char 22 count 12">(</span><span class=pc2 title="line 331 char 23 count 12">do-while2</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 33 count 12">cur1</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 38 count 12">cur2</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 43 count 12">dest</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 48 count 12">len1</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 53 count 12">len2</span><span class=pc2 title="line 331 char 22 count 12"> </span><span class=pc2 title="line 331 char 58 count 12">mgp</span><span class=pc2 title="line 331 char 22 count 12">)</span><span class=pc5 title="line 329 char 18 count 106,545,500">)</span><span class=pc5 title="line 328 char 16 count 106,545,500">)</span><span class=pc5 title="line 326 char 12 count 106,875,824">)</span><span class=pc5 title="line 323 char 10 count 106,875,824">)</span><span class=pc7 title="line 320 char 7 count 213,163,672">]</span>
        <span class=pc7 title="line 320 char 7 count 213,163,672">[else</span>
         <span class=pc5 title="line 333 char 10 count 106,287,848">(v-set! </span><span class=pc5 title="line 333 char 18 count 106,287,848">dest</span><span class=pc5 title="line 333 char 10 count 106,287,848"> </span><span class=pc5 title="line 333 char 23 count 106,287,848">(t-get </span><span class=pc5 title="line 333 char 30 count 106,287,848">cur1</span><span class=pc5 title="line 333 char 23 count 106,287,848">)</span><span class=pc5 title="line 333 char 10 count 106,287,848">)</span>
         <span class=pc5 title="line 334 char 10 count 106,287,848">(let ([dest </span><span class=pc5 title="line 334 char 22 count 106,287,848">(</span><span class=pc5 title="line 334 char 23 count 106,287,848">fx+</span><span class=pc5 title="line 334 char 22 count 106,287,848"> </span><span class=pc5 title="line 334 char 27 count 106,287,848">dest</span><span class=pc5 title="line 334 char 22 count 106,287,848"> </span><span class=pc5 title="line 334 char 32 count 106,287,848">1</span><span class=pc5 title="line 334 char 22 count 106,287,848">)</span><span class=pc5 title="line 334 char 10 count 106,287,848">]</span>
               <span class=pc5 title="line 334 char 10 count 106,287,848">[cur1 </span><span class=pc5 title="line 335 char 22 count 106,287,848">(</span><span class=pc5 title="line 335 char 23 count 106,287,848">fx+</span><span class=pc5 title="line 335 char 22 count 106,287,848"> </span><span class=pc5 title="line 335 char 27 count 106,287,848">cur1</span><span class=pc5 title="line 335 char 22 count 106,287,848"> </span><span class=pc5 title="line 335 char 32 count 106,287,848">1</span><span class=pc5 title="line 335 char 22 count 106,287,848">)</span><span class=pc5 title="line 334 char 10 count 106,287,848">]</span>
               <span class=pc5 title="line 334 char 10 count 106,287,848">[len1 </span><span class=pc5 title="line 336 char 22 count 106,287,848">(</span><span class=pc5 title="line 336 char 23 count 106,287,848">fx-</span><span class=pc5 title="line 336 char 22 count 106,287,848"> </span><span class=pc5 title="line 336 char 27 count 106,287,848">len1</span><span class=pc5 title="line 336 char 22 count 106,287,848"> </span><span class=pc5 title="line 336 char 32 count 106,287,848">1</span><span class=pc5 title="line 336 char 22 count 106,287,848">)</span><span class=pc5 title="line 334 char 10 count 106,287,848">])</span>
           <span class=pc5 title="line 337 char 12 count 106,287,848">(if </span><span class=pc5 title="line 337 char 16 count 106,287,848">(</span><span class=pc5 title="line 337 char 17 count 106,287,848">fx=</span><span class=pc5 title="line 337 char 16 count 106,287,848"> </span><span class=pc5 title="line 337 char 21 count 106,287,848">len1</span><span class=pc5 title="line 337 char 16 count 106,287,848"> </span><span class=pc5 title="line 337 char 26 count 106,287,848">1</span><span class=pc5 title="line 337 char 16 count 106,287,848">)</span>
               <span class=pc2 title="line 338 char 16 count 340,336">(</span><span class=pc2 title="line 338 char 17 count 340,336">break</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 23 count 340,336">cur1</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 28 count 340,336">cur2</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 33 count 340,336">dest</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 38 count 340,336">len1</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 43 count 340,336">len2</span><span class=pc2 title="line 338 char 16 count 340,336"> </span><span class=pc2 title="line 338 char 48 count 340,336">mgp</span><span class=pc2 title="line 338 char 16 count 340,336">)</span>
               <span class=pc5 title="line 339 char 16 count 105,947,512">(let ([cnt1 </span><span class=pc5 title="line 339 char 28 count 105,947,512">(</span><span class=pc5 title="line 339 char 29 count 105,947,512">fx+</span><span class=pc5 title="line 339 char 28 count 105,947,512"> </span><span class=pc5 title="line 339 char 33 count 105,947,512">cnt1</span><span class=pc5 title="line 339 char 28 count 105,947,512"> </span><span class=pc5 title="line 339 char 38 count 105,947,512">1</span><span class=pc5 title="line 339 char 28 count 105,947,512">)</span><span class=pc5 title="line 339 char 16 count 105,947,512">][cnt2 </span><span class=pc5 title="line 339 char 47 count 105,947,512">0</span><span class=pc5 title="line 339 char 16 count 105,947,512">])</span>
                 <span class=pc5 title="line 340 char 18 count 105,947,512">(if </span><span class=pc5 title="line 340 char 22 count 105,947,512">(</span><span class=pc5 title="line 340 char 23 count 105,947,512">fx&lt;</span><span class=pc5 title="line 340 char 22 count 105,947,512"> </span><span class=pc5 title="line 340 char 27 count 105,947,512">(</span><span class=pc5 title="line 340 char 28 count 105,947,512">fxlogor</span><span class=pc5 title="line 340 char 27 count 105,947,512"> </span><span class=pc5 title="line 340 char 36 count 105,947,512">cnt1</span><span class=pc5 title="line 340 char 27 count 105,947,512"> </span><span class=pc5 title="line 340 char 41 count 105,947,512">cnt2</span><span class=pc5 title="line 340 char 27 count 105,947,512">)</span><span class=pc5 title="line 340 char 22 count 105,947,512"> </span><span class=pc5 title="line 340 char 47 count 105,947,512">mgp</span><span class=pc5 title="line 340 char 22 count 105,947,512">)</span>
                     <span class=pc5 title="line 341 char 22 count 105,947,498">(</span><span class=pc5 title="line 341 char 23 count 105,947,498">do-while1</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 33 count 105,947,498">cnt1</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 38 count 105,947,498">cnt2</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 43 count 105,947,498">cur1</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 48 count 105,947,498">cur2</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 53 count 105,947,498">dest</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 58 count 105,947,498">len1</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 63 count 105,947,498">len2</span><span class=pc5 title="line 341 char 22 count 105,947,498"> </span><span class=pc5 title="line 341 char 68 count 105,947,498">mgp</span><span class=pc5 title="line 341 char 22 count 105,947,498">)</span>
                     <span class=pc2 title="line 342 char 22 count 14">(</span><span class=pc2 title="line 342 char 23 count 14">do-while2</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 33 count 14">cur1</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 38 count 14">cur2</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 43 count 14">dest</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 48 count 14">len1</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 53 count 14">len2</span><span class=pc2 title="line 342 char 22 count 14"> </span><span class=pc2 title="line 342 char 58 count 14">mgp</span><span class=pc2 title="line 342 char 22 count 14">)</span><span class=pc5 title="line 340 char 18 count 105,947,512">)</span><span class=pc5 title="line 339 char 16 count 105,947,512">)</span><span class=pc5 title="line 337 char 12 count 106,287,848">)</span><span class=pc5 title="line 334 char 10 count 106,287,848">)</span><span class=pc7 title="line 320 char 7 count 213,163,672">])</span><span class=pc2 title="line 318 char 5 count 670,660">)</span>

    <span class=pc2 title="line 344 char 5 count 670,660">(define (do-while2 cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc2 title="line 345 char 7 count 26">(define (continue1 cnt1 cur1 cur2 dest len1 len2 mgp)</span>
        <span class=pc2 title="line 346 char 9 count 26">(v-set! </span><span class=pc2 title="line 346 char 17 count 26">dest</span><span class=pc2 title="line 346 char 9 count 26"> </span><span class=pc2 title="line 346 char 22 count 26">(v-get </span><span class=pc2 title="line 346 char 29 count 26">cur2</span><span class=pc2 title="line 346 char 22 count 26">)</span><span class=pc2 title="line 346 char 9 count 26">)</span>
        <span class=pc2 title="line 347 char 9 count 26">(let ([dest </span><span class=pc2 title="line 347 char 21 count 26">(</span><span class=pc2 title="line 347 char 22 count 26">fx+</span><span class=pc2 title="line 347 char 21 count 26"> </span><span class=pc2 title="line 347 char 26 count 26">dest</span><span class=pc2 title="line 347 char 21 count 26"> </span><span class=pc2 title="line 347 char 31 count 26">1</span><span class=pc2 title="line 347 char 21 count 26">)</span><span class=pc2 title="line 347 char 9 count 26">]</span>
              <span class=pc2 title="line 347 char 9 count 26">[cur2 </span><span class=pc2 title="line 348 char 21 count 26">(</span><span class=pc2 title="line 348 char 22 count 26">fx+</span><span class=pc2 title="line 348 char 21 count 26"> </span><span class=pc2 title="line 348 char 26 count 26">cur2</span><span class=pc2 title="line 348 char 21 count 26"> </span><span class=pc2 title="line 348 char 31 count 26">1</span><span class=pc2 title="line 348 char 21 count 26">)</span><span class=pc2 title="line 347 char 9 count 26">]</span>
              <span class=pc2 title="line 347 char 9 count 26">[len2 </span><span class=pc2 title="line 349 char 21 count 26">(</span><span class=pc2 title="line 349 char 22 count 26">fx-</span><span class=pc2 title="line 349 char 21 count 26"> </span><span class=pc2 title="line 349 char 26 count 26">len2</span><span class=pc2 title="line 349 char 21 count 26"> </span><span class=pc2 title="line 349 char 31 count 26">1</span><span class=pc2 title="line 349 char 21 count 26">)</span><span class=pc2 title="line 347 char 9 count 26">])</span>
          <span class=pc2 title="line 350 char 11 count 26">(cond</span>
            <span class=pc2 title="line 350 char 11 count 26">[</span><span class=pc2 title="line 351 char 14 count 26">(</span><span class=pc2 title="line 351 char 15 count 26">fx=</span><span class=pc2 title="line 351 char 14 count 26"> </span><span class=pc2 title="line 351 char 19 count 26">len2</span><span class=pc2 title="line 351 char 14 count 26"> </span><span class=pc2 title="line 351 char 24 count 26">0</span><span class=pc2 title="line 351 char 14 count 26">)</span><span class=pc2 title="line 350 char 11 count 26"> </span><span class=pc1 title="line 351 char 27 count 0">(</span><span class=pc1 title="line 351 char 28 count 0">break</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 34 count 0">cur1</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 39 count 0">cur2</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 44 count 0">dest</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 49 count 0">len1</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 54 count 0">len2</span><span class=pc1 title="line 351 char 27 count 0"> </span><span class=pc1 title="line 351 char 59 count 0">mgp</span><span class=pc1 title="line 351 char 27 count 0">)</span><span class=pc2 title="line 350 char 11 count 26">]</span>
            <span class=pc2 title="line 350 char 11 count 26">[else</span>
             <span class=pc2 title="line 353 char 14 count 26">(let ([cnt2 </span><span class=pc2 title="line 353 char 26 count 26">(</span><span class=pc2 title="line 353 char 27 count 26">gallop-left</span><span class=pc2 title="line 353 char 26 count 26"> </span><span class=pc2 title="line 353 char 39 count 26">(t-get </span><span class=pc2 title="line 353 char 46 count 26">cur1</span><span class=pc2 title="line 353 char 39 count 26">)</span><span class=pc2 title="line 353 char 26 count 26"> </span><span class=pc2 title="line 353 char 52 count 26">v</span><span class=pc2 title="line 353 char 26 count 26"> </span><span class=pc2 title="line 353 char 54 count 26">cur2</span><span class=pc2 title="line 353 char 26 count 26"> </span><span class=pc2 title="line 353 char 59 count 26">len2</span><span class=pc2 title="line 353 char 26 count 26"> </span><span class=pc2 title="line 353 char 64 count 26">0</span><span class=pc2 title="line 353 char 26 count 26">)</span><span class=pc2 title="line 353 char 14 count 26">])</span>
               <span class=pc2 title="line 354 char 16 count 26">(cond</span>
                 <span class=pc2 title="line 354 char 16 count 26">[</span><span class=pc2 title="line 355 char 19 count 26">(</span><span class=pc2 title="line 355 char 20 count 26">not</span><span class=pc2 title="line 355 char 19 count 26"> </span><span class=pc2 title="line 355 char 24 count 26">(</span><span class=pc2 title="line 355 char 25 count 26">fx=</span><span class=pc2 title="line 355 char 24 count 26"> </span><span class=pc2 title="line 355 char 29 count 26">cnt2</span><span class=pc2 title="line 355 char 24 count 26"> </span><span class=pc2 title="line 355 char 34 count 26">0</span><span class=pc2 title="line 355 char 24 count 26">)</span><span class=pc2 title="line 355 char 19 count 26">)</span>
                  <span class=pc2 title="line 356 char 19 count 12">(</span><span class=pc2 title="line 356 char 20 count 12">vector-copy!</span><span class=pc2 title="line 356 char 19 count 12"> </span><span class=pc2 title="line 356 char 33 count 12">v</span><span class=pc2 title="line 356 char 19 count 12"> </span><span class=pc2 title="line 356 char 35 count 12">cur2</span><span class=pc2 title="line 356 char 19 count 12"> </span><span class=pc2 title="line 356 char 40 count 12">v</span><span class=pc2 title="line 356 char 19 count 12"> </span><span class=pc2 title="line 356 char 42 count 12">dest</span><span class=pc2 title="line 356 char 19 count 12"> </span><span class=pc2 title="line 356 char 47 count 12">cnt2</span><span class=pc2 title="line 356 char 19 count 12">)</span>
                  <span class=pc2 title="line 357 char 19 count 12">(let ([dest </span><span class=pc2 title="line 357 char 31 count 12">(</span><span class=pc2 title="line 357 char 32 count 12">fx+</span><span class=pc2 title="line 357 char 31 count 12"> </span><span class=pc2 title="line 357 char 36 count 12">dest</span><span class=pc2 title="line 357 char 31 count 12"> </span><span class=pc2 title="line 357 char 41 count 12">cnt2</span><span class=pc2 title="line 357 char 31 count 12">)</span><span class=pc2 title="line 357 char 19 count 12">]</span>
                        <span class=pc2 title="line 357 char 19 count 12">[cur2 </span><span class=pc2 title="line 358 char 31 count 12">(</span><span class=pc2 title="line 358 char 32 count 12">fx+</span><span class=pc2 title="line 358 char 31 count 12"> </span><span class=pc2 title="line 358 char 36 count 12">cur2</span><span class=pc2 title="line 358 char 31 count 12"> </span><span class=pc2 title="line 358 char 41 count 12">cnt2</span><span class=pc2 title="line 358 char 31 count 12">)</span><span class=pc2 title="line 357 char 19 count 12">]</span>
                        <span class=pc2 title="line 357 char 19 count 12">[len2 </span><span class=pc2 title="line 359 char 31 count 12">(</span><span class=pc2 title="line 359 char 32 count 12">fx-</span><span class=pc2 title="line 359 char 31 count 12"> </span><span class=pc2 title="line 359 char 36 count 12">len2</span><span class=pc2 title="line 359 char 31 count 12"> </span><span class=pc2 title="line 359 char 41 count 12">cnt2</span><span class=pc2 title="line 359 char 31 count 12">)</span><span class=pc2 title="line 357 char 19 count 12">])</span>
                    <span class=pc2 title="line 360 char 21 count 12">(if </span><span class=pc2 title="line 360 char 25 count 12">(</span><span class=pc2 title="line 360 char 26 count 12">fx=</span><span class=pc2 title="line 360 char 25 count 12"> </span><span class=pc2 title="line 360 char 30 count 12">len2</span><span class=pc2 title="line 360 char 25 count 12"> </span><span class=pc2 title="line 360 char 35 count 12">0</span><span class=pc2 title="line 360 char 25 count 12">)</span>
                        <span class=pc1 title="line 361 char 25 count 0">(</span><span class=pc1 title="line 361 char 26 count 0">break</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 32 count 0">cur1</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 37 count 0">cur2</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 42 count 0">dest</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 47 count 0">len1</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 52 count 0">len2</span><span class=pc1 title="line 361 char 25 count 0"> </span><span class=pc1 title="line 361 char 57 count 0">mgp</span><span class=pc1 title="line 361 char 25 count 0">)</span>
                        <span class=pc2 title="line 362 char 25 count 12">(</span><span class=pc2 title="line 362 char 26 count 12">continue2</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 36 count 12">cnt1</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 41 count 12">cnt2</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 46 count 12">cur1</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 51 count 12">cur2</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 56 count 12">dest</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 61 count 12">len1</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 66 count 12">len2</span><span class=pc2 title="line 362 char 25 count 12"> </span><span class=pc2 title="line 362 char 71 count 12">mgp</span><span class=pc2 title="line 362 char 25 count 12">)</span><span class=pc2 title="line 360 char 21 count 12">)</span><span class=pc2 title="line 357 char 19 count 12">)</span><span class=pc2 title="line 354 char 16 count 26">]</span>
                 <span class=pc2 title="line 354 char 16 count 26">[else </span><span class=pc2 title="line 363 char 24 count 14">(</span><span class=pc2 title="line 363 char 25 count 14">continue2</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 35 count 14">cnt1</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 40 count 14">cnt2</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 45 count 14">cur1</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 50 count 14">cur2</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 55 count 14">dest</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 60 count 14">len1</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 65 count 14">len2</span><span class=pc2 title="line 363 char 24 count 14"> </span><span class=pc2 title="line 363 char 70 count 14">mgp</span><span class=pc2 title="line 363 char 24 count 14">)</span><span class=pc2 title="line 354 char 16 count 26">])</span><span class=pc2 title="line 353 char 14 count 26">)</span><span class=pc2 title="line 350 char 11 count 26">])</span><span class=pc2 title="line 347 char 9 count 26">)</span><span class=pc2 title="line 345 char 7 count 26">)</span>
      <span class=pc2 title="line 364 char 7 count 26">(define (continue2 cnt1 cnt2 cur1 cur2 dest len1 len2 mgp)</span>
        <span class=pc2 title="line 365 char 9 count 26">(v-set! </span><span class=pc2 title="line 365 char 17 count 26">dest</span><span class=pc2 title="line 365 char 9 count 26"> </span><span class=pc2 title="line 365 char 22 count 26">(t-get </span><span class=pc2 title="line 365 char 29 count 26">cur1</span><span class=pc2 title="line 365 char 22 count 26">)</span><span class=pc2 title="line 365 char 9 count 26">)</span>
        <span class=pc2 title="line 366 char 9 count 26">(let ([dest </span><span class=pc2 title="line 366 char 21 count 26">(</span><span class=pc2 title="line 366 char 22 count 26">fx+</span><span class=pc2 title="line 366 char 21 count 26"> </span><span class=pc2 title="line 366 char 26 count 26">dest</span><span class=pc2 title="line 366 char 21 count 26"> </span><span class=pc2 title="line 366 char 31 count 26">1</span><span class=pc2 title="line 366 char 21 count 26">)</span><span class=pc2 title="line 366 char 9 count 26">]</span>
              <span class=pc2 title="line 366 char 9 count 26">[cur1 </span><span class=pc2 title="line 367 char 21 count 26">(</span><span class=pc2 title="line 367 char 22 count 26">fx+</span><span class=pc2 title="line 367 char 21 count 26"> </span><span class=pc2 title="line 367 char 26 count 26">cur1</span><span class=pc2 title="line 367 char 21 count 26"> </span><span class=pc2 title="line 367 char 31 count 26">1</span><span class=pc2 title="line 367 char 21 count 26">)</span><span class=pc2 title="line 366 char 9 count 26">]</span>
              <span class=pc2 title="line 366 char 9 count 26">[len1 </span><span class=pc2 title="line 368 char 21 count 26">(</span><span class=pc2 title="line 368 char 22 count 26">fx-</span><span class=pc2 title="line 368 char 21 count 26"> </span><span class=pc2 title="line 368 char 26 count 26">len1</span><span class=pc2 title="line 368 char 21 count 26"> </span><span class=pc2 title="line 368 char 31 count 26">1</span><span class=pc2 title="line 368 char 21 count 26">)</span><span class=pc2 title="line 366 char 9 count 26">])</span>
          <span class=pc2 title="line 369 char 11 count 26">(if </span><span class=pc2 title="line 369 char 15 count 26">(</span><span class=pc2 title="line 369 char 16 count 26">fx=</span><span class=pc2 title="line 369 char 15 count 26"> </span><span class=pc2 title="line 369 char 20 count 26">len1</span><span class=pc2 title="line 369 char 15 count 26"> </span><span class=pc2 title="line 369 char 25 count 26">1</span><span class=pc2 title="line 369 char 15 count 26">)</span>
              <span class=pc1 title="line 370 char 15 count 0">(</span><span class=pc1 title="line 370 char 16 count 0">break</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 22 count 0">cur1</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 27 count 0">cur2</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 32 count 0">dest</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 37 count 0">len1</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 42 count 0">len2</span><span class=pc1 title="line 370 char 15 count 0"> </span><span class=pc1 title="line 370 char 47 count 0">mgp</span><span class=pc1 title="line 370 char 15 count 0">)</span>
              <span class=pc2 title="line 371 char 15 count 26">(let ([mgp </span><span class=pc2 title="line 371 char 26 count 26">(</span><span class=pc2 title="line 371 char 27 count 26">fx-</span><span class=pc2 title="line 371 char 26 count 26"> </span><span class=pc2 title="line 371 char 31 count 26">mgp</span><span class=pc2 title="line 371 char 26 count 26"> </span><span class=pc2 title="line 371 char 35 count 26">1</span><span class=pc2 title="line 371 char 26 count 26">)</span><span class=pc2 title="line 371 char 15 count 26">])</span>
                <span class=pc2 title="line 372 char 17 count 26">(cond</span>
                  <span class=pc2 title="line 372 char 17 count 26">[</span><span class=pc2 title="line 373 char 20 count 26">(or </span><span class=pc2 title="line 373 char 24 count 26">(</span><span class=pc2 title="line 373 char 25 count 26">fx&gt;=</span><span class=pc2 title="line 373 char 24 count 26"> </span><span class=pc2 title="line 373 char 30 count 26">cnt1</span><span class=pc2 title="line 373 char 24 count 26"> </span><span class=pc2 title="line 373 char 35 count 26">MIN_GALLOP</span><span class=pc2 title="line 373 char 24 count 26">)</span>
                       <span class=pc2 title="line 374 char 24 count 26">(</span><span class=pc2 title="line 374 char 25 count 26">fx&gt;=</span><span class=pc2 title="line 374 char 24 count 26"> </span><span class=pc2 title="line 374 char 30 count 26">cnt2</span><span class=pc2 title="line 374 char 24 count 26"> </span><span class=pc2 title="line 374 char 35 count 26">MIN_GALLOP</span><span class=pc2 title="line 374 char 24 count 26">)</span><span class=pc2 title="line 373 char 20 count 26">)</span>
                   <span class=pc1 title="line 375 char 20 count 0">(</span><span class=pc1 title="line 375 char 21 count 0">do-while2</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 31 count 0">cur1</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 36 count 0">cur2</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 41 count 0">dest</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 46 count 0">len1</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 51 count 0">len2</span><span class=pc1 title="line 375 char 20 count 0"> </span><span class=pc1 title="line 375 char 56 count 0">mgp</span><span class=pc1 title="line 375 char 20 count 0">)</span><span class=pc2 title="line 372 char 17 count 26">]</span>
                  <span class=pc2 title="line 372 char 17 count 26">[else</span>
                   <span class=pc2 title="line 377 char 20 count 26">(let ([mgp </span><span class=pc2 title="line 377 char 31 count 26">(if </span><span class=pc2 title="line 377 char 35 count 26">(</span><span class=pc2 title="line 377 char 36 count 26">fx&lt;</span><span class=pc2 title="line 377 char 35 count 26"> </span><span class=pc2 title="line 377 char 40 count 26">mgp</span><span class=pc2 title="line 377 char 35 count 26"> </span><span class=pc2 title="line 377 char 44 count 26">0</span><span class=pc2 title="line 377 char 35 count 26">)</span><span class=pc2 title="line 377 char 31 count 26"> </span><span class=pc1 title="line 377 char 47 count 0">2</span><span class=pc2 title="line 377 char 31 count 26"> </span><span class=pc2 title="line 377 char 49 count 26">(</span><span class=pc2 title="line 377 char 50 count 26">fx+</span><span class=pc2 title="line 377 char 49 count 26"> </span><span class=pc2 title="line 377 char 54 count 26">mgp</span><span class=pc2 title="line 377 char 49 count 26"> </span><span class=pc2 title="line 377 char 58 count 26">2</span><span class=pc2 title="line 377 char 49 count 26">)</span><span class=pc2 title="line 377 char 31 count 26">)</span><span class=pc2 title="line 377 char 20 count 26">])</span>
                     <span class=pc2 title="line 378 char 22 count 26">(</span><span class=pc2 title="line 378 char 23 count 26">do-while1</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 33 count 26">0</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 35 count 26">0</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 37 count 26">cur1</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 42 count 26">cur2</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 47 count 26">dest</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 52 count 26">len1</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 57 count 26">len2</span><span class=pc2 title="line 378 char 22 count 26"> </span><span class=pc2 title="line 378 char 62 count 26">mgp</span><span class=pc2 title="line 378 char 22 count 26">)</span><span class=pc2 title="line 377 char 20 count 26">)</span><span class=pc2 title="line 372 char 17 count 26">])</span><span class=pc2 title="line 371 char 15 count 26">)</span><span class=pc2 title="line 369 char 11 count 26">)</span><span class=pc2 title="line 366 char 9 count 26">)</span><span class=pc2 title="line 364 char 7 count 26">)</span>

      <span class=pc2 title="line 380 char 7 count 26">(do-assert (and (fx&gt; len1 1) (fx&gt; len2 0)))</span>
      <span class=pc2 title="line 381 char 7 count 26">(let ([cnt1 </span><span class=pc2 title="line 381 char 19 count 26">(</span><span class=pc2 title="line 381 char 20 count 26">gallop-right</span><span class=pc2 title="line 381 char 19 count 26"> </span><span class=pc2 title="line 381 char 33 count 26">(v-get </span><span class=pc2 title="line 381 char 40 count 26">cur2</span><span class=pc2 title="line 381 char 33 count 26">)</span><span class=pc2 title="line 381 char 19 count 26"> </span><span class=pc2 title="line 381 char 46 count 26">tmp-array</span><span class=pc2 title="line 381 char 19 count 26"> </span><span class=pc2 title="line 381 char 56 count 26">cur1</span><span class=pc2 title="line 381 char 19 count 26"> </span><span class=pc2 title="line 381 char 61 count 26">len1</span><span class=pc2 title="line 381 char 19 count 26"> </span><span class=pc2 title="line 381 char 66 count 26">0</span><span class=pc2 title="line 381 char 19 count 26">)</span><span class=pc2 title="line 381 char 7 count 26">])</span>
        <span class=pc2 title="line 382 char 9 count 26">(cond</span>
          <span class=pc2 title="line 382 char 9 count 26">[</span><span class=pc2 title="line 383 char 12 count 26">(</span><span class=pc2 title="line 383 char 13 count 26">not</span><span class=pc2 title="line 383 char 12 count 26"> </span><span class=pc2 title="line 383 char 17 count 26">(</span><span class=pc2 title="line 383 char 18 count 26">fx=</span><span class=pc2 title="line 383 char 17 count 26"> </span><span class=pc2 title="line 383 char 22 count 26">cnt1</span><span class=pc2 title="line 383 char 17 count 26"> </span><span class=pc2 title="line 383 char 27 count 26">0</span><span class=pc2 title="line 383 char 17 count 26">)</span><span class=pc2 title="line 383 char 12 count 26">)</span>
           <span class=pc2 title="line 384 char 12 count 14">(</span><span class=pc2 title="line 384 char 13 count 14">vector-copy!</span><span class=pc2 title="line 384 char 12 count 14"> </span><span class=pc2 title="line 384 char 26 count 14">tmp-array</span><span class=pc2 title="line 384 char 12 count 14"> </span><span class=pc2 title="line 384 char 36 count 14">cur1</span><span class=pc2 title="line 384 char 12 count 14"> </span><span class=pc2 title="line 384 char 41 count 14">v</span><span class=pc2 title="line 384 char 12 count 14"> </span><span class=pc2 title="line 384 char 43 count 14">dest</span><span class=pc2 title="line 384 char 12 count 14"> </span><span class=pc2 title="line 384 char 48 count 14">cnt1</span><span class=pc2 title="line 384 char 12 count 14">)</span>
           <span class=pc2 title="line 385 char 12 count 14">(let ([dest </span><span class=pc2 title="line 385 char 24 count 14">(</span><span class=pc2 title="line 385 char 25 count 14">fx+</span><span class=pc2 title="line 385 char 24 count 14"> </span><span class=pc2 title="line 385 char 29 count 14">dest</span><span class=pc2 title="line 385 char 24 count 14"> </span><span class=pc2 title="line 385 char 34 count 14">cnt1</span><span class=pc2 title="line 385 char 24 count 14">)</span><span class=pc2 title="line 385 char 12 count 14">]</span>
                 <span class=pc2 title="line 385 char 12 count 14">[cur1 </span><span class=pc2 title="line 386 char 24 count 14">(</span><span class=pc2 title="line 386 char 25 count 14">fx+</span><span class=pc2 title="line 386 char 24 count 14"> </span><span class=pc2 title="line 386 char 29 count 14">cur1</span><span class=pc2 title="line 386 char 24 count 14"> </span><span class=pc2 title="line 386 char 34 count 14">cnt1</span><span class=pc2 title="line 386 char 24 count 14">)</span><span class=pc2 title="line 385 char 12 count 14">]</span>
                 <span class=pc2 title="line 385 char 12 count 14">[len1 </span><span class=pc2 title="line 387 char 24 count 14">(</span><span class=pc2 title="line 387 char 25 count 14">fx-</span><span class=pc2 title="line 387 char 24 count 14"> </span><span class=pc2 title="line 387 char 29 count 14">len1</span><span class=pc2 title="line 387 char 24 count 14"> </span><span class=pc2 title="line 387 char 34 count 14">cnt1</span><span class=pc2 title="line 387 char 24 count 14">)</span><span class=pc2 title="line 385 char 12 count 14">])</span>
             <span class=pc2 title="line 388 char 14 count 14">(if </span><span class=pc2 title="line 388 char 18 count 14">(</span><span class=pc2 title="line 388 char 19 count 14">fx&lt;=</span><span class=pc2 title="line 388 char 18 count 14"> </span><span class=pc2 title="line 388 char 24 count 14">len1</span><span class=pc2 title="line 388 char 18 count 14"> </span><span class=pc2 title="line 388 char 29 count 14">1</span><span class=pc2 title="line 388 char 18 count 14">)</span>
                 <span class=pc1 title="line 389 char 18 count 0">(</span><span class=pc1 title="line 389 char 19 count 0">break</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 25 count 0">cur1</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 30 count 0">cur2</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 35 count 0">dest</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 40 count 0">len1</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 45 count 0">len2</span><span class=pc1 title="line 389 char 18 count 0"> </span><span class=pc1 title="line 389 char 50 count 0">mgp</span><span class=pc1 title="line 389 char 18 count 0">)</span>
                 <span class=pc2 title="line 390 char 18 count 14">(</span><span class=pc2 title="line 390 char 19 count 14">continue1</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 29 count 14">cnt1</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 34 count 14">cur1</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 39 count 14">cur2</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 44 count 14">dest</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 49 count 14">len1</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 54 count 14">len2</span><span class=pc2 title="line 390 char 18 count 14"> </span><span class=pc2 title="line 390 char 59 count 14">mgp</span><span class=pc2 title="line 390 char 18 count 14">)</span><span class=pc2 title="line 388 char 14 count 14">)</span><span class=pc2 title="line 385 char 12 count 14">)</span><span class=pc2 title="line 382 char 9 count 26">]</span>
          <span class=pc2 title="line 382 char 9 count 26">[else </span><span class=pc2 title="line 391 char 17 count 12">(</span><span class=pc2 title="line 391 char 18 count 12">continue1</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 28 count 12">cnt1</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 33 count 12">cur1</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 38 count 12">cur2</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 43 count 12">dest</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 48 count 12">len1</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 53 count 12">len2</span><span class=pc2 title="line 391 char 17 count 12"> </span><span class=pc2 title="line 391 char 58 count 12">mgp</span><span class=pc2 title="line 391 char 17 count 12">)</span><span class=pc2 title="line 382 char 9 count 26">])</span><span class=pc2 title="line 381 char 7 count 26">)</span><span class=pc2 title="line 344 char 5 count 670,660">)</span>

    <span class=pc2 title="line 393 char 5 count 670,660">(define (break cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc2 title="line 394 char 7 count 670,660">(set! min-gallop </span><span class=pc2 title="line 394 char 24 count 670,660">(</span><span class=pc2 title="line 394 char 25 count 670,660">max</span><span class=pc2 title="line 394 char 24 count 670,660"> </span><span class=pc2 title="line 394 char 29 count 670,660">1</span><span class=pc2 title="line 394 char 24 count 670,660"> </span><span class=pc2 title="line 394 char 31 count 670,660">mgp</span><span class=pc2 title="line 394 char 24 count 670,660">)</span><span class=pc2 title="line 394 char 7 count 670,660">)</span>
      <span class=pc2 title="line 395 char 7 count 670,660">(cond</span>
        <span class=pc2 title="line 395 char 7 count 670,660">[</span><span class=pc2 title="line 396 char 10 count 670,660">(</span><span class=pc2 title="line 396 char 11 count 670,660">fx=</span><span class=pc2 title="line 396 char 10 count 670,660"> </span><span class=pc2 title="line 396 char 15 count 670,660">len1</span><span class=pc2 title="line 396 char 10 count 670,660"> </span><span class=pc2 title="line 396 char 20 count 670,660">1</span><span class=pc2 title="line 396 char 10 count 670,660">)</span>
         <span class=pc2 title="line 397 char 10 count 340,336">(do-assert (fx&gt; len2 0))</span>
         <span class=pc2 title="line 398 char 10 count 340,336">(</span><span class=pc2 title="line 398 char 11 count 340,336">vector-copy!</span><span class=pc2 title="line 398 char 10 count 340,336"> </span><span class=pc2 title="line 398 char 24 count 340,336">v</span><span class=pc2 title="line 398 char 10 count 340,336"> </span><span class=pc2 title="line 398 char 26 count 340,336">cur2</span><span class=pc2 title="line 398 char 10 count 340,336"> </span><span class=pc2 title="line 398 char 31 count 340,336">v</span><span class=pc2 title="line 398 char 10 count 340,336"> </span><span class=pc2 title="line 398 char 33 count 340,336">dest</span><span class=pc2 title="line 398 char 10 count 340,336"> </span><span class=pc2 title="line 398 char 38 count 340,336">len2</span><span class=pc2 title="line 398 char 10 count 340,336">)</span>
         <span class=pc2 title="line 399 char 10 count 340,336">(v-set! </span><span class=pc2 title="line 399 char 18 count 340,336">(</span><span class=pc2 title="line 399 char 19 count 340,336">fx+</span><span class=pc2 title="line 399 char 18 count 340,336"> </span><span class=pc2 title="line 399 char 23 count 340,336">dest</span><span class=pc2 title="line 399 char 18 count 340,336"> </span><span class=pc2 title="line 399 char 28 count 340,336">len2</span><span class=pc2 title="line 399 char 18 count 340,336">)</span><span class=pc2 title="line 399 char 10 count 340,336"> </span><span class=pc2 title="line 399 char 34 count 340,336">(t-get </span><span class=pc2 title="line 399 char 41 count 340,336">cur1</span><span class=pc2 title="line 399 char 34 count 340,336">)</span><span class=pc2 title="line 399 char 10 count 340,336">)</span><span class=pc2 title="line 395 char 7 count 670,660">]</span>
        <span class=pc2 title="line 395 char 7 count 670,660">[</span><span class=pc2 title="line 400 char 10 count 330,324">(</span><span class=pc2 title="line 400 char 11 count 330,324">fx=</span><span class=pc2 title="line 400 char 10 count 330,324"> </span><span class=pc2 title="line 400 char 15 count 330,324">len1</span><span class=pc2 title="line 400 char 10 count 330,324"> </span><span class=pc2 title="line 400 char 20 count 330,324">0</span><span class=pc2 title="line 400 char 10 count 330,324">)</span>
         <span class=pc1 title="line 401 char 10 count 0">(do-assert (fx= len2 0))</span>
         <span class=pc1 title="line 402 char 10 count 0">(</span><span class=pc1 title="line 402 char 11 count 0">error</span><span class=pc1 title="line 402 char 10 count 0"> </span><span class=pc1 title="line 402 char 17 count 0">'merge-lo</span>
                <span class=pc1 title="line 403 char 17 count 0">"Comparison method violates its general contract!"</span><span class=pc1 title="line 402 char 10 count 0">)</span><span class=pc2 title="line 395 char 7 count 670,660">]</span>
        <span class=pc2 title="line 395 char 7 count 670,660">[else</span>
         <span class=pc2 title="line 405 char 10 count 330,324">(do-assert (fx= len2 0))</span>
         <span class=pc2 title="line 406 char 10 count 330,324">(do-assert (fx&gt; len1 1))</span>
         <span class=pc2 title="line 407 char 10 count 330,324">(</span><span class=pc2 title="line 407 char 11 count 330,324">vector-copy!</span><span class=pc2 title="line 407 char 10 count 330,324"> </span><span class=pc2 title="line 407 char 24 count 330,324">tmp-array</span><span class=pc2 title="line 407 char 10 count 330,324"> </span><span class=pc2 title="line 407 char 34 count 330,324">cur1</span><span class=pc2 title="line 407 char 10 count 330,324"> </span><span class=pc2 title="line 407 char 39 count 330,324">v</span><span class=pc2 title="line 407 char 10 count 330,324"> </span><span class=pc2 title="line 407 char 41 count 330,324">dest</span><span class=pc2 title="line 407 char 10 count 330,324"> </span><span class=pc2 title="line 407 char 46 count 330,324">len1</span><span class=pc2 title="line 407 char 10 count 330,324">)</span><span class=pc2 title="line 395 char 7 count 670,660">])</span><span class=pc2 title="line 393 char 5 count 670,660">)</span>

    <span class=pc2 title="line 409 char 5 count 670,660">(do-assert (and (fx&gt; len1 0) (fx&gt; len2 0) (fx= (fx+ base1 len1) base2)))</span>
    <span class=pc2 title="line 410 char 5 count 670,660">(</span><span class=pc2 title="line 410 char 6 count 670,660">ensure-capacity!</span><span class=pc2 title="line 410 char 5 count 670,660"> </span><span class=pc2 title="line 410 char 23 count 670,660">len1</span><span class=pc2 title="line 410 char 5 count 670,660">)</span>
    <span class=pc2 title="line 411 char 5 count 670,660">(</span><span class=pc2 title="line 411 char 6 count 670,660">vector-copy!</span><span class=pc2 title="line 411 char 5 count 670,660"> </span><span class=pc2 title="line 411 char 19 count 670,660">v</span><span class=pc2 title="line 411 char 5 count 670,660"> </span><span class=pc2 title="line 411 char 21 count 670,660">base1</span><span class=pc2 title="line 411 char 5 count 670,660"> </span><span class=pc2 title="line 411 char 27 count 670,660">tmp-array</span><span class=pc2 title="line 411 char 5 count 670,660"> </span><span class=pc2 title="line 411 char 37 count 670,660">0</span><span class=pc2 title="line 411 char 5 count 670,660"> </span><span class=pc2 title="line 411 char 39 count 670,660">len1</span><span class=pc2 title="line 411 char 5 count 670,660">)</span>

    <span class=pc2 title="line 413 char 5 count 670,660">(let ([cur1 </span><span class=pc2 title="line 413 char 17 count 670,660">0</span><span class=pc2 title="line 413 char 5 count 670,660">][cur2 </span><span class=pc2 title="line 413 char 25 count 670,660">base2</span><span class=pc2 title="line 413 char 5 count 670,660">][dest </span><span class=pc2 title="line 413 char 37 count 670,660">base1</span><span class=pc2 title="line 413 char 5 count 670,660">])</span>
      <span class=pc2 title="line 414 char 7 count 670,660">(v-set! </span><span class=pc2 title="line 414 char 15 count 670,660">dest</span><span class=pc2 title="line 414 char 7 count 670,660"> </span><span class=pc2 title="line 414 char 20 count 670,660">(v-get </span><span class=pc2 title="line 414 char 27 count 670,660">cur2</span><span class=pc2 title="line 414 char 20 count 670,660">)</span><span class=pc2 title="line 414 char 7 count 670,660">)</span>
      <span class=pc2 title="line 415 char 7 count 670,660">(let ([dest </span><span class=pc2 title="line 415 char 19 count 670,660">(</span><span class=pc2 title="line 415 char 20 count 670,660">fx+</span><span class=pc2 title="line 415 char 19 count 670,660"> </span><span class=pc2 title="line 415 char 24 count 670,660">dest</span><span class=pc2 title="line 415 char 19 count 670,660"> </span><span class=pc2 title="line 415 char 29 count 670,660">1</span><span class=pc2 title="line 415 char 19 count 670,660">)</span><span class=pc2 title="line 415 char 7 count 670,660">]</span>
            <span class=pc2 title="line 415 char 7 count 670,660">[cur2 </span><span class=pc2 title="line 416 char 19 count 670,660">(</span><span class=pc2 title="line 416 char 20 count 670,660">fx+</span><span class=pc2 title="line 416 char 19 count 670,660"> </span><span class=pc2 title="line 416 char 24 count 670,660">cur2</span><span class=pc2 title="line 416 char 19 count 670,660"> </span><span class=pc2 title="line 416 char 29 count 670,660">1</span><span class=pc2 title="line 416 char 19 count 670,660">)</span><span class=pc2 title="line 415 char 7 count 670,660">]</span>
            <span class=pc2 title="line 415 char 7 count 670,660">[len2 </span><span class=pc2 title="line 417 char 19 count 670,660">(</span><span class=pc2 title="line 417 char 20 count 670,660">fx-</span><span class=pc2 title="line 417 char 19 count 670,660"> </span><span class=pc2 title="line 417 char 24 count 670,660">len2</span><span class=pc2 title="line 417 char 19 count 670,660"> </span><span class=pc2 title="line 417 char 29 count 670,660">1</span><span class=pc2 title="line 417 char 19 count 670,660">)</span><span class=pc2 title="line 415 char 7 count 670,660">])</span>
        <span class=pc2 title="line 418 char 9 count 670,660">(cond</span>
          <span class=pc2 title="line 418 char 9 count 670,660">[</span><span class=pc2 title="line 419 char 12 count 670,660">(</span><span class=pc2 title="line 419 char 13 count 670,660">fx=</span><span class=pc2 title="line 419 char 12 count 670,660"> </span><span class=pc2 title="line 419 char 17 count 670,660">len2</span><span class=pc2 title="line 419 char 12 count 670,660"> </span><span class=pc2 title="line 419 char 22 count 670,660">0</span><span class=pc2 title="line 419 char 12 count 670,660">)</span><span class=pc2 title="line 418 char 9 count 670,660"> </span><span class=pc1 title="line 419 char 25 count 0">(</span><span class=pc1 title="line 419 char 26 count 0">vector-copy!</span><span class=pc1 title="line 419 char 25 count 0"> </span><span class=pc1 title="line 419 char 39 count 0">tmp-array</span><span class=pc1 title="line 419 char 25 count 0"> </span><span class=pc1 title="line 419 char 49 count 0">cur1</span><span class=pc1 title="line 419 char 25 count 0"> </span><span class=pc1 title="line 419 char 54 count 0">v</span><span class=pc1 title="line 419 char 25 count 0"> </span><span class=pc1 title="line 419 char 56 count 0">dest</span><span class=pc1 title="line 419 char 25 count 0"> </span><span class=pc1 title="line 419 char 61 count 0">len1</span><span class=pc1 title="line 419 char 25 count 0">)</span><span class=pc2 title="line 418 char 9 count 670,660">]</span>
          <span class=pc2 title="line 418 char 9 count 670,660">[</span><span class=pc2 title="line 420 char 12 count 670,660">(</span><span class=pc2 title="line 420 char 13 count 670,660">fx=</span><span class=pc2 title="line 420 char 12 count 670,660"> </span><span class=pc2 title="line 420 char 17 count 670,660">len1</span><span class=pc2 title="line 420 char 12 count 670,660"> </span><span class=pc2 title="line 420 char 22 count 670,660">1</span><span class=pc2 title="line 420 char 12 count 670,660">)</span>
           <span class=pc1 title="line 421 char 12 count 0">(</span><span class=pc1 title="line 421 char 13 count 0">vector-copy!</span><span class=pc1 title="line 421 char 12 count 0"> </span><span class=pc1 title="line 421 char 26 count 0">v</span><span class=pc1 title="line 421 char 12 count 0"> </span><span class=pc1 title="line 421 char 28 count 0">cur2</span><span class=pc1 title="line 421 char 12 count 0"> </span><span class=pc1 title="line 421 char 33 count 0">v</span><span class=pc1 title="line 421 char 12 count 0"> </span><span class=pc1 title="line 421 char 35 count 0">dest</span><span class=pc1 title="line 421 char 12 count 0"> </span><span class=pc1 title="line 421 char 40 count 0">len2</span><span class=pc1 title="line 421 char 12 count 0">)</span>
           <span class=pc1 title="line 422 char 12 count 0">(v-set! </span><span class=pc1 title="line 422 char 20 count 0">(</span><span class=pc1 title="line 422 char 21 count 0">fx+</span><span class=pc1 title="line 422 char 20 count 0"> </span><span class=pc1 title="line 422 char 25 count 0">dest</span><span class=pc1 title="line 422 char 20 count 0"> </span><span class=pc1 title="line 422 char 30 count 0">len2</span><span class=pc1 title="line 422 char 20 count 0">)</span><span class=pc1 title="line 422 char 12 count 0"> </span><span class=pc1 title="line 422 char 36 count 0">(t-get </span><span class=pc1 title="line 422 char 43 count 0">cur1</span><span class=pc1 title="line 422 char 36 count 0">)</span><span class=pc1 title="line 422 char 12 count 0">)</span><span class=pc2 title="line 418 char 9 count 670,660">]</span>
          <span class=pc2 title="line 418 char 9 count 670,660">[else </span><span class=pc2 title="line 423 char 17 count 670,660">(</span><span class=pc2 title="line 423 char 18 count 670,660">do-while1</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 28 count 670,660">0</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 30 count 670,660">0</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 32 count 670,660">cur1</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 37 count 670,660">cur2</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 42 count 670,660">dest</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 47 count 670,660">len1</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 52 count 670,660">len2</span><span class=pc2 title="line 423 char 17 count 670,660"> </span><span class=pc2 title="line 423 char 57 count 670,660">min-gallop</span><span class=pc2 title="line 423 char 17 count 670,660">)</span><span class=pc2 title="line 418 char 9 count 670,660">])</span><span class=pc2 title="line 415 char 7 count 670,660">)</span><span class=pc2 title="line 413 char 5 count 670,660">)</span><span class=pc2 title="line 317 char 3 count 12">)</span>

  <span class=pc2 title="line 425 char 3 count 12">(define (merge-hi base1 len1 base2 len2)</span>
    <span class=pc2 title="line 426 char 5 count 329,338">(define (do-while1 cnt1 cnt2 cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc6 title="line 427 char 7 count 160,244,206">(do-assert (and (fx&gt; len1 0) (fx&gt; len2 1)))</span>
      <span class=pc6 title="line 428 char 7 count 160,244,206">(cond</span>
        <span class=pc6 title="line 428 char 7 count 160,244,206">[</span><span class=pc6 title="line 429 char 10 count 160,244,206">(</span><span class=pc6 title="line 429 char 11 count 160,244,206">lt?</span><span class=pc6 title="line 429 char 10 count 160,244,206"> </span><span class=pc6 title="line 429 char 15 count 160,244,206">(t-get </span><span class=pc6 title="line 429 char 22 count 160,244,206">cur2</span><span class=pc6 title="line 429 char 15 count 160,244,206">)</span><span class=pc6 title="line 429 char 10 count 160,244,206"> </span><span class=pc6 title="line 429 char 28 count 160,244,206">(v-get </span><span class=pc6 title="line 429 char 35 count 160,244,206">cur1</span><span class=pc6 title="line 429 char 28 count 160,244,206">)</span><span class=pc6 title="line 429 char 10 count 160,244,206">)</span>
         <span class=pc4 title="line 430 char 10 count 82,363,482">(v-set! </span><span class=pc4 title="line 430 char 18 count 82,363,482">dest</span><span class=pc4 title="line 430 char 10 count 82,363,482"> </span><span class=pc4 title="line 430 char 23 count 82,363,482">(v-get </span><span class=pc4 title="line 430 char 30 count 82,363,482">cur1</span><span class=pc4 title="line 430 char 23 count 82,363,482">)</span><span class=pc4 title="line 430 char 10 count 82,363,482">)</span>
         <span class=pc4 title="line 431 char 10 count 82,363,482">(let ([dest </span><span class=pc4 title="line 431 char 22 count 82,363,482">(</span><span class=pc4 title="line 431 char 23 count 82,363,482">fx-</span><span class=pc4 title="line 431 char 22 count 82,363,482"> </span><span class=pc4 title="line 431 char 27 count 82,363,482">dest</span><span class=pc4 title="line 431 char 22 count 82,363,482"> </span><span class=pc4 title="line 431 char 32 count 82,363,482">1</span><span class=pc4 title="line 431 char 22 count 82,363,482">)</span><span class=pc4 title="line 431 char 10 count 82,363,482">]</span>
               <span class=pc4 title="line 431 char 10 count 82,363,482">[cur1 </span><span class=pc4 title="line 432 char 22 count 82,363,482">(</span><span class=pc4 title="line 432 char 23 count 82,363,482">fx-</span><span class=pc4 title="line 432 char 22 count 82,363,482"> </span><span class=pc4 title="line 432 char 27 count 82,363,482">cur1</span><span class=pc4 title="line 432 char 22 count 82,363,482"> </span><span class=pc4 title="line 432 char 32 count 82,363,482">1</span><span class=pc4 title="line 432 char 22 count 82,363,482">)</span><span class=pc4 title="line 431 char 10 count 82,363,482">]</span>
               <span class=pc4 title="line 431 char 10 count 82,363,482">[len1 </span><span class=pc4 title="line 433 char 22 count 82,363,482">(</span><span class=pc4 title="line 433 char 23 count 82,363,482">fx-</span><span class=pc4 title="line 433 char 22 count 82,363,482"> </span><span class=pc4 title="line 433 char 27 count 82,363,482">len1</span><span class=pc4 title="line 433 char 22 count 82,363,482"> </span><span class=pc4 title="line 433 char 32 count 82,363,482">1</span><span class=pc4 title="line 433 char 22 count 82,363,482">)</span><span class=pc4 title="line 431 char 10 count 82,363,482">])</span>
           <span class=pc4 title="line 434 char 12 count 82,363,482">(if </span><span class=pc4 title="line 434 char 16 count 82,363,482">(</span><span class=pc4 title="line 434 char 17 count 82,363,482">fx=</span><span class=pc4 title="line 434 char 16 count 82,363,482"> </span><span class=pc4 title="line 434 char 21 count 82,363,482">len1</span><span class=pc4 title="line 434 char 16 count 82,363,482"> </span><span class=pc4 title="line 434 char 26 count 82,363,482">0</span><span class=pc4 title="line 434 char 16 count 82,363,482">)</span>
               <span class=pc2 title="line 435 char 16 count 159,134">(</span><span class=pc2 title="line 435 char 17 count 159,134">break</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 23 count 159,134">cur1</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 28 count 159,134">cur2</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 33 count 159,134">dest</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 38 count 159,134">len1</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 43 count 159,134">len2</span><span class=pc2 title="line 435 char 16 count 159,134"> </span><span class=pc2 title="line 435 char 48 count 159,134">mgp</span><span class=pc2 title="line 435 char 16 count 159,134">)</span>
               <span class=pc4 title="line 436 char 16 count 82,204,348">(let ([cnt1 </span><span class=pc4 title="line 436 char 28 count 82,204,348">(</span><span class=pc4 title="line 436 char 29 count 82,204,348">fx+</span><span class=pc4 title="line 436 char 28 count 82,204,348"> </span><span class=pc4 title="line 436 char 33 count 82,204,348">cnt1</span><span class=pc4 title="line 436 char 28 count 82,204,348"> </span><span class=pc4 title="line 436 char 38 count 82,204,348">1</span><span class=pc4 title="line 436 char 28 count 82,204,348">)</span><span class=pc4 title="line 436 char 16 count 82,204,348">][cnt2 </span><span class=pc4 title="line 436 char 47 count 82,204,348">0</span><span class=pc4 title="line 436 char 16 count 82,204,348">])</span>
                 <span class=pc4 title="line 437 char 18 count 82,204,348">(if </span><span class=pc4 title="line 437 char 22 count 82,204,348">(</span><span class=pc4 title="line 437 char 23 count 82,204,348">fx&lt;</span><span class=pc4 title="line 437 char 22 count 82,204,348"> </span><span class=pc4 title="line 437 char 27 count 82,204,348">(</span><span class=pc4 title="line 437 char 28 count 82,204,348">fxlogor</span><span class=pc4 title="line 437 char 27 count 82,204,348"> </span><span class=pc4 title="line 437 char 36 count 82,204,348">cnt1</span><span class=pc4 title="line 437 char 27 count 82,204,348"> </span><span class=pc4 title="line 437 char 41 count 82,204,348">cnt2</span><span class=pc4 title="line 437 char 27 count 82,204,348">)</span><span class=pc4 title="line 437 char 22 count 82,204,348"> </span><span class=pc4 title="line 437 char 47 count 82,204,348">mgp</span><span class=pc4 title="line 437 char 22 count 82,204,348">)</span>
                     <span class=pc4 title="line 438 char 22 count 82,201,900">(</span><span class=pc4 title="line 438 char 23 count 82,201,900">do-while1</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 33 count 82,201,900">cnt1</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 38 count 82,201,900">cnt2</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 43 count 82,201,900">cur1</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 48 count 82,201,900">cur2</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 53 count 82,201,900">dest</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 58 count 82,201,900">len1</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 63 count 82,201,900">len2</span><span class=pc4 title="line 438 char 22 count 82,201,900"> </span><span class=pc4 title="line 438 char 68 count 82,201,900">mgp</span><span class=pc4 title="line 438 char 22 count 82,201,900">)</span>
                     <span class=pc2 title="line 439 char 22 count 2,448">(</span><span class=pc2 title="line 439 char 23 count 2,448">do-while2</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 33 count 2,448">cur1</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 38 count 2,448">cur2</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 43 count 2,448">dest</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 48 count 2,448">len1</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 53 count 2,448">len2</span><span class=pc2 title="line 439 char 22 count 2,448"> </span><span class=pc2 title="line 439 char 58 count 2,448">mgp</span><span class=pc2 title="line 439 char 22 count 2,448">)</span><span class=pc4 title="line 437 char 18 count 82,204,348">)</span><span class=pc4 title="line 436 char 16 count 82,204,348">)</span><span class=pc4 title="line 434 char 12 count 82,363,482">)</span><span class=pc4 title="line 431 char 10 count 82,363,482">)</span><span class=pc6 title="line 428 char 7 count 160,244,206">]</span>
        <span class=pc6 title="line 428 char 7 count 160,244,206">[else</span>
         <span class=pc4 title="line 441 char 10 count 77,880,724">(v-set! </span><span class=pc4 title="line 441 char 18 count 77,880,724">dest</span><span class=pc4 title="line 441 char 10 count 77,880,724"> </span><span class=pc4 title="line 441 char 23 count 77,880,724">(t-get </span><span class=pc4 title="line 441 char 30 count 77,880,724">cur2</span><span class=pc4 title="line 441 char 23 count 77,880,724">)</span><span class=pc4 title="line 441 char 10 count 77,880,724">)</span>
         <span class=pc4 title="line 442 char 10 count 77,880,724">(let ([dest </span><span class=pc4 title="line 442 char 22 count 77,880,724">(</span><span class=pc4 title="line 442 char 23 count 77,880,724">fx-</span><span class=pc4 title="line 442 char 22 count 77,880,724"> </span><span class=pc4 title="line 442 char 27 count 77,880,724">dest</span><span class=pc4 title="line 442 char 22 count 77,880,724"> </span><span class=pc4 title="line 442 char 32 count 77,880,724">1</span><span class=pc4 title="line 442 char 22 count 77,880,724">)</span><span class=pc4 title="line 442 char 10 count 77,880,724">]</span>
               <span class=pc4 title="line 442 char 10 count 77,880,724">[cur2 </span><span class=pc4 title="line 443 char 22 count 77,880,724">(</span><span class=pc4 title="line 443 char 23 count 77,880,724">fx-</span><span class=pc4 title="line 443 char 22 count 77,880,724"> </span><span class=pc4 title="line 443 char 27 count 77,880,724">cur2</span><span class=pc4 title="line 443 char 22 count 77,880,724"> </span><span class=pc4 title="line 443 char 32 count 77,880,724">1</span><span class=pc4 title="line 443 char 22 count 77,880,724">)</span><span class=pc4 title="line 442 char 10 count 77,880,724">]</span>
               <span class=pc4 title="line 442 char 10 count 77,880,724">[len2 </span><span class=pc4 title="line 444 char 22 count 77,880,724">(</span><span class=pc4 title="line 444 char 23 count 77,880,724">fx-</span><span class=pc4 title="line 444 char 22 count 77,880,724"> </span><span class=pc4 title="line 444 char 27 count 77,880,724">len2</span><span class=pc4 title="line 444 char 22 count 77,880,724"> </span><span class=pc4 title="line 444 char 32 count 77,880,724">1</span><span class=pc4 title="line 444 char 22 count 77,880,724">)</span><span class=pc4 title="line 442 char 10 count 77,880,724">])</span>
           <span class=pc4 title="line 445 char 12 count 77,880,724">(if </span><span class=pc4 title="line 445 char 16 count 77,880,724">(</span><span class=pc4 title="line 445 char 17 count 77,880,724">fx=</span><span class=pc4 title="line 445 char 16 count 77,880,724"> </span><span class=pc4 title="line 445 char 21 count 77,880,724">len2</span><span class=pc4 title="line 445 char 16 count 77,880,724"> </span><span class=pc4 title="line 445 char 26 count 77,880,724">1</span><span class=pc4 title="line 445 char 16 count 77,880,724">)</span>
               <span class=pc2 title="line 446 char 16 count 170,202">(</span><span class=pc2 title="line 446 char 17 count 170,202">break</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 23 count 170,202">cur1</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 28 count 170,202">cur2</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 33 count 170,202">dest</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 38 count 170,202">len1</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 43 count 170,202">len2</span><span class=pc2 title="line 446 char 16 count 170,202"> </span><span class=pc2 title="line 446 char 48 count 170,202">mgp</span><span class=pc2 title="line 446 char 16 count 170,202">)</span>
               <span class=pc4 title="line 447 char 16 count 77,710,522">(let ([cnt2 </span><span class=pc4 title="line 447 char 28 count 77,710,522">(</span><span class=pc4 title="line 447 char 29 count 77,710,522">fx+</span><span class=pc4 title="line 447 char 28 count 77,710,522"> </span><span class=pc4 title="line 447 char 33 count 77,710,522">cnt2</span><span class=pc4 title="line 447 char 28 count 77,710,522"> </span><span class=pc4 title="line 447 char 38 count 77,710,522">1</span><span class=pc4 title="line 447 char 28 count 77,710,522">)</span><span class=pc4 title="line 447 char 16 count 77,710,522">][cnt1 </span><span class=pc4 title="line 447 char 47 count 77,710,522">0</span><span class=pc4 title="line 447 char 16 count 77,710,522">])</span>
                 <span class=pc4 title="line 448 char 18 count 77,710,522">(if </span><span class=pc4 title="line 448 char 22 count 77,710,522">(</span><span class=pc4 title="line 448 char 23 count 77,710,522">fx&lt;</span><span class=pc4 title="line 448 char 22 count 77,710,522"> </span><span class=pc4 title="line 448 char 27 count 77,710,522">(</span><span class=pc4 title="line 448 char 28 count 77,710,522">fxlogor</span><span class=pc4 title="line 448 char 27 count 77,710,522"> </span><span class=pc4 title="line 448 char 36 count 77,710,522">cnt1</span><span class=pc4 title="line 448 char 27 count 77,710,522"> </span><span class=pc4 title="line 448 char 41 count 77,710,522">cnt2</span><span class=pc4 title="line 448 char 27 count 77,710,522">)</span><span class=pc4 title="line 448 char 22 count 77,710,522"> </span><span class=pc4 title="line 448 char 47 count 77,710,522">mgp</span><span class=pc4 title="line 448 char 22 count 77,710,522">)</span>
                     <span class=pc4 title="line 449 char 22 count 77,710,518">(</span><span class=pc4 title="line 449 char 23 count 77,710,518">do-while1</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 33 count 77,710,518">cnt1</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 38 count 77,710,518">cnt2</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 43 count 77,710,518">cur1</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 48 count 77,710,518">cur2</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 53 count 77,710,518">dest</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 58 count 77,710,518">len1</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 63 count 77,710,518">len2</span><span class=pc4 title="line 449 char 22 count 77,710,518"> </span><span class=pc4 title="line 449 char 68 count 77,710,518">mgp</span><span class=pc4 title="line 449 char 22 count 77,710,518">)</span>
                     <span class=pc2 title="line 450 char 22 count 4">(</span><span class=pc2 title="line 450 char 23 count 4">do-while2</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 33 count 4">cur1</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 38 count 4">cur2</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 43 count 4">dest</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 48 count 4">len1</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 53 count 4">len2</span><span class=pc2 title="line 450 char 22 count 4"> </span><span class=pc2 title="line 450 char 58 count 4">mgp</span><span class=pc2 title="line 450 char 22 count 4">)</span><span class=pc4 title="line 448 char 18 count 77,710,522">)</span><span class=pc4 title="line 447 char 16 count 77,710,522">)</span><span class=pc4 title="line 445 char 12 count 77,880,724">)</span><span class=pc4 title="line 442 char 10 count 77,880,724">)</span><span class=pc6 title="line 428 char 7 count 160,244,206">])</span><span class=pc2 title="line 426 char 5 count 329,338">)</span>

    <span class=pc2 title="line 452 char 5 count 329,338">(define (do-while2 cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc2 title="line 453 char 7 count 11,138">(define (continue1 cnt1 cur1 cur2 dest len1 len2 mgp)</span>
        <span class=pc2 title="line 454 char 9 count 11,138">(v-set! </span><span class=pc2 title="line 454 char 17 count 11,138">dest</span><span class=pc2 title="line 454 char 9 count 11,138"> </span><span class=pc2 title="line 454 char 22 count 11,138">(t-get </span><span class=pc2 title="line 454 char 29 count 11,138">cur2</span><span class=pc2 title="line 454 char 22 count 11,138">)</span><span class=pc2 title="line 454 char 9 count 11,138">)</span>
        <span class=pc2 title="line 455 char 9 count 11,138">(let ([dest </span><span class=pc2 title="line 455 char 21 count 11,138">(</span><span class=pc2 title="line 455 char 22 count 11,138">fx-</span><span class=pc2 title="line 455 char 21 count 11,138"> </span><span class=pc2 title="line 455 char 26 count 11,138">dest</span><span class=pc2 title="line 455 char 21 count 11,138"> </span><span class=pc2 title="line 455 char 31 count 11,138">1</span><span class=pc2 title="line 455 char 21 count 11,138">)</span><span class=pc2 title="line 455 char 9 count 11,138">]</span>
              <span class=pc2 title="line 455 char 9 count 11,138">[cur2 </span><span class=pc2 title="line 456 char 21 count 11,138">(</span><span class=pc2 title="line 456 char 22 count 11,138">fx-</span><span class=pc2 title="line 456 char 21 count 11,138"> </span><span class=pc2 title="line 456 char 26 count 11,138">cur2</span><span class=pc2 title="line 456 char 21 count 11,138"> </span><span class=pc2 title="line 456 char 31 count 11,138">1</span><span class=pc2 title="line 456 char 21 count 11,138">)</span><span class=pc2 title="line 455 char 9 count 11,138">]</span>
              <span class=pc2 title="line 455 char 9 count 11,138">[len2 </span><span class=pc2 title="line 457 char 21 count 11,138">(</span><span class=pc2 title="line 457 char 22 count 11,138">fx-</span><span class=pc2 title="line 457 char 21 count 11,138"> </span><span class=pc2 title="line 457 char 26 count 11,138">len2</span><span class=pc2 title="line 457 char 21 count 11,138"> </span><span class=pc2 title="line 457 char 31 count 11,138">1</span><span class=pc2 title="line 457 char 21 count 11,138">)</span><span class=pc2 title="line 455 char 9 count 11,138">])</span>
          <span class=pc2 title="line 458 char 11 count 11,138">(if </span><span class=pc2 title="line 458 char 15 count 11,138">(</span><span class=pc2 title="line 458 char 16 count 11,138">fx=</span><span class=pc2 title="line 458 char 15 count 11,138"> </span><span class=pc2 title="line 458 char 20 count 11,138">len2</span><span class=pc2 title="line 458 char 15 count 11,138"> </span><span class=pc2 title="line 458 char 25 count 11,138">1</span><span class=pc2 title="line 458 char 15 count 11,138">)</span>
              <span class=pc2 title="line 459 char 15 count 2">(</span><span class=pc2 title="line 459 char 16 count 2">break</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 22 count 2">cur1</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 27 count 2">cur2</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 32 count 2">dest</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 37 count 2">len1</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 42 count 2">len2</span><span class=pc2 title="line 459 char 15 count 2"> </span><span class=pc2 title="line 459 char 47 count 2">mgp</span><span class=pc2 title="line 459 char 15 count 2">)</span>
              <span class=pc2 title="line 460 char 15 count 11,136">(let ([cnt2 </span><span class=pc2 title="line 460 char 27 count 11,136">(</span><span class=pc2 title="line 460 char 28 count 11,136">fx-</span><span class=pc2 title="line 460 char 27 count 11,136"> </span><span class=pc2 title="line 460 char 32 count 11,136">len2</span><span class=pc2 title="line 460 char 27 count 11,136"> </span><span class=pc2 title="line 460 char 37 count 11,136">(</span><span class=pc2 title="line 460 char 38 count 11,136">gallop-left</span><span class=pc2 title="line 460 char 37 count 11,136"> </span><span class=pc2 title="line 460 char 50 count 11,136">(v-get </span><span class=pc2 title="line 460 char 57 count 11,136">cur1</span><span class=pc2 title="line 460 char 50 count 11,136">)</span><span class=pc2 title="line 460 char 37 count 11,136"> </span><span class=pc2 title="line 460 char 63 count 11,136">tmp-array</span><span class=pc2 title="line 460 char 37 count 11,136"> </span><span class=pc2 title="line 460 char 73 count 11,136">0</span><span class=pc2 title="line 460 char 37 count 11,136"> </span><span class=pc2 title="line 460 char 75 count 11,136">len2</span><span class=pc2 title="line 460 char 37 count 11,136"> </span><span class=pc2 title="line 460 char 80 count 11,136">(</span><span class=pc2 title="line 460 char 81 count 11,136">fx-</span><span class=pc2 title="line 460 char 80 count 11,136"> </span><span class=pc2 title="line 460 char 85 count 11,136">len2</span><span class=pc2 title="line 460 char 80 count 11,136"> </span><span class=pc2 title="line 460 char 90 count 11,136">1</span><span class=pc2 title="line 460 char 80 count 11,136">)</span><span class=pc2 title="line 460 char 37 count 11,136">)</span><span class=pc2 title="line 460 char 27 count 11,136">)</span><span class=pc2 title="line 460 char 15 count 11,136">])</span>
                <span class=pc2 title="line 461 char 17 count 11,136">(if </span><span class=pc2 title="line 461 char 21 count 11,136">(</span><span class=pc2 title="line 461 char 22 count 11,136">not</span><span class=pc2 title="line 461 char 21 count 11,136"> </span><span class=pc2 title="line 461 char 26 count 11,136">(</span><span class=pc2 title="line 461 char 27 count 11,136">fx=</span><span class=pc2 title="line 461 char 26 count 11,136"> </span><span class=pc2 title="line 461 char 31 count 11,136">cnt2</span><span class=pc2 title="line 461 char 26 count 11,136"> </span><span class=pc2 title="line 461 char 36 count 11,136">0</span><span class=pc2 title="line 461 char 26 count 11,136">)</span><span class=pc2 title="line 461 char 21 count 11,136">)</span>
                    <span class=pc2 title="line 462 char 21 count 432">(let ([dest </span><span class=pc2 title="line 462 char 33 count 432">(</span><span class=pc2 title="line 462 char 34 count 432">fx-</span><span class=pc2 title="line 462 char 33 count 432"> </span><span class=pc2 title="line 462 char 38 count 432">dest</span><span class=pc2 title="line 462 char 33 count 432"> </span><span class=pc2 title="line 462 char 43 count 432">cnt2</span><span class=pc2 title="line 462 char 33 count 432">)</span><span class=pc2 title="line 462 char 21 count 432">]</span>
                          <span class=pc2 title="line 462 char 21 count 432">[cur2 </span><span class=pc2 title="line 463 char 33 count 432">(</span><span class=pc2 title="line 463 char 34 count 432">fx-</span><span class=pc2 title="line 463 char 33 count 432"> </span><span class=pc2 title="line 463 char 38 count 432">cur2</span><span class=pc2 title="line 463 char 33 count 432"> </span><span class=pc2 title="line 463 char 43 count 432">cnt2</span><span class=pc2 title="line 463 char 33 count 432">)</span><span class=pc2 title="line 462 char 21 count 432">]</span>
                          <span class=pc2 title="line 462 char 21 count 432">[len2 </span><span class=pc2 title="line 464 char 33 count 432">(</span><span class=pc2 title="line 464 char 34 count 432">fx-</span><span class=pc2 title="line 464 char 33 count 432"> </span><span class=pc2 title="line 464 char 38 count 432">len2</span><span class=pc2 title="line 464 char 33 count 432"> </span><span class=pc2 title="line 464 char 43 count 432">cnt2</span><span class=pc2 title="line 464 char 33 count 432">)</span><span class=pc2 title="line 462 char 21 count 432">])</span>
                      <span class=pc2 title="line 465 char 23 count 432">(</span><span class=pc2 title="line 465 char 24 count 432">vector-copy!</span><span class=pc2 title="line 465 char 23 count 432"> </span><span class=pc2 title="line 465 char 37 count 432">tmp-array</span><span class=pc2 title="line 465 char 23 count 432"> </span><span class=pc2 title="line 465 char 47 count 432">(</span><span class=pc2 title="line 465 char 48 count 432">fx+</span><span class=pc2 title="line 465 char 47 count 432"> </span><span class=pc2 title="line 465 char 52 count 432">cur2</span><span class=pc2 title="line 465 char 47 count 432"> </span><span class=pc2 title="line 465 char 57 count 432">1</span><span class=pc2 title="line 465 char 47 count 432">)</span><span class=pc2 title="line 465 char 23 count 432"> </span><span class=pc2 title="line 465 char 60 count 432">v</span><span class=pc2 title="line 465 char 23 count 432"> </span><span class=pc2 title="line 465 char 62 count 432">(</span><span class=pc2 title="line 465 char 63 count 432">fx+</span><span class=pc2 title="line 465 char 62 count 432"> </span><span class=pc2 title="line 465 char 67 count 432">dest</span><span class=pc2 title="line 465 char 62 count 432"> </span><span class=pc2 title="line 465 char 72 count 432">1</span><span class=pc2 title="line 465 char 62 count 432">)</span><span class=pc2 title="line 465 char 23 count 432"> </span><span class=pc2 title="line 465 char 75 count 432">cnt2</span><span class=pc2 title="line 465 char 23 count 432">)</span>
                      <span class=pc2 title="line 466 char 23 count 432">(if </span><span class=pc2 title="line 466 char 27 count 432">(</span><span class=pc2 title="line 466 char 28 count 432">fx&lt;=</span><span class=pc2 title="line 466 char 27 count 432"> </span><span class=pc2 title="line 466 char 33 count 432">len2</span><span class=pc2 title="line 466 char 27 count 432"> </span><span class=pc2 title="line 466 char 38 count 432">1</span><span class=pc2 title="line 466 char 27 count 432">)</span>
                          <span class=pc1 title="line 467 char 27 count 0">(</span><span class=pc1 title="line 467 char 28 count 0">break</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 34 count 0">cur1</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 39 count 0">cur2</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 44 count 0">dest</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 49 count 0">len1</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 54 count 0">len2</span><span class=pc1 title="line 467 char 27 count 0"> </span><span class=pc1 title="line 467 char 59 count 0">mgp</span><span class=pc1 title="line 467 char 27 count 0">)</span>
                          <span class=pc2 title="line 468 char 27 count 432">(</span><span class=pc2 title="line 468 char 28 count 432">continue2</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 38 count 432">cnt1</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 43 count 432">cnt2</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 48 count 432">cur1</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 53 count 432">cur2</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 58 count 432">dest</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 63 count 432">len1</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 68 count 432">len2</span><span class=pc2 title="line 468 char 27 count 432"> </span><span class=pc2 title="line 468 char 73 count 432">mgp</span><span class=pc2 title="line 468 char 27 count 432">)</span><span class=pc2 title="line 466 char 23 count 432">)</span><span class=pc2 title="line 462 char 21 count 432">)</span>
                    <span class=pc2 title="line 469 char 21 count 10,704">(</span><span class=pc2 title="line 469 char 22 count 10,704">continue2</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 32 count 10,704">cnt1</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 37 count 10,704">cnt2</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 42 count 10,704">cur1</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 47 count 10,704">cur2</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 52 count 10,704">dest</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 57 count 10,704">len1</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 62 count 10,704">len2</span><span class=pc2 title="line 469 char 21 count 10,704"> </span><span class=pc2 title="line 469 char 67 count 10,704">mgp</span><span class=pc2 title="line 469 char 21 count 10,704">)</span><span class=pc2 title="line 461 char 17 count 11,136">)</span><span class=pc2 title="line 460 char 15 count 11,136">)</span><span class=pc2 title="line 458 char 11 count 11,138">)</span><span class=pc2 title="line 455 char 9 count 11,138">)</span><span class=pc2 title="line 453 char 7 count 11,138">)</span>
      <span class=pc2 title="line 470 char 7 count 11,138">(define (continue2 cnt1 cnt2 cur1 cur2 dest len1 len2 mgp)</span>
        <span class=pc2 title="line 471 char 9 count 11,136">(v-set! </span><span class=pc2 title="line 471 char 17 count 11,136">dest</span><span class=pc2 title="line 471 char 9 count 11,136"> </span><span class=pc2 title="line 471 char 22 count 11,136">(v-get </span><span class=pc2 title="line 471 char 29 count 11,136">cur1</span><span class=pc2 title="line 471 char 22 count 11,136">)</span><span class=pc2 title="line 471 char 9 count 11,136">)</span>
        <span class=pc2 title="line 472 char 9 count 11,136">(let ([dest </span><span class=pc2 title="line 472 char 21 count 11,136">(</span><span class=pc2 title="line 472 char 22 count 11,136">fx-</span><span class=pc2 title="line 472 char 21 count 11,136"> </span><span class=pc2 title="line 472 char 26 count 11,136">dest</span><span class=pc2 title="line 472 char 21 count 11,136"> </span><span class=pc2 title="line 472 char 31 count 11,136">1</span><span class=pc2 title="line 472 char 21 count 11,136">)</span><span class=pc2 title="line 472 char 9 count 11,136">]</span>
              <span class=pc2 title="line 472 char 9 count 11,136">[cur1 </span><span class=pc2 title="line 473 char 21 count 11,136">(</span><span class=pc2 title="line 473 char 22 count 11,136">fx-</span><span class=pc2 title="line 473 char 21 count 11,136"> </span><span class=pc2 title="line 473 char 26 count 11,136">cur1</span><span class=pc2 title="line 473 char 21 count 11,136"> </span><span class=pc2 title="line 473 char 31 count 11,136">1</span><span class=pc2 title="line 473 char 21 count 11,136">)</span><span class=pc2 title="line 472 char 9 count 11,136">]</span>
              <span class=pc2 title="line 472 char 9 count 11,136">[len1 </span><span class=pc2 title="line 474 char 21 count 11,136">(</span><span class=pc2 title="line 474 char 22 count 11,136">fx-</span><span class=pc2 title="line 474 char 21 count 11,136"> </span><span class=pc2 title="line 474 char 26 count 11,136">len1</span><span class=pc2 title="line 474 char 21 count 11,136"> </span><span class=pc2 title="line 474 char 31 count 11,136">1</span><span class=pc2 title="line 474 char 21 count 11,136">)</span><span class=pc2 title="line 472 char 9 count 11,136">])</span>
          <span class=pc2 title="line 475 char 11 count 11,136">(if </span><span class=pc2 title="line 475 char 15 count 11,136">(</span><span class=pc2 title="line 475 char 16 count 11,136">fx=</span><span class=pc2 title="line 475 char 15 count 11,136"> </span><span class=pc2 title="line 475 char 20 count 11,136">len1</span><span class=pc2 title="line 475 char 15 count 11,136"> </span><span class=pc2 title="line 475 char 25 count 11,136">0</span><span class=pc2 title="line 475 char 15 count 11,136">)</span>
              <span class=pc1 title="line 476 char 15 count 0">(</span><span class=pc1 title="line 476 char 16 count 0">break</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 22 count 0">cur1</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 27 count 0">cur2</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 32 count 0">dest</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 37 count 0">len1</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 42 count 0">len2</span><span class=pc1 title="line 476 char 15 count 0"> </span><span class=pc1 title="line 476 char 47 count 0">mgp</span><span class=pc1 title="line 476 char 15 count 0">)</span>
              <span class=pc2 title="line 477 char 15 count 11,136">(let ([mgp </span><span class=pc2 title="line 477 char 26 count 11,136">(</span><span class=pc2 title="line 477 char 27 count 11,136">fx-</span><span class=pc2 title="line 477 char 26 count 11,136"> </span><span class=pc2 title="line 477 char 31 count 11,136">mgp</span><span class=pc2 title="line 477 char 26 count 11,136"> </span><span class=pc2 title="line 477 char 35 count 11,136">1</span><span class=pc2 title="line 477 char 26 count 11,136">)</span><span class=pc2 title="line 477 char 15 count 11,136">])</span>
                <span class=pc2 title="line 478 char 17 count 11,136">(if </span><span class=pc2 title="line 478 char 21 count 11,136">(or </span><span class=pc2 title="line 478 char 25 count 11,136">(</span><span class=pc2 title="line 478 char 26 count 11,136">fx&gt;=</span><span class=pc2 title="line 478 char 25 count 11,136"> </span><span class=pc2 title="line 478 char 31 count 11,136">cnt1</span><span class=pc2 title="line 478 char 25 count 11,136"> </span><span class=pc2 title="line 478 char 36 count 11,136">MIN_GALLOP</span><span class=pc2 title="line 478 char 25 count 11,136">)</span>
                        <span class=pc2 title="line 479 char 25 count 2,450">(</span><span class=pc2 title="line 479 char 26 count 2,450">fx&gt;=</span><span class=pc2 title="line 479 char 25 count 2,450"> </span><span class=pc2 title="line 479 char 31 count 2,450">cnt2</span><span class=pc2 title="line 479 char 25 count 2,450"> </span><span class=pc2 title="line 479 char 36 count 2,450">MIN_GALLOP</span><span class=pc2 title="line 479 char 25 count 2,450">)</span><span class=pc2 title="line 478 char 21 count 11,136">)</span>
                    <span class=pc2 title="line 480 char 21 count 8,686">(</span><span class=pc2 title="line 480 char 22 count 8,686">do-while2</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 32 count 8,686">cur1</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 37 count 8,686">cur2</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 42 count 8,686">dest</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 47 count 8,686">len1</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 52 count 8,686">len2</span><span class=pc2 title="line 480 char 21 count 8,686"> </span><span class=pc2 title="line 480 char 57 count 8,686">mgp</span><span class=pc2 title="line 480 char 21 count 8,686">)</span>
                    <span class=pc2 title="line 481 char 21 count 2,450">(let ([mgp </span><span class=pc2 title="line 481 char 32 count 2,450">(if </span><span class=pc2 title="line 481 char 36 count 2,450">(</span><span class=pc2 title="line 481 char 37 count 2,450">fx&lt;</span><span class=pc2 title="line 481 char 36 count 2,450"> </span><span class=pc2 title="line 481 char 41 count 2,450">mgp</span><span class=pc2 title="line 481 char 36 count 2,450"> </span><span class=pc2 title="line 481 char 45 count 2,450">0</span><span class=pc2 title="line 481 char 36 count 2,450">)</span><span class=pc2 title="line 481 char 32 count 2,450"> </span><span class=pc2 title="line 481 char 48 count 1,336">2</span><span class=pc2 title="line 481 char 32 count 2,450"> </span><span class=pc2 title="line 481 char 50 count 1,114">(</span><span class=pc2 title="line 481 char 51 count 1,114">fx+</span><span class=pc2 title="line 481 char 50 count 1,114"> </span><span class=pc2 title="line 481 char 55 count 1,114">mgp</span><span class=pc2 title="line 481 char 50 count 1,114"> </span><span class=pc2 title="line 481 char 59 count 1,114">2</span><span class=pc2 title="line 481 char 50 count 1,114">)</span><span class=pc2 title="line 481 char 32 count 2,450">)</span><span class=pc2 title="line 481 char 21 count 2,450">])</span>
                      <span class=pc2 title="line 482 char 23 count 2,450">(</span><span class=pc2 title="line 482 char 24 count 2,450">do-while1</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 34 count 2,450">0</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 36 count 2,450">0</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 38 count 2,450">cur1</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 43 count 2,450">cur2</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 48 count 2,450">dest</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 53 count 2,450">len1</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 58 count 2,450">len2</span><span class=pc2 title="line 482 char 23 count 2,450"> </span><span class=pc2 title="line 482 char 63 count 2,450">mgp</span><span class=pc2 title="line 482 char 23 count 2,450">)</span><span class=pc2 title="line 481 char 21 count 2,450">)</span><span class=pc2 title="line 478 char 17 count 11,136">)</span><span class=pc2 title="line 477 char 15 count 11,136">)</span><span class=pc2 title="line 475 char 11 count 11,136">)</span><span class=pc2 title="line 472 char 9 count 11,136">)</span><span class=pc2 title="line 470 char 7 count 11,138">)</span>

      <span class=pc2 title="line 484 char 7 count 11,138">(do-assert (and (fx&gt; len1 0) (fx&gt; len2 1)))</span>
      <span class=pc2 title="line 485 char 7 count 11,138">(let ([cnt1 </span><span class=pc2 title="line 485 char 19 count 11,138">(</span><span class=pc2 title="line 485 char 20 count 11,138">fx-</span><span class=pc2 title="line 485 char 19 count 11,138"> </span><span class=pc2 title="line 485 char 24 count 11,138">len1</span><span class=pc2 title="line 485 char 19 count 11,138"> </span><span class=pc2 title="line 485 char 29 count 11,138">(</span><span class=pc2 title="line 485 char 30 count 11,138">gallop-right</span><span class=pc2 title="line 485 char 29 count 11,138"> </span><span class=pc2 title="line 485 char 43 count 11,138">(t-get </span><span class=pc2 title="line 485 char 50 count 11,138">cur2</span><span class=pc2 title="line 485 char 43 count 11,138">)</span><span class=pc2 title="line 485 char 29 count 11,138"> </span><span class=pc2 title="line 485 char 56 count 11,138">v</span><span class=pc2 title="line 485 char 29 count 11,138"> </span><span class=pc2 title="line 485 char 58 count 11,138">base1</span><span class=pc2 title="line 485 char 29 count 11,138"> </span><span class=pc2 title="line 485 char 64 count 11,138">len1</span><span class=pc2 title="line 485 char 29 count 11,138"> </span><span class=pc2 title="line 485 char 69 count 11,138">(</span><span class=pc2 title="line 485 char 70 count 11,138">fx-</span><span class=pc2 title="line 485 char 69 count 11,138"> </span><span class=pc2 title="line 485 char 74 count 11,138">len1</span><span class=pc2 title="line 485 char 69 count 11,138"> </span><span class=pc2 title="line 485 char 79 count 11,138">1</span><span class=pc2 title="line 485 char 69 count 11,138">)</span><span class=pc2 title="line 485 char 29 count 11,138">)</span><span class=pc2 title="line 485 char 19 count 11,138">)</span><span class=pc2 title="line 485 char 7 count 11,138">])</span>
        <span class=pc2 title="line 486 char 9 count 11,138">(if </span><span class=pc2 title="line 486 char 13 count 11,138">(</span><span class=pc2 title="line 486 char 14 count 11,138">not</span><span class=pc2 title="line 486 char 13 count 11,138"> </span><span class=pc2 title="line 486 char 18 count 11,138">(</span><span class=pc2 title="line 486 char 19 count 11,138">fx=</span><span class=pc2 title="line 486 char 18 count 11,138"> </span><span class=pc2 title="line 486 char 23 count 11,138">cnt1</span><span class=pc2 title="line 486 char 18 count 11,138"> </span><span class=pc2 title="line 486 char 28 count 11,138">0</span><span class=pc2 title="line 486 char 18 count 11,138">)</span><span class=pc2 title="line 486 char 13 count 11,138">)</span>
            <span class=pc2 title="line 487 char 13 count 10,696">(let ([dest </span><span class=pc2 title="line 487 char 25 count 10,696">(</span><span class=pc2 title="line 487 char 26 count 10,696">fx-</span><span class=pc2 title="line 487 char 25 count 10,696"> </span><span class=pc2 title="line 487 char 30 count 10,696">dest</span><span class=pc2 title="line 487 char 25 count 10,696"> </span><span class=pc2 title="line 487 char 35 count 10,696">cnt1</span><span class=pc2 title="line 487 char 25 count 10,696">)</span><span class=pc2 title="line 487 char 13 count 10,696">]</span>
                  <span class=pc2 title="line 487 char 13 count 10,696">[cur1 </span><span class=pc2 title="line 488 char 25 count 10,696">(</span><span class=pc2 title="line 488 char 26 count 10,696">fx-</span><span class=pc2 title="line 488 char 25 count 10,696"> </span><span class=pc2 title="line 488 char 30 count 10,696">cur1</span><span class=pc2 title="line 488 char 25 count 10,696"> </span><span class=pc2 title="line 488 char 35 count 10,696">cnt1</span><span class=pc2 title="line 488 char 25 count 10,696">)</span><span class=pc2 title="line 487 char 13 count 10,696">]</span>
                  <span class=pc2 title="line 487 char 13 count 10,696">[len1 </span><span class=pc2 title="line 489 char 25 count 10,696">(</span><span class=pc2 title="line 489 char 26 count 10,696">fx-</span><span class=pc2 title="line 489 char 25 count 10,696"> </span><span class=pc2 title="line 489 char 30 count 10,696">len1</span><span class=pc2 title="line 489 char 25 count 10,696"> </span><span class=pc2 title="line 489 char 35 count 10,696">cnt1</span><span class=pc2 title="line 489 char 25 count 10,696">)</span><span class=pc2 title="line 487 char 13 count 10,696">])</span>
              <span class=pc2 title="line 490 char 15 count 10,696">(</span><span class=pc2 title="line 490 char 16 count 10,696">vector-copy!</span><span class=pc2 title="line 490 char 15 count 10,696"> </span><span class=pc2 title="line 490 char 29 count 10,696">v</span><span class=pc2 title="line 490 char 15 count 10,696"> </span><span class=pc2 title="line 490 char 31 count 10,696">(</span><span class=pc2 title="line 490 char 32 count 10,696">fx+</span><span class=pc2 title="line 490 char 31 count 10,696"> </span><span class=pc2 title="line 490 char 36 count 10,696">cur1</span><span class=pc2 title="line 490 char 31 count 10,696"> </span><span class=pc2 title="line 490 char 41 count 10,696">1</span><span class=pc2 title="line 490 char 31 count 10,696">)</span><span class=pc2 title="line 490 char 15 count 10,696"> </span><span class=pc2 title="line 490 char 44 count 10,696">v</span><span class=pc2 title="line 490 char 15 count 10,696"> </span><span class=pc2 title="line 490 char 46 count 10,696">(</span><span class=pc2 title="line 490 char 47 count 10,696">fx+</span><span class=pc2 title="line 490 char 46 count 10,696"> </span><span class=pc2 title="line 490 char 51 count 10,696">dest</span><span class=pc2 title="line 490 char 46 count 10,696"> </span><span class=pc2 title="line 490 char 56 count 10,696">1</span><span class=pc2 title="line 490 char 46 count 10,696">)</span><span class=pc2 title="line 490 char 15 count 10,696"> </span><span class=pc2 title="line 490 char 59 count 10,696">cnt1</span><span class=pc2 title="line 490 char 15 count 10,696">)</span>
              <span class=pc2 title="line 491 char 15 count 10,696">(if </span><span class=pc2 title="line 491 char 19 count 10,696">(</span><span class=pc2 title="line 491 char 20 count 10,696">fx=</span><span class=pc2 title="line 491 char 19 count 10,696"> </span><span class=pc2 title="line 491 char 24 count 10,696">len1</span><span class=pc2 title="line 491 char 19 count 10,696"> </span><span class=pc2 title="line 491 char 29 count 10,696">0</span><span class=pc2 title="line 491 char 19 count 10,696">)</span>
                  <span class=pc1 title="line 492 char 19 count 0">(</span><span class=pc1 title="line 492 char 20 count 0">break</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 26 count 0">cur1</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 31 count 0">cur2</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 36 count 0">dest</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 41 count 0">len1</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 46 count 0">len2</span><span class=pc1 title="line 492 char 19 count 0"> </span><span class=pc1 title="line 492 char 51 count 0">mgp</span><span class=pc1 title="line 492 char 19 count 0">)</span>
                  <span class=pc2 title="line 493 char 19 count 10,696">(</span><span class=pc2 title="line 493 char 20 count 10,696">continue1</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 30 count 10,696">cnt1</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 35 count 10,696">cur1</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 40 count 10,696">cur2</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 45 count 10,696">dest</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 50 count 10,696">len1</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 55 count 10,696">len2</span><span class=pc2 title="line 493 char 19 count 10,696"> </span><span class=pc2 title="line 493 char 60 count 10,696">mgp</span><span class=pc2 title="line 493 char 19 count 10,696">)</span><span class=pc2 title="line 491 char 15 count 10,696">)</span><span class=pc2 title="line 487 char 13 count 10,696">)</span>
            <span class=pc2 title="line 494 char 13 count 442">(</span><span class=pc2 title="line 494 char 14 count 442">continue1</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 24 count 442">cnt1</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 29 count 442">cur1</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 34 count 442">cur2</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 39 count 442">dest</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 44 count 442">len1</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 49 count 442">len2</span><span class=pc2 title="line 494 char 13 count 442"> </span><span class=pc2 title="line 494 char 54 count 442">mgp</span><span class=pc2 title="line 494 char 13 count 442">)</span><span class=pc2 title="line 486 char 9 count 11,138">)</span><span class=pc2 title="line 485 char 7 count 11,138">)</span><span class=pc2 title="line 452 char 5 count 329,338">)</span>

    <span class=pc2 title="line 496 char 5 count 329,338">(define (break cur1 cur2 dest len1 len2 mgp)</span>
      <span class=pc2 title="line 497 char 7 count 329,338">(set! min-gallop </span><span class=pc2 title="line 497 char 24 count 329,338">(</span><span class=pc2 title="line 497 char 25 count 329,338">max</span><span class=pc2 title="line 497 char 24 count 329,338"> </span><span class=pc2 title="line 497 char 29 count 329,338">1</span><span class=pc2 title="line 497 char 24 count 329,338"> </span><span class=pc2 title="line 497 char 31 count 329,338">mgp</span><span class=pc2 title="line 497 char 24 count 329,338">)</span><span class=pc2 title="line 497 char 7 count 329,338">)</span>
      <span class=pc2 title="line 498 char 7 count 329,338">(cond</span>
        <span class=pc2 title="line 498 char 7 count 329,338">[</span><span class=pc2 title="line 499 char 10 count 329,338">(</span><span class=pc2 title="line 499 char 11 count 329,338">fx=</span><span class=pc2 title="line 499 char 10 count 329,338"> </span><span class=pc2 title="line 499 char 15 count 329,338">len2</span><span class=pc2 title="line 499 char 10 count 329,338"> </span><span class=pc2 title="line 499 char 20 count 329,338">1</span><span class=pc2 title="line 499 char 10 count 329,338">)</span>
         <span class=pc2 title="line 500 char 10 count 170,204">(do-assert (fx&gt; len1 0))</span>
         <span class=pc2 title="line 501 char 10 count 170,204">(let ([dest </span><span class=pc2 title="line 501 char 22 count 170,204">(</span><span class=pc2 title="line 501 char 23 count 170,204">fx-</span><span class=pc2 title="line 501 char 22 count 170,204"> </span><span class=pc2 title="line 501 char 27 count 170,204">dest</span><span class=pc2 title="line 501 char 22 count 170,204"> </span><span class=pc2 title="line 501 char 32 count 170,204">len1</span><span class=pc2 title="line 501 char 22 count 170,204">)</span><span class=pc2 title="line 501 char 10 count 170,204">]</span>
               <span class=pc2 title="line 501 char 10 count 170,204">[cur1 </span><span class=pc2 title="line 502 char 22 count 170,204">(</span><span class=pc2 title="line 502 char 23 count 170,204">fx-</span><span class=pc2 title="line 502 char 22 count 170,204"> </span><span class=pc2 title="line 502 char 27 count 170,204">cur1</span><span class=pc2 title="line 502 char 22 count 170,204"> </span><span class=pc2 title="line 502 char 32 count 170,204">len1</span><span class=pc2 title="line 502 char 22 count 170,204">)</span><span class=pc2 title="line 501 char 10 count 170,204">])</span>
           <span class=pc2 title="line 503 char 12 count 170,204">(</span><span class=pc2 title="line 503 char 13 count 170,204">vector-copy!</span><span class=pc2 title="line 503 char 12 count 170,204"> </span><span class=pc2 title="line 503 char 26 count 170,204">v</span><span class=pc2 title="line 503 char 12 count 170,204"> </span><span class=pc2 title="line 503 char 28 count 170,204">(</span><span class=pc2 title="line 503 char 29 count 170,204">fx+</span><span class=pc2 title="line 503 char 28 count 170,204"> </span><span class=pc2 title="line 503 char 33 count 170,204">cur1</span><span class=pc2 title="line 503 char 28 count 170,204"> </span><span class=pc2 title="line 503 char 38 count 170,204">1</span><span class=pc2 title="line 503 char 28 count 170,204">)</span><span class=pc2 title="line 503 char 12 count 170,204"> </span><span class=pc2 title="line 503 char 41 count 170,204">v</span><span class=pc2 title="line 503 char 12 count 170,204"> </span><span class=pc2 title="line 503 char 43 count 170,204">(</span><span class=pc2 title="line 503 char 44 count 170,204">fx+</span><span class=pc2 title="line 503 char 43 count 170,204"> </span><span class=pc2 title="line 503 char 48 count 170,204">dest</span><span class=pc2 title="line 503 char 43 count 170,204"> </span><span class=pc2 title="line 503 char 53 count 170,204">1</span><span class=pc2 title="line 503 char 43 count 170,204">)</span><span class=pc2 title="line 503 char 12 count 170,204"> </span><span class=pc2 title="line 503 char 56 count 170,204">len1</span><span class=pc2 title="line 503 char 12 count 170,204">)</span>
           <span class=pc2 title="line 504 char 12 count 170,204">(v-set! </span><span class=pc2 title="line 504 char 20 count 170,204">dest</span><span class=pc2 title="line 504 char 12 count 170,204"> </span><span class=pc2 title="line 504 char 25 count 170,204">(t-get </span><span class=pc2 title="line 504 char 32 count 170,204">cur2</span><span class=pc2 title="line 504 char 25 count 170,204">)</span><span class=pc2 title="line 504 char 12 count 170,204">)</span><span class=pc2 title="line 501 char 10 count 170,204">)</span><span class=pc2 title="line 498 char 7 count 329,338">]</span>
        <span class=pc2 title="line 498 char 7 count 329,338">[</span><span class=pc2 title="line 505 char 10 count 159,134">(</span><span class=pc2 title="line 505 char 11 count 159,134">fx=</span><span class=pc2 title="line 505 char 10 count 159,134"> </span><span class=pc2 title="line 505 char 15 count 159,134">len2</span><span class=pc2 title="line 505 char 10 count 159,134"> </span><span class=pc2 title="line 505 char 20 count 159,134">0</span><span class=pc2 title="line 505 char 10 count 159,134">)</span>
         <span class=pc1 title="line 506 char 10 count 0">(</span><span class=pc1 title="line 506 char 11 count 0">error</span><span class=pc1 title="line 506 char 10 count 0"> </span><span class=pc1 title="line 506 char 17 count 0">'merge-hi</span>
                <span class=pc1 title="line 507 char 17 count 0">"Comparison method violates its general contract!"</span><span class=pc1 title="line 506 char 10 count 0">)</span><span class=pc2 title="line 498 char 7 count 329,338">]</span>
        <span class=pc2 title="line 498 char 7 count 329,338">[else</span>
         <span class=pc2 title="line 509 char 10 count 159,134">(do-assert (fx= len1 0))</span>
         <span class=pc2 title="line 510 char 10 count 159,134">(do-assert (fx&gt; len2 1))</span>
         <span class=pc2 title="line 511 char 10 count 159,134">(</span><span class=pc2 title="line 511 char 11 count 159,134">vector-copy!</span><span class=pc2 title="line 511 char 10 count 159,134"> </span><span class=pc2 title="line 511 char 24 count 159,134">tmp-array</span><span class=pc2 title="line 511 char 10 count 159,134"> </span><span class=pc2 title="line 511 char 34 count 159,134">0</span><span class=pc2 title="line 511 char 10 count 159,134"> </span><span class=pc2 title="line 511 char 36 count 159,134">v</span><span class=pc2 title="line 511 char 10 count 159,134"> </span><span class=pc2 title="line 511 char 38 count 159,134">(</span><span class=pc2 title="line 511 char 39 count 159,134">fx-</span><span class=pc2 title="line 511 char 38 count 159,134"> </span><span class=pc2 title="line 511 char 43 count 159,134">dest</span><span class=pc2 title="line 511 char 38 count 159,134"> </span><span class=pc2 title="line 511 char 48 count 159,134">(</span><span class=pc2 title="line 511 char 49 count 159,134">fx-</span><span class=pc2 title="line 511 char 48 count 159,134"> </span><span class=pc2 title="line 511 char 53 count 159,134">len2</span><span class=pc2 title="line 511 char 48 count 159,134"> </span><span class=pc2 title="line 511 char 58 count 159,134">1</span><span class=pc2 title="line 511 char 48 count 159,134">)</span><span class=pc2 title="line 511 char 38 count 159,134">)</span><span class=pc2 title="line 511 char 10 count 159,134"> </span><span class=pc2 title="line 511 char 62 count 159,134">len2</span><span class=pc2 title="line 511 char 10 count 159,134">)</span><span class=pc2 title="line 498 char 7 count 329,338">])</span><span class=pc2 title="line 496 char 5 count 329,338">)</span>

    <span class=pc2 title="line 513 char 5 count 329,338">(do-assert (and (fx&gt; len1 0) (fx&gt; len2 0) (fx= (fx+ base1 len1) base2)))</span>
    <span class=pc2 title="line 514 char 5 count 329,338">(</span><span class=pc2 title="line 514 char 6 count 329,338">ensure-capacity!</span><span class=pc2 title="line 514 char 5 count 329,338"> </span><span class=pc2 title="line 514 char 23 count 329,338">len2</span><span class=pc2 title="line 514 char 5 count 329,338">)</span>
    <span class=pc2 title="line 515 char 5 count 329,338">(</span><span class=pc2 title="line 515 char 6 count 329,338">vector-copy!</span><span class=pc2 title="line 515 char 5 count 329,338"> </span><span class=pc2 title="line 515 char 19 count 329,338">v</span><span class=pc2 title="line 515 char 5 count 329,338"> </span><span class=pc2 title="line 515 char 21 count 329,338">base2</span><span class=pc2 title="line 515 char 5 count 329,338"> </span><span class=pc2 title="line 515 char 27 count 329,338">tmp-array</span><span class=pc2 title="line 515 char 5 count 329,338"> </span><span class=pc2 title="line 515 char 37 count 329,338">0</span><span class=pc2 title="line 515 char 5 count 329,338"> </span><span class=pc2 title="line 515 char 39 count 329,338">len2</span><span class=pc2 title="line 515 char 5 count 329,338">)</span>

    <span class=pc2 title="line 517 char 5 count 329,338">(let ([cur1 </span><span class=pc2 title="line 517 char 17 count 329,338">(</span><span class=pc2 title="line 517 char 18 count 329,338">fx+</span><span class=pc2 title="line 517 char 17 count 329,338"> </span><span class=pc2 title="line 517 char 22 count 329,338">base1</span><span class=pc2 title="line 517 char 17 count 329,338"> </span><span class=pc2 title="line 517 char 28 count 329,338">len1</span><span class=pc2 title="line 517 char 17 count 329,338"> </span><span class=pc2 title="line 517 char 33 count 329,338">-1</span><span class=pc2 title="line 517 char 17 count 329,338">)</span><span class=pc2 title="line 517 char 5 count 329,338">]</span>
          <span class=pc2 title="line 517 char 5 count 329,338">[cur2 </span><span class=pc2 title="line 518 char 17 count 329,338">(</span><span class=pc2 title="line 518 char 18 count 329,338">fx-</span><span class=pc2 title="line 518 char 17 count 329,338"> </span><span class=pc2 title="line 518 char 22 count 329,338">len2</span><span class=pc2 title="line 518 char 17 count 329,338"> </span><span class=pc2 title="line 518 char 27 count 329,338">1</span><span class=pc2 title="line 518 char 17 count 329,338">)</span><span class=pc2 title="line 517 char 5 count 329,338">]</span>
          <span class=pc2 title="line 517 char 5 count 329,338">[dest </span><span class=pc2 title="line 519 char 17 count 329,338">(</span><span class=pc2 title="line 519 char 18 count 329,338">fx+</span><span class=pc2 title="line 519 char 17 count 329,338"> </span><span class=pc2 title="line 519 char 22 count 329,338">base2</span><span class=pc2 title="line 519 char 17 count 329,338"> </span><span class=pc2 title="line 519 char 28 count 329,338">len2</span><span class=pc2 title="line 519 char 17 count 329,338"> </span><span class=pc2 title="line 519 char 33 count 329,338">-1</span><span class=pc2 title="line 519 char 17 count 329,338">)</span><span class=pc2 title="line 517 char 5 count 329,338">])</span>
      <span class=pc2 title="line 520 char 7 count 329,338">(v-set! </span><span class=pc2 title="line 520 char 15 count 329,338">dest</span><span class=pc2 title="line 520 char 7 count 329,338"> </span><span class=pc2 title="line 520 char 20 count 329,338">(v-get </span><span class=pc2 title="line 520 char 27 count 329,338">cur1</span><span class=pc2 title="line 520 char 20 count 329,338">)</span><span class=pc2 title="line 520 char 7 count 329,338">)</span>
      <span class=pc2 title="line 521 char 7 count 329,338">(let ([dest </span><span class=pc2 title="line 521 char 19 count 329,338">(</span><span class=pc2 title="line 521 char 20 count 329,338">fx-</span><span class=pc2 title="line 521 char 19 count 329,338"> </span><span class=pc2 title="line 521 char 24 count 329,338">dest</span><span class=pc2 title="line 521 char 19 count 329,338"> </span><span class=pc2 title="line 521 char 29 count 329,338">1</span><span class=pc2 title="line 521 char 19 count 329,338">)</span><span class=pc2 title="line 521 char 7 count 329,338">]</span>
            <span class=pc2 title="line 521 char 7 count 329,338">[cur1 </span><span class=pc2 title="line 522 char 19 count 329,338">(</span><span class=pc2 title="line 522 char 20 count 329,338">fx-</span><span class=pc2 title="line 522 char 19 count 329,338"> </span><span class=pc2 title="line 522 char 24 count 329,338">cur1</span><span class=pc2 title="line 522 char 19 count 329,338"> </span><span class=pc2 title="line 522 char 29 count 329,338">1</span><span class=pc2 title="line 522 char 19 count 329,338">)</span><span class=pc2 title="line 521 char 7 count 329,338">]</span>
            <span class=pc2 title="line 521 char 7 count 329,338">[len1 </span><span class=pc2 title="line 523 char 19 count 329,338">(</span><span class=pc2 title="line 523 char 20 count 329,338">fx-</span><span class=pc2 title="line 523 char 19 count 329,338"> </span><span class=pc2 title="line 523 char 24 count 329,338">len1</span><span class=pc2 title="line 523 char 19 count 329,338"> </span><span class=pc2 title="line 523 char 29 count 329,338">1</span><span class=pc2 title="line 523 char 19 count 329,338">)</span><span class=pc2 title="line 521 char 7 count 329,338">])</span>
        <span class=pc2 title="line 524 char 9 count 329,338">(cond</span>
          <span class=pc2 title="line 524 char 9 count 329,338">[</span><span class=pc2 title="line 525 char 12 count 329,338">(</span><span class=pc2 title="line 525 char 13 count 329,338">fx=</span><span class=pc2 title="line 525 char 12 count 329,338"> </span><span class=pc2 title="line 525 char 17 count 329,338">len1</span><span class=pc2 title="line 525 char 12 count 329,338"> </span><span class=pc2 title="line 525 char 22 count 329,338">0</span><span class=pc2 title="line 525 char 12 count 329,338">)</span><span class=pc2 title="line 524 char 9 count 329,338"> </span><span class=pc1 title="line 525 char 25 count 0">(</span><span class=pc1 title="line 525 char 26 count 0">vector-copy!</span><span class=pc1 title="line 525 char 25 count 0"> </span><span class=pc1 title="line 525 char 39 count 0">tmp-array</span><span class=pc1 title="line 525 char 25 count 0"> </span><span class=pc1 title="line 525 char 49 count 0">0</span><span class=pc1 title="line 525 char 25 count 0"> </span><span class=pc1 title="line 525 char 51 count 0">v</span><span class=pc1 title="line 525 char 25 count 0"> </span><span class=pc1 title="line 525 char 53 count 0">(</span><span class=pc1 title="line 525 char 54 count 0">fx-</span><span class=pc1 title="line 525 char 53 count 0"> </span><span class=pc1 title="line 525 char 58 count 0">dest</span><span class=pc1 title="line 525 char 53 count 0"> </span><span class=pc1 title="line 525 char 63 count 0">(</span><span class=pc1 title="line 525 char 64 count 0">fx-</span><span class=pc1 title="line 525 char 63 count 0"> </span><span class=pc1 title="line 525 char 68 count 0">len2</span><span class=pc1 title="line 525 char 63 count 0"> </span><span class=pc1 title="line 525 char 73 count 0">1</span><span class=pc1 title="line 525 char 63 count 0">)</span><span class=pc1 title="line 525 char 53 count 0">)</span><span class=pc1 title="line 525 char 25 count 0"> </span><span class=pc1 title="line 525 char 77 count 0">len2</span><span class=pc1 title="line 525 char 25 count 0">)</span><span class=pc2 title="line 524 char 9 count 329,338">]</span>
          <span class=pc2 title="line 524 char 9 count 329,338">[</span><span class=pc2 title="line 526 char 12 count 329,338">(</span><span class=pc2 title="line 526 char 13 count 329,338">fx=</span><span class=pc2 title="line 526 char 12 count 329,338"> </span><span class=pc2 title="line 526 char 17 count 329,338">len2</span><span class=pc2 title="line 526 char 12 count 329,338"> </span><span class=pc2 title="line 526 char 22 count 329,338">1</span><span class=pc2 title="line 526 char 12 count 329,338">)</span>
           <span class=pc1 title="line 527 char 12 count 0">(let ([dest </span><span class=pc1 title="line 527 char 24 count 0">(</span><span class=pc1 title="line 527 char 25 count 0">fx-</span><span class=pc1 title="line 527 char 24 count 0"> </span><span class=pc1 title="line 527 char 29 count 0">dest</span><span class=pc1 title="line 527 char 24 count 0"> </span><span class=pc1 title="line 527 char 34 count 0">len1</span><span class=pc1 title="line 527 char 24 count 0">)</span><span class=pc1 title="line 527 char 12 count 0">]</span>
                 <span class=pc1 title="line 527 char 12 count 0">[cur1 </span><span class=pc1 title="line 528 char 24 count 0">(</span><span class=pc1 title="line 528 char 25 count 0">fx-</span><span class=pc1 title="line 528 char 24 count 0"> </span><span class=pc1 title="line 528 char 29 count 0">cur1</span><span class=pc1 title="line 528 char 24 count 0"> </span><span class=pc1 title="line 528 char 34 count 0">len1</span><span class=pc1 title="line 528 char 24 count 0">)</span><span class=pc1 title="line 527 char 12 count 0">])</span>
             <span class=pc1 title="line 529 char 14 count 0">(</span><span class=pc1 title="line 529 char 15 count 0">vector-copy!</span><span class=pc1 title="line 529 char 14 count 0"> </span><span class=pc1 title="line 529 char 28 count 0">v</span><span class=pc1 title="line 529 char 14 count 0"> </span><span class=pc1 title="line 529 char 30 count 0">(</span><span class=pc1 title="line 529 char 31 count 0">fx+</span><span class=pc1 title="line 529 char 30 count 0"> </span><span class=pc1 title="line 529 char 35 count 0">cur1</span><span class=pc1 title="line 529 char 30 count 0"> </span><span class=pc1 title="line 529 char 40 count 0">1</span><span class=pc1 title="line 529 char 30 count 0">)</span><span class=pc1 title="line 529 char 14 count 0"> </span><span class=pc1 title="line 529 char 43 count 0">v</span><span class=pc1 title="line 529 char 14 count 0"> </span><span class=pc1 title="line 529 char 45 count 0">(</span><span class=pc1 title="line 529 char 46 count 0">fx+</span><span class=pc1 title="line 529 char 45 count 0"> </span><span class=pc1 title="line 529 char 50 count 0">dest</span><span class=pc1 title="line 529 char 45 count 0"> </span><span class=pc1 title="line 529 char 55 count 0">1</span><span class=pc1 title="line 529 char 45 count 0">)</span><span class=pc1 title="line 529 char 14 count 0"> </span><span class=pc1 title="line 529 char 58 count 0">len1</span><span class=pc1 title="line 529 char 14 count 0">)</span>
             <span class=pc1 title="line 530 char 14 count 0">(v-set! </span><span class=pc1 title="line 530 char 22 count 0">dest</span><span class=pc1 title="line 530 char 14 count 0"> </span><span class=pc1 title="line 530 char 27 count 0">(t-get </span><span class=pc1 title="line 530 char 34 count 0">cur2</span><span class=pc1 title="line 530 char 27 count 0">)</span><span class=pc1 title="line 530 char 14 count 0">)</span><span class=pc1 title="line 527 char 12 count 0">)</span><span class=pc2 title="line 524 char 9 count 329,338">]</span>
          <span class=pc2 title="line 524 char 9 count 329,338">[else </span><span class=pc2 title="line 531 char 17 count 329,338">(</span><span class=pc2 title="line 531 char 18 count 329,338">do-while1</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 28 count 329,338">0</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 30 count 329,338">0</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 32 count 329,338">cur1</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 37 count 329,338">cur2</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 42 count 329,338">dest</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 47 count 329,338">len1</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 52 count 329,338">len2</span><span class=pc2 title="line 531 char 17 count 329,338"> </span><span class=pc2 title="line 531 char 57 count 329,338">min-gallop</span><span class=pc2 title="line 531 char 17 count 329,338">)</span><span class=pc2 title="line 524 char 9 count 329,338">])</span><span class=pc2 title="line 521 char 7 count 329,338">)</span><span class=pc2 title="line 517 char 5 count 329,338">)</span><span class=pc2 title="line 425 char 3 count 12">)</span>

  <span class=pc2 title="line 533 char 3 count 12">(do-assert (fx&gt;= range-length 1))</span>

  <span class=pc2 title="line 535 char 3 count 12">(if </span><span class=pc2 title="line 535 char 7 count 12">(</span><span class=pc2 title="line 535 char 8 count 12">fx&gt;=</span><span class=pc2 title="line 535 char 7 count 12"> </span><span class=pc2 title="line 535 char 13 count 12">range-length</span><span class=pc2 title="line 535 char 7 count 12"> </span><span class=pc2 title="line 535 char 26 count 12">2</span><span class=pc2 title="line 535 char 7 count 12">)</span>
      <span class=pc2 title="line 536 char 7 count 12">(if </span><span class=pc2 title="line 536 char 11 count 12">(</span><span class=pc2 title="line 536 char 12 count 12">fx&lt;</span><span class=pc2 title="line 536 char 11 count 12"> </span><span class=pc2 title="line 536 char 16 count 12">range-length</span><span class=pc2 title="line 536 char 11 count 12"> </span><span class=pc2 title="line 536 char 29 count 12">MIN_MERGE</span><span class=pc2 title="line 536 char 11 count 12">)</span>
          <span class=pc2 title="line 537 char 11 count 4">(let ([init-run-len </span><span class=pc2 title="line 537 char 31 count 4">(</span><span class=pc2 title="line 537 char 32 count 4">count-run-and-make-ascending</span><span class=pc2 title="line 537 char 31 count 4"> </span><span class=pc2 title="line 537 char 61 count 4">lo</span><span class=pc2 title="line 537 char 31 count 4"> </span><span class=pc2 title="line 537 char 64 count 4">hi</span><span class=pc2 title="line 537 char 31 count 4">)</span><span class=pc2 title="line 537 char 11 count 4">])</span>
            <span class=pc2 title="line 538 char 13 count 4">(</span><span class=pc2 title="line 538 char 14 count 4">binary-insertion-sort</span><span class=pc2 title="line 538 char 13 count 4"> </span><span class=pc2 title="line 538 char 36 count 4">lo</span><span class=pc2 title="line 538 char 13 count 4"> </span><span class=pc2 title="line 538 char 39 count 4">hi</span><span class=pc2 title="line 538 char 13 count 4"> </span><span class=pc2 title="line 538 char 42 count 4">(</span><span class=pc2 title="line 538 char 43 count 4">fx+</span><span class=pc2 title="line 538 char 42 count 4"> </span><span class=pc2 title="line 538 char 47 count 4">lo</span><span class=pc2 title="line 538 char 42 count 4"> </span><span class=pc2 title="line 538 char 50 count 4">init-run-len</span><span class=pc2 title="line 538 char 42 count 4">)</span><span class=pc2 title="line 538 char 13 count 4">)</span><span class=pc2 title="line 537 char 11 count 4">)</span>
          <span class=pc2 title="line 539 char 11 count 8">(let ([min-run-len </span><span class=pc2 title="line 539 char 30 count 8">(</span><span class=pc2 title="line 539 char 31 count 8">compute-min-run-length</span><span class=pc2 title="line 539 char 30 count 8"> </span><span class=pc2 title="line 539 char 54 count 8">range-length</span><span class=pc2 title="line 539 char 30 count 8">)</span><span class=pc2 title="line 539 char 11 count 8">])</span>
            <span class=pc2 title="line 540 char 13 count 8">(</span><span class=pc2 title="line 540 char 14 count 8">init-stack-and-tmp-array</span><span class=pc2 title="line 540 char 13 count 8">)</span>
            <span class=pc2 title="line 541 char 13 count 8">(let do-while ([n-remaining </span><span class=pc2 title="line 541 char 41 count 8">range-length</span><span class=pc2 title="line 541 char 13 count 8">]</span>
                           <span class=pc2 title="line 541 char 13 count 8">[lo </span><span class=pc2 title="line 542 char 32 count 8">lo</span><span class=pc2 title="line 541 char 13 count 8">])</span>
              <span class=pc2 title="line 543 char 15 count 1,000,006">(let ([run-len </span><span class=pc2 title="line 543 char 30 count 1,000,006">(</span><span class=pc2 title="line 543 char 31 count 1,000,006">count-run-and-make-ascending</span><span class=pc2 title="line 543 char 30 count 1,000,006"> </span><span class=pc2 title="line 543 char 60 count 1,000,006">lo</span><span class=pc2 title="line 543 char 30 count 1,000,006"> </span><span class=pc2 title="line 543 char 63 count 1,000,006">hi</span><span class=pc2 title="line 543 char 30 count 1,000,006">)</span><span class=pc2 title="line 543 char 15 count 1,000,006">])</span>
                <span class=pc2 title="line 544 char 17 count 1,000,006">(if </span><span class=pc2 title="line 544 char 21 count 1,000,006">(</span><span class=pc2 title="line 544 char 22 count 1,000,006">fx&lt;</span><span class=pc2 title="line 544 char 21 count 1,000,006"> </span><span class=pc2 title="line 544 char 26 count 1,000,006">run-len</span><span class=pc2 title="line 544 char 21 count 1,000,006"> </span><span class=pc2 title="line 544 char 34 count 1,000,006">min-run-len</span><span class=pc2 title="line 544 char 21 count 1,000,006">)</span>
                    <span class=pc2 title="line 545 char 21 count 1,000,000">(let ([force </span><span class=pc2 title="line 545 char 34 count 1,000,000">(</span><span class=pc2 title="line 545 char 35 count 1,000,000">min</span><span class=pc2 title="line 545 char 34 count 1,000,000"> </span><span class=pc2 title="line 545 char 39 count 1,000,000">n-remaining</span><span class=pc2 title="line 545 char 34 count 1,000,000"> </span><span class=pc2 title="line 545 char 51 count 1,000,000">min-run-len</span><span class=pc2 title="line 545 char 34 count 1,000,000">)</span><span class=pc2 title="line 545 char 21 count 1,000,000">])</span>
                      <span class=pc2 title="line 546 char 23 count 1,000,000">(</span><span class=pc2 title="line 546 char 24 count 1,000,000">binary-insertion-sort</span><span class=pc2 title="line 546 char 23 count 1,000,000"> </span><span class=pc2 title="line 546 char 46 count 1,000,000">lo</span><span class=pc2 title="line 546 char 23 count 1,000,000"> </span><span class=pc2 title="line 546 char 49 count 1,000,000">(</span><span class=pc2 title="line 546 char 50 count 1,000,000">fx+</span><span class=pc2 title="line 546 char 49 count 1,000,000"> </span><span class=pc2 title="line 546 char 54 count 1,000,000">lo</span><span class=pc2 title="line 546 char 49 count 1,000,000"> </span><span class=pc2 title="line 546 char 57 count 1,000,000">force</span><span class=pc2 title="line 546 char 49 count 1,000,000">)</span><span class=pc2 title="line 546 char 23 count 1,000,000"> </span><span class=pc2 title="line 546 char 64 count 1,000,000">(</span><span class=pc2 title="line 546 char 65 count 1,000,000">fx+</span><span class=pc2 title="line 546 char 64 count 1,000,000"> </span><span class=pc2 title="line 546 char 69 count 1,000,000">lo</span><span class=pc2 title="line 546 char 64 count 1,000,000"> </span><span class=pc2 title="line 546 char 72 count 1,000,000">run-len</span><span class=pc2 title="line 546 char 64 count 1,000,000">)</span><span class=pc2 title="line 546 char 23 count 1,000,000">)</span>
                      <span class=pc2 title="line 547 char 23 count 1,000,000">(set! run-len </span><span class=pc2 title="line 547 char 37 count 1,000,000">force</span><span class=pc2 title="line 547 char 23 count 1,000,000">)</span><span class=pc2 title="line 545 char 21 count 1,000,000">)</span><span class=pc2 title="line 544 char 17 count 1,000,006">)</span>
                <span class=pc2 title="line 548 char 17 count 1,000,006">(</span><span class=pc2 title="line 548 char 18 count 1,000,006">push-run!</span><span class=pc2 title="line 548 char 17 count 1,000,006"> </span><span class=pc2 title="line 548 char 28 count 1,000,006">lo</span><span class=pc2 title="line 548 char 17 count 1,000,006"> </span><span class=pc2 title="line 548 char 31 count 1,000,006">run-len</span><span class=pc2 title="line 548 char 17 count 1,000,006">)</span>
                <span class=pc2 title="line 549 char 17 count 1,000,006">(</span><span class=pc2 title="line 549 char 18 count 1,000,006">merge-collapse</span><span class=pc2 title="line 549 char 17 count 1,000,006">)</span>
                <span class=pc2 title="line 550 char 17 count 1,000,006">(cond</span>
                  <span class=pc2 title="line 550 char 17 count 1,000,006">[</span><span class=pc2 title="line 551 char 20 count 1,000,006">(</span><span class=pc2 title="line 551 char 21 count 1,000,006">fx&gt;</span><span class=pc2 title="line 551 char 20 count 1,000,006"> </span><span class=pc2 title="line 551 char 25 count 1,000,006">n-remaining</span><span class=pc2 title="line 551 char 20 count 1,000,006"> </span><span class=pc2 title="line 551 char 37 count 1,000,006">run-len</span><span class=pc2 title="line 551 char 20 count 1,000,006">)</span>
                   <span class=pc2 title="line 552 char 20 count 999,998">(</span><span class=pc2 title="line 552 char 21 count 999,998">do-while</span><span class=pc2 title="line 552 char 20 count 999,998"> </span><span class=pc2 title="line 552 char 30 count 999,998">(</span><span class=pc2 title="line 552 char 31 count 999,998">fx-</span><span class=pc2 title="line 552 char 30 count 999,998"> </span><span class=pc2 title="line 552 char 35 count 999,998">n-remaining</span><span class=pc2 title="line 552 char 30 count 999,998"> </span><span class=pc2 title="line 552 char 47 count 999,998">run-len</span><span class=pc2 title="line 552 char 30 count 999,998">)</span>
                             <span class=pc2 title="line 553 char 30 count 999,998">(</span><span class=pc2 title="line 553 char 31 count 999,998">fx+</span><span class=pc2 title="line 553 char 30 count 999,998"> </span><span class=pc2 title="line 553 char 35 count 999,998">lo</span><span class=pc2 title="line 553 char 30 count 999,998"> </span><span class=pc2 title="line 553 char 38 count 999,998">run-len</span><span class=pc2 title="line 553 char 30 count 999,998">)</span><span class=pc2 title="line 552 char 20 count 999,998">)</span><span class=pc2 title="line 550 char 17 count 1,000,006">]</span>
                  <span class=pc2 title="line 550 char 17 count 1,000,006">[else</span>
                   <span class=pc2 title="line 555 char 20 count 8">(do-assert (fx= (fx+ lo run-len) hi))</span>
                   <span class=pc2 title="line 556 char 20 count 8">(</span><span class=pc2 title="line 556 char 21 count 8">merge-force-collapse</span><span class=pc2 title="line 556 char 20 count 8">)</span>
                   <span class=pc2 title="line 557 char 20 count 8">(do-assert (fx= stack-size 1))</span><span class=pc2 title="line 550 char 17 count 1,000,006">])</span><span class=pc2 title="line 543 char 15 count 1,000,006">)</span><span class=pc2 title="line 541 char 13 count 8">)</span><span class=pc2 title="line 539 char 11 count 8">)</span><span class=pc2 title="line 536 char 7 count 12">)</span><span class=pc2 title="line 535 char 3 count 12">)</span>
  <span class=pc2 title="line 558 char 3 count 12">v</span><span class=pc2 title="line 25 char 1 count 1">)</span>

<span class=pc2 title="line 560 char 1 count 1">(define (tim-sort! lt? v)</span>
  <span class=pc2 title="line 561 char 3 count 12">(</span><span class=pc2 title="line 561 char 4 count 12">tim-sort-range!</span><span class=pc2 title="line 561 char 3 count 12"> </span><span class=pc2 title="line 561 char 20 count 12">lt?</span><span class=pc2 title="line 561 char 3 count 12"> </span><span class=pc2 title="line 561 char 24 count 12">v</span><span class=pc2 title="line 561 char 3 count 12"> </span><span class=pc2 title="line 561 char 26 count 12">0</span><span class=pc2 title="line 561 char 3 count 12"> </span><span class=pc2 title="line 561 char 28 count 12">(</span><span class=pc2 title="line 561 char 29 count 12">vector-length</span><span class=pc2 title="line 561 char 28 count 12"> </span><span class=pc2 title="line 561 char 43 count 12">v</span><span class=pc2 title="line 561 char 28 count 12">)</span><span class=pc2 title="line 561 char 3 count 12">)</span><span class=pc2 title="line 560 char 1 count 1">)</span>

<span class=pc2 title="line 563 char 1 count 1">(define (tim-sort lt? v)</span>
  <span class=pc1 title="line 564 char 3 count 0">(</span><span class=pc1 title="line 564 char 4 count 0">tim-sort!</span><span class=pc1 title="line 564 char 3 count 0"> </span><span class=pc1 title="line 564 char 14 count 0">lt?</span><span class=pc1 title="line 564 char 3 count 0"> </span><span class=pc1 title="line 564 char 18 count 0">(</span><span class=pc1 title="line 564 char 19 count 0">vector-copy</span><span class=pc1 title="line 564 char 18 count 0"> </span><span class=pc1 title="line 564 char 31 count 0">v</span><span class=pc1 title="line 564 char 18 count 0">)</span><span class=pc1 title="line 564 char 3 count 0">)</span><span class=pc2 title="line 563 char 1 count 1">)</span>


; Test
(include "test.ss")


#|
Check stability with v: #((0 . 0) (1 . 1) (2 . 2) (0 . 3) (1 . 4) (2 . 5))
    (tim-sort    &lt;  v): #((0 . 0) (0 . 3) (1 . 1) (1 . 4) (2 . 2) (2 . 5))
    (vector-sort &lt;  v): #((0 . 0) (0 . 3) (1 . 1) (1 . 4) (2 . 2) (2 . 5))

    (tim-sort    &gt;  v): #((2 . 2) (2 . 5) (1 . 1) (1 . 4) (0 . 0) (0 . 3))
    (vector-sort &gt;  v): #((2 . 2) (2 . 5) (1 . 1) (1 . 4) (0 . 0) (0 . 3))

    (tim-sort    &lt;= v): #((0 . 3) (0 . 0) (1 . 4) (1 . 1) (2 . 5) (2 . 2))
    (vector-sort &lt;= v): #((0 . 3) (0 . 0) (1 . 4) (1 . 1) (2 . 5) (2 . 2))

    (tim-sort    &gt;= v): #((2 . 5) (2 . 2) (1 . 4) (1 . 1) (0 . 3) (0 . 0))
    (vector-sort &gt;= v): #((2 . 5) (2 . 2) (1 . 4) (1 . 1) (0 . 3) (0 . 0))


Bench with size=10000000, range=1000000
(time (tim-sort &lt; ...))
    12 collections
    5.671875000s elapsed cpu time, including 0.281250000s collecting
    5.784103500s elapsed real time, including 0.296505600s collecting
    204098304 bytes allocated, including 107475328 bytes reclaimed
comparations: 220247255, ordered: #t
(time (tim-sort &lt; ...))
    no collections
    0.062500000s elapsed cpu time
    0.072210200s elapsed real time
    2976 bytes allocated
comparations: 9999999, ordered: #t
(time (tim-sort &gt;= ...))
    no collections
    0.109375000s elapsed cpu time
    0.116561100s elapsed real time
    2976 bytes allocated
comparations: 9999999, ordered: #t
(time (tim-sort &lt;= ...))
    no collections
    0.109375000s elapsed cpu time
    0.130977300s elapsed real time
    2976 bytes allocated
comparations: 9999999, ordered: #t
(time (bench-tim-sort!))
    27 collections
    13.671875000s elapsed cpu time, including 1.671875000s collecting
    14.223362300s elapsed real time, including 1.770293600s collecting
    728264448 bytes allocated, including 531695584 bytes reclaimed

(time (vector-sort &lt; ...))
    no collections
    3.500000000s elapsed cpu time
    3.502645100s elapsed real time
    80000064 bytes allocated
comparations: 240976582, ordered: #t
(time (vector-sort &lt; ...))
    no collections
    0.171875000s elapsed cpu time
    0.182527500s elapsed real time
    80000064 bytes allocated
comparations: 9999999, ordered: #t
(time (vector-sort &gt;= ...))
    no collections
    1.703125000s elapsed cpu time
    1.717274800s elapsed real time
    80000064 bytes allocated
comparations: 124434623, ordered: #t
(time (vector-sort &lt;= ...))
    no collections
    1.593750000s elapsed cpu time
    1.638002100s elapsed real time
    80000064 bytes allocated
comparations: 124434623, ordered: #t
(time (bench-vector-sort!))
    4 collections
    16.937500000s elapsed cpu time, including 1.359375000s collecting
    17.231441600s elapsed real time, including 1.342752400s collecting
    960048192 bytes allocated, including 800068160 bytes reclaimed

[Finished in 33.2s]
 |#
</pre></td></tr></table>
</body>
</html>